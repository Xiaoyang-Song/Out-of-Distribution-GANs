2024-12-26 15:32:17.042710: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-12-26 15:32:18.457587: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2024-12-26 15:32:18.457717: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2024-12-26 15:32:18.457738: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
  0%|          | 0/400 [00:00<?, ?it/s]  0%|          | 1/400 [00:01<08:46,  1.32s/it]  1%|          | 4/400 [00:01<01:50,  3.60it/s]  2%|▏         | 7/400 [00:01<00:57,  6.82it/s]  3%|▎         | 11/400 [00:01<00:34, 11.23it/s]  4%|▍         | 15/400 [00:01<00:25, 15.30it/s]  5%|▍         | 19/400 [00:01<00:20, 18.85it/s]  6%|▌         | 23/400 [00:02<00:17, 21.78it/s]  6%|▋         | 26/400 [00:02<00:15, 23.42it/s]  8%|▊         | 30/400 [00:02<00:14, 25.48it/s]  8%|▊         | 34/400 [00:02<00:13, 26.99it/s] 10%|▉         | 38/400 [00:02<00:12, 28.07it/s] 10%|█         | 42/400 [00:02<00:12, 28.85it/s] 12%|█▏        | 46/400 [00:02<00:12, 29.43it/s] 12%|█▎        | 50/400 [00:02<00:11, 29.84it/s] 14%|█▎        | 54/400 [00:03<00:11, 30.08it/s] 14%|█▍        | 58/400 [00:03<00:11, 30.31it/s] 16%|█▌        | 62/400 [00:03<00:11, 30.46it/s] 16%|█▋        | 66/400 [00:03<00:10, 30.56it/s] 18%|█▊        | 70/400 [00:03<00:10, 30.45it/s] 18%|█▊        | 74/400 [00:03<00:10, 30.55it/s] 20%|█▉        | 78/400 [00:03<00:10, 30.59it/s] 20%|██        | 82/400 [00:03<00:10, 30.66it/s] 22%|██▏       | 86/400 [00:04<00:10, 30.71it/s] 22%|██▎       | 90/400 [00:04<00:10, 30.75it/s] 24%|██▎       | 94/400 [00:04<00:09, 30.78it/s] 24%|██▍       | 98/400 [00:04<00:09, 30.79it/s] 26%|██▌       | 102/400 [00:04<00:09, 30.75it/s] 26%|██▋       | 106/400 [00:04<00:09, 30.76it/s] 28%|██▊       | 110/400 [00:04<00:09, 30.78it/s] 28%|██▊       | 114/400 [00:05<00:09, 30.78it/s] 30%|██▉       | 118/400 [00:05<00:09, 30.77it/s] 30%|███       | 122/400 [00:05<00:09, 30.78it/s] 32%|███▏      | 126/400 [00:05<00:08, 30.74it/s] 32%|███▎      | 130/400 [00:05<00:08, 30.77it/s] 34%|███▎      | 134/400 [00:05<00:08, 30.77it/s] 34%|███▍      | 138/400 [00:05<00:08, 29.73it/s] 36%|███▌      | 142/400 [00:05<00:08, 29.99it/s] 36%|███▋      | 146/400 [00:06<00:08, 29.96it/s] 38%|███▊      | 150/400 [00:06<00:08, 30.14it/s] 38%|███▊      | 154/400 [00:06<00:08, 30.24it/s] 40%|███▉      | 158/400 [00:06<00:07, 30.37it/s] 40%|████      | 162/400 [00:06<00:07, 30.46it/s] 42%|████▏     | 166/400 [00:06<00:07, 30.52it/s] 42%|████▎     | 170/400 [00:06<00:07, 30.58it/s] 44%|████▎     | 174/400 [00:06<00:07, 30.46it/s] 44%|████▍     | 178/400 [00:07<00:07, 30.50it/s] 46%|████▌     | 182/400 [00:07<00:07, 30.56it/s] 46%|████▋     | 186/400 [00:07<00:06, 30.60it/s] 48%|████▊     | 190/400 [00:07<00:06, 30.48it/s] 48%|████▊     | 194/400 [00:07<00:06, 30.58it/s] 50%|████▉     | 198/400 [00:07<00:06, 30.63it/s] 50%|█████     | 202/400 [00:07<00:06, 30.62it/s] 52%|█████▏    | 206/400 [00:08<00:06, 30.45it/s] 52%|█████▎    | 210/400 [00:08<00:06, 30.55it/s] 54%|█████▎    | 214/400 [00:08<00:06, 30.62it/s] 55%|█████▍    | 218/400 [00:08<00:05, 30.35it/s] 56%|█████▌    | 222/400 [00:08<00:05, 30.47it/s] 56%|█████▋    | 226/400 [00:08<00:05, 30.52it/s] 57%|█████▊    | 230/400 [00:08<00:05, 30.62it/s] 58%|█████▊    | 234/400 [00:08<00:05, 30.69it/s] 60%|█████▉    | 238/400 [00:09<00:05, 30.74it/s] 60%|██████    | 242/400 [00:09<00:05, 30.77it/s] 62%|██████▏   | 246/400 [00:09<00:05, 30.80it/s] 62%|██████▎   | 250/400 [00:09<00:04, 30.81it/s] 64%|██████▎   | 254/400 [00:09<00:04, 30.77it/s] 64%|██████▍   | 258/400 [00:09<00:04, 30.78it/s] 66%|██████▌   | 262/400 [00:09<00:04, 30.82it/s] 66%|██████▋   | 266/400 [00:09<00:04, 30.82it/s] 68%|██████▊   | 270/400 [00:10<00:04, 30.79it/s] 68%|██████▊   | 274/400 [00:10<00:04, 30.80it/s] 70%|██████▉   | 278/400 [00:10<00:03, 30.77it/s] 70%|███████   | 282/400 [00:10<00:03, 30.79it/s] 72%|███████▏  | 286/400 [00:10<00:03, 30.79it/s] 72%|███████▎  | 290/400 [00:10<00:03, 30.79it/s] 74%|███████▎  | 294/400 [00:10<00:03, 30.65it/s] 74%|███████▍  | 298/400 [00:11<00:03, 30.66it/s] 76%|███████▌  | 302/400 [00:11<00:03, 30.62it/s] 76%|███████▋  | 306/400 [00:11<00:03, 30.65it/s] 78%|███████▊  | 310/400 [00:11<00:02, 30.65it/s] 78%|███████▊  | 314/400 [00:11<00:02, 30.69it/s] 80%|███████▉  | 318/400 [00:11<00:02, 30.72it/s] 80%|████████  | 322/400 [00:11<00:02, 30.73it/s] 82%|████████▏ | 326/400 [00:11<00:02, 30.70it/s] 82%|████████▎ | 330/400 [00:12<00:02, 30.73it/s] 84%|████████▎ | 334/400 [00:12<00:02, 30.75it/s] 84%|████████▍ | 338/400 [00:12<00:02, 30.75it/s] 86%|████████▌ | 342/400 [00:12<00:01, 30.78it/s] 86%|████████▋ | 346/400 [00:12<00:01, 30.79it/s] 88%|████████▊ | 350/400 [00:12<00:01, 30.80it/s] 88%|████████▊ | 354/400 [00:12<00:01, 30.76it/s] 90%|████████▉ | 358/400 [00:12<00:01, 30.77it/s] 90%|█████████ | 362/400 [00:13<00:01, 30.78it/s] 92%|█████████▏| 366/400 [00:13<00:01, 30.80it/s] 92%|█████████▎| 370/400 [00:13<00:00, 30.60it/s] 94%|█████████▎| 374/400 [00:13<00:00, 30.67it/s] 94%|█████████▍| 378/400 [00:13<00:00, 30.69it/s] 96%|█████████▌| 382/400 [00:13<00:00, 30.74it/s] 96%|█████████▋| 386/400 [00:13<00:00, 30.77it/s] 98%|█████████▊| 390/400 [00:14<00:00, 30.80it/s] 98%|█████████▊| 394/400 [00:14<00:00, 30.81it/s]100%|█████████▉| 398/400 [00:14<00:00, 30.82it/s]100%|██████████| 400/400 [00:14<00:00, 27.88it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 0/200 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/main/main_ood.py", line 161, in <module>
    trainer.train(ind_loader, ood_img_batch, D_solver,
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/ood_gan.py", line 206, in train
    evaluate(self.D, self.ind_val_loader, self.ood_val_loader)
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/eval.py", line 228, in evaluate
    winv = loader_wass(ind_val, D)
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/eval.py", line 107, in loader_wass
    wass_dist = sink_dist_test(torch.softmax(out, dim=-1), label, out.shape[1]).cpu().detach()
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/wass_loss.py", line 87, in sink_dist_test
    test_label_onehot = label_2_onehot(target, C, device)
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/wass_loss.py", line 32, in label_2_onehot
    label_onehot.scatter_(1, label, 1)
RuntimeError: scatter(): Expected dtype int64 for index
