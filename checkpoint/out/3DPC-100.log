2024-12-26 15:33:09.735823: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-12-26 15:33:11.260603: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2024-12-26 15:33:11.260741: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2024-12-26 15:33:11.260763: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
  0%|          | 0/400 [00:00<?, ?it/s]  0%|          | 1/400 [00:00<06:08,  1.08it/s]  1%|▏         | 5/400 [00:01<01:05,  6.03it/s]  2%|▏         | 8/400 [00:01<00:40,  9.72it/s]  3%|▎         | 12/400 [00:01<00:26, 14.39it/s]  4%|▍         | 16/400 [00:01<00:20, 18.32it/s]  5%|▌         | 20/400 [00:01<00:17, 21.50it/s]  6%|▌         | 24/400 [00:01<00:15, 23.99it/s]  7%|▋         | 28/400 [00:01<00:14, 25.84it/s]  8%|▊         | 32/400 [00:01<00:13, 27.25it/s]  9%|▉         | 36/400 [00:02<00:12, 28.27it/s] 10%|█         | 40/400 [00:02<00:12, 29.01it/s] 11%|█         | 44/400 [00:02<00:12, 29.54it/s] 12%|█▏        | 48/400 [00:02<00:11, 29.92it/s] 13%|█▎        | 52/400 [00:02<00:11, 30.15it/s] 14%|█▍        | 56/400 [00:02<00:11, 30.35it/s] 15%|█▌        | 60/400 [00:02<00:11, 30.50it/s] 16%|█▌        | 64/400 [00:02<00:10, 30.59it/s] 17%|█▋        | 68/400 [00:03<00:10, 30.67it/s] 18%|█▊        | 72/400 [00:03<00:10, 30.68it/s] 19%|█▉        | 76/400 [00:03<00:10, 30.69it/s] 20%|██        | 80/400 [00:03<00:10, 30.74it/s] 21%|██        | 84/400 [00:03<00:10, 30.78it/s] 22%|██▏       | 88/400 [00:03<00:10, 30.81it/s] 23%|██▎       | 92/400 [00:03<00:09, 30.83it/s] 24%|██▍       | 96/400 [00:04<00:09, 30.83it/s] 25%|██▌       | 100/400 [00:04<00:09, 30.83it/s] 26%|██▌       | 104/400 [00:04<00:09, 30.79it/s] 27%|██▋       | 108/400 [00:04<00:09, 30.80it/s] 28%|██▊       | 112/400 [00:04<00:09, 30.80it/s] 29%|██▉       | 116/400 [00:04<00:09, 30.80it/s] 30%|███       | 120/400 [00:04<00:09, 30.81it/s] 31%|███       | 124/400 [00:04<00:08, 30.81it/s] 32%|███▏      | 128/400 [00:05<00:08, 30.76it/s] 33%|███▎      | 132/400 [00:05<00:08, 30.77it/s] 34%|███▍      | 136/400 [00:05<00:08, 30.52it/s] 35%|███▌      | 140/400 [00:05<00:08, 30.24it/s] 36%|███▌      | 144/400 [00:05<00:08, 30.13it/s] 37%|███▋      | 148/400 [00:05<00:08, 30.25it/s] 38%|███▊      | 152/400 [00:05<00:08, 30.30it/s] 39%|███▉      | 156/400 [00:05<00:08, 30.39it/s] 40%|████      | 160/400 [00:06<00:07, 30.47it/s] 41%|████      | 164/400 [00:06<00:07, 30.52it/s] 42%|████▏     | 168/400 [00:06<00:07, 30.57it/s] 43%|████▎     | 172/400 [00:06<00:07, 30.63it/s] 44%|████▍     | 176/400 [00:06<00:07, 30.62it/s] 45%|████▌     | 180/400 [00:06<00:07, 30.65it/s] 46%|████▌     | 184/400 [00:06<00:07, 30.69it/s] 47%|████▋     | 188/400 [00:07<00:06, 30.71it/s] 48%|████▊     | 192/400 [00:07<00:06, 30.72it/s] 49%|████▉     | 196/400 [00:07<00:06, 30.74it/s] 50%|█████     | 200/400 [00:07<00:06, 30.75it/s] 51%|█████     | 204/400 [00:07<00:06, 30.71it/s] 52%|█████▏    | 208/400 [00:07<00:06, 30.44it/s] 53%|█████▎    | 212/400 [00:07<00:06, 30.56it/s] 54%|█████▍    | 216/400 [00:07<00:06, 30.63it/s] 55%|█████▌    | 220/400 [00:08<00:05, 30.29it/s] 56%|█████▌    | 224/400 [00:08<00:05, 30.45it/s] 57%|█████▋    | 228/400 [00:08<00:05, 30.53it/s] 58%|█████▊    | 232/400 [00:08<00:05, 30.63it/s] 59%|█████▉    | 236/400 [00:08<00:05, 30.69it/s] 60%|██████    | 240/400 [00:08<00:05, 30.73it/s] 61%|██████    | 244/400 [00:08<00:05, 30.75it/s] 62%|██████▏   | 248/400 [00:08<00:04, 30.78it/s] 63%|██████▎   | 252/400 [00:09<00:04, 30.74it/s] 64%|██████▍   | 256/400 [00:09<00:04, 30.75it/s] 65%|██████▌   | 260/400 [00:09<00:04, 30.78it/s] 66%|██████▌   | 264/400 [00:09<00:04, 30.80it/s] 67%|██████▋   | 268/400 [00:09<00:04, 30.80it/s] 68%|██████▊   | 272/400 [00:09<00:04, 30.80it/s] 69%|██████▉   | 276/400 [00:09<00:04, 30.76it/s] 70%|███████   | 280/400 [00:10<00:03, 30.78it/s] 71%|███████   | 284/400 [00:10<00:03, 30.62it/s] 72%|███████▏  | 288/400 [00:10<00:03, 30.64it/s] 73%|███████▎  | 292/400 [00:10<00:03, 30.67it/s] 74%|███████▍  | 296/400 [00:10<00:03, 30.69it/s] 75%|███████▌  | 300/400 [00:10<00:03, 30.70it/s] 76%|███████▌  | 304/400 [00:10<00:03, 30.66it/s] 77%|███████▋  | 308/400 [00:10<00:02, 30.70it/s] 78%|███████▊  | 312/400 [00:11<00:02, 30.72it/s] 79%|███████▉  | 316/400 [00:11<00:02, 30.73it/s] 80%|████████  | 320/400 [00:11<00:02, 30.75it/s] 81%|████████  | 324/400 [00:11<00:02, 30.77it/s] 82%|████████▏ | 328/400 [00:11<00:02, 30.72it/s] 83%|████████▎ | 332/400 [00:11<00:02, 30.74it/s] 84%|████████▍ | 336/400 [00:11<00:02, 30.76it/s] 85%|████████▌ | 340/400 [00:11<00:01, 30.77it/s] 86%|████████▌ | 344/400 [00:12<00:01, 30.78it/s] 87%|████████▋ | 348/400 [00:12<00:01, 30.80it/s] 88%|████████▊ | 352/400 [00:12<00:01, 30.75it/s] 89%|████████▉ | 356/400 [00:12<00:01, 30.77it/s] 90%|█████████ | 360/400 [00:12<00:01, 30.77it/s] 91%|█████████ | 364/400 [00:12<00:01, 30.78it/s] 92%|█████████▏| 368/400 [00:12<00:01, 30.80it/s] 93%|█████████▎| 372/400 [00:13<00:00, 30.66it/s] 94%|█████████▍| 376/400 [00:13<00:00, 30.66it/s] 95%|█████████▌| 380/400 [00:13<00:00, 30.71it/s] 96%|█████████▌| 384/400 [00:13<00:00, 30.74it/s] 97%|█████████▋| 388/400 [00:13<00:00, 30.77it/s] 98%|█████████▊| 392/400 [00:13<00:00, 30.79it/s] 99%|█████████▉| 396/400 [00:13<00:00, 30.80it/s]100%|██████████| 400/400 [00:13<00:00, 30.79it/s]100%|██████████| 400/400 [00:13<00:00, 28.71it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 0/200 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/main/main_ood.py", line 161, in <module>
    trainer.train(ind_loader, ood_img_batch, D_solver,
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/ood_gan.py", line 206, in train
    evaluate(self.D, self.ind_val_loader, self.ood_val_loader)
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/eval.py", line 228, in evaluate
    winv = loader_wass(ind_val, D)
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/eval.py", line 107, in loader_wass
    wass_dist = sink_dist_test(torch.softmax(out, dim=-1), label, out.shape[1]).cpu().detach()
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/wass_loss.py", line 87, in sink_dist_test
    test_label_onehot = label_2_onehot(target, C, device)
  File "/scratch/sunwbgt_root/sunwbgt98/xysong/Out-of-Distribution-GANs/wass_loss.py", line 32, in label_2_onehot
    label_onehot.scatter_(1, label, 1)
RuntimeError: scatter(): Expected dtype int64 for index
