
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: SVHN
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 512
Input Dimension: 32 x 32 x 3
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=0.1 & scaling=0.01 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
Using downloaded and verified file: ./Datasets/SVHN/train_32x32.mat
Using downloaded and verified file: ./Datasets/SVHN/test_32x32.mat
tensor([8, 8, 8,  ..., 9, 9, 9])
Counter({8: 512, 9: 512})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([1024, 3, 32, 32])
Step: 0    | D:  2.1385 | CE:  2.2174 | S_OoD:  0.7966 | S_z:  0.7951 | G: -0.0008 | S_z:  0.8134 | dist: 0.1639
Step: 100  | D:  1.7135 | CE:  1.7830 | S_OoD:  0.7024 | S_z:  0.7841 | G: -0.0008 | S_z:  0.7859 | dist: 0.2112
Step: 200  | D:  0.8641 | CE:  0.9261 | S_OoD:  0.6266 | S_z:  0.6540 | G: -0.0007 | S_z:  0.6616 | dist: 0.0011
Step: 300  | D:  0.5121 | CE:  0.5619 | S_OoD:  0.5024 | S_z:  0.4971 | G: -0.0005 | S_z:  0.5180 | dist: 0.1673
Step: 400  | D:  0.3081 | CE:  0.3548 | S_OoD:  0.4712 | S_z:  0.4260 | G: -0.0004 | S_z:  0.4166 | dist: 0.0732
Step: 500  | D:  0.3119 | CE:  0.3572 | S_OoD:  0.4576 | S_z:  0.4134 | G: -0.0004 | S_z:  0.4150 | dist: 0.0040
Step: 600  | D:  0.2314 | CE:  0.2822 | S_OoD:  0.5124 | S_z:  0.4361 | G: -0.0004 | S_z:  0.4331 | dist: 0.1338
Step: 700  | D:  0.2660 | CE:  0.3207 | S_OoD:  0.5513 | S_z:  0.4226 | G: -0.0004 | S_z:  0.4163 | dist: 0.1939
Step: 800  | D:  0.2136 | CE:  0.2674 | S_OoD:  0.5413 | S_z:  0.3986 | G: -0.0004 | S_z:  0.3983 | dist: 0.0966
Step: 900  | D:  0.1522 | CE:  0.2101 | S_OoD:  0.5823 | S_z:  0.3733 | G: -0.0004 | S_z:  0.3814 | dist: 0.2165
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.2860215053763441
mean: 0.28602 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.22994431853294375
mean: 0.22994 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.10476190476190472
mean: 0.10476 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.3104494965076452
mean: 0.31045 | std: 0.0 | MAD: 0.0
AUROC: 0.8619953281084276

Validation Accuracy: 0.9048185553420067
Validation Classification Loss: 0.3071395957193683
Step: 6    | D:  0.0559 | CE:  0.0937 | S_OoD:  0.3817 | S_z:  0.3864 | G: -0.0004 | S_z:  0.3911 | dist: 0.0846
Step: 106  | D:  0.1343 | CE:  0.1996 | S_OoD:  0.6572 | S_z:  0.4291 | G: -0.0004 | S_z:  0.4360 | dist: 0.2054
Step: 206  | D:  0.2612 | CE:  0.3179 | S_OoD:  0.5708 | S_z:  0.3879 | G: -0.0004 | S_z:  0.3899 | dist: 0.2048
Step: 306  | D:  0.0569 | CE:  0.1171 | S_OoD:  0.6054 | S_z:  0.3908 | G: -0.0004 | S_z:  0.3893 | dist: 0.2511
Step: 406  | D:  0.0850 | CE:  0.1484 | S_OoD:  0.6375 | S_z:  0.3868 | G: -0.0004 | S_z:  0.3850 | dist: 0.2124
Step: 506  | D:  0.1594 | CE:  0.2238 | S_OoD:  0.6471 | S_z:  0.3974 | G: -0.0004 | S_z:  0.3740 | dist: 0.1186
Step: 606  | D:  0.1331 | CE:  0.1976 | S_OoD:  0.6490 | S_z:  0.4483 | G: -0.0004 | S_z:  0.4459 | dist: 0.0956
Step: 706  | D:  0.0529 | CE:  0.1180 | S_OoD:  0.6551 | S_z:  0.4190 | G: -0.0004 | S_z:  0.3965 | dist: 0.2544
Step: 806  | D:  0.1208 | CE:  0.1876 | S_OoD:  0.6719 | S_z:  0.3993 | G: -0.0004 | S_z:  0.3982 | dist: 0.2687
Step: 906  | D:  0.0603 | CE:  0.1240 | S_OoD:  0.6417 | S_z:  0.4281 | G: -0.0004 | S_z:  0.4194 | dist: 0.3465
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.09984639016897079
mean: 0.09985 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.24922088384628296
mean: 0.24922 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.03655913978494618
mean: 0.03656 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.3129750132560731
mean: 0.31298 | std: 0.0 | MAD: 0.0
AUROC: 0.7649343292176258

Validation Accuracy: 0.8607255938300808
Validation Classification Loss: 0.4214427002778884
Step: 12   | D:  0.1334 | CE:  0.1890 | S_OoD:  0.5603 | S_z:  0.3559 | G: -0.0004 | S_z:  0.3660 | dist: 0.2826
Step: 112  | D:  0.2511 | CE:  0.3192 | S_OoD:  0.6852 | S_z:  0.3876 | G: -0.0004 | S_z:  0.4097 | dist: 0.2439
Step: 212  | D:  0.0969 | CE:  0.1632 | S_OoD:  0.6675 | S_z:  0.4054 | G: -0.0004 | S_z:  0.3916 | dist: 0.0904
Step: 312  | D:  0.0441 | CE:  0.1117 | S_OoD:  0.6802 | S_z:  0.4015 | G: -0.0004 | S_z:  0.3981 | dist: 0.2464
Step: 412  | D:  0.1315 | CE:  0.2002 | S_OoD:  0.6911 | S_z:  0.3831 | G: -0.0004 | S_z:  0.3934 | dist: 0.0787
Step: 512  | D:  0.1187 | CE:  0.1908 | S_OoD:  0.7251 | S_z:  0.3719 | G: -0.0004 | S_z:  0.3674 | dist: 0.1640
Step: 612  | D:  0.0496 | CE:  0.1185 | S_OoD:  0.6938 | S_z:  0.3981 | G: -0.0004 | S_z:  0.3898 | dist: 0.1196
Step: 712  | D:  0.1174 | CE:  0.1855 | S_OoD:  0.6846 | S_z:  0.3470 | G: -0.0003 | S_z:  0.3439 | dist: 0.3943
Step: 812  | D:  0.1505 | CE:  0.2234 | S_OoD:  0.7330 | S_z:  0.3645 | G: -0.0004 | S_z:  0.3581 | dist: 0.1259
Step: 912  | D:  0.1643 | CE:  0.2383 | S_OoD:  0.7441 | S_z:  0.4391 | G: -0.0005 | S_z:  0.4538 | dist: 0.0617
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.2519201228878648
mean: 0.25192 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.2287754744291306
mean: 0.22878 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.12288786482334868
mean: 0.12289 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.30903212308883665
mean: 0.30903 | std: 0.0 | MAD: 0.0
AUROC: 0.8566678043923766

Validation Accuracy: 0.884464936920954
Validation Classification Loss: 0.3783451932785886
Step: 18   | D:  0.1519 | CE:  0.2099 | S_OoD:  0.5829 | S_z:  0.3423 | G: -0.0003 | S_z:  0.3349 | dist: 0.0986
Step: 118  | D:  0.3088 | CE:  0.3808 | S_OoD:  0.7239 | S_z:  0.3503 | G: -0.0003 | S_z:  0.3487 | dist: 0.1686
Step: 218  | D:  0.0227 | CE:  0.0957 | S_OoD:  0.7336 | S_z:  0.3909 | G: -0.0004 | S_z:  0.3888 | dist: 0.1794
Step: 318  | D:  0.4101 | CE:  0.4788 | S_OoD:  0.6910 | S_z:  0.3939 | G: -0.0004 | S_z:  0.4219 | dist: 0.2643
Step: 418  | D:  0.1232 | CE:  0.1967 | S_OoD:  0.7394 | S_z:  0.3695 | G: -0.0004 | S_z:  0.3650 | dist: 0.1037
Step: 518  | D: -0.0092 | CE:  0.0639 | S_OoD:  0.7346 | S_z:  0.3515 | G: -0.0003 | S_z:  0.3478 | dist: 0.1423
Step: 618  | D:  0.1742 | CE:  0.2439 | S_OoD:  0.7006 | S_z:  0.3444 | G: -0.0003 | S_z:  0.3397 | dist: 0.1965
Step: 718  | D:  0.0756 | CE:  0.1471 | S_OoD:  0.7187 | S_z:  0.3234 | G: -0.0003 | S_z:  0.3196 | dist: 0.1497
Step: 818  | D:  0.3244 | CE:  0.3971 | S_OoD:  0.7305 | S_z:  0.3981 | G: -0.0004 | S_z:  0.4045 | dist: 0.2029
Step: 918  | D: -0.0113 | CE:  0.0566 | S_OoD:  0.6823 | S_z:  0.3312 | G: -0.0003 | S_z:  0.3310 | dist: 0.3415
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.20399385560675887
mean: 0.20399 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.2208658963441849
mean: 0.22087 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.07096774193548383
mean: 0.07097 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.3089078354835519
mean: 0.30891 | std: 0.0 | MAD: 0.0
AUROC: 0.8655643878229763

Validation Accuracy: 0.9155439951705105
Validation Classification Loss: 0.2818771463640955
New checkpoint created at the end of epoch 3.
Step: 24   | D:  0.1048 | CE:  0.1718 | S_OoD:  0.6729 | S_z:  0.3248 | G: -0.0003 | S_z:  0.3070 | dist: 0.3212
Step: 124  | D:  0.0975 | CE:  0.1689 | S_OoD:  0.7169 | S_z:  0.3689 | G: -0.0004 | S_z:  0.3729 | dist: 0.2381
Step: 224  | D:  0.0404 | CE:  0.1136 | S_OoD:  0.7356 | S_z:  0.3100 | G: -0.0003 | S_z:  0.3171 | dist: 0.0802
Step: 324  | D: -0.0357 | CE:  0.0342 | S_OoD:  0.7028 | S_z:  0.4290 | G: -0.0004 | S_z:  0.4305 | dist: 0.0023
Step: 424  | D:  0.2690 | CE:  0.3393 | S_OoD:  0.7070 | S_z:  0.3738 | G: -0.0004 | S_z:  0.3763 | dist: 0.2467
Step: 524  | D:  0.0454 | CE:  0.1166 | S_OoD:  0.7149 | S_z:  0.3378 | G: -0.0003 | S_z:  0.3386 | dist: 0.2422
Step: 624  | D:  0.0583 | CE:  0.1335 | S_OoD:  0.7549 | S_z:  0.3431 | G: -0.0003 | S_z:  0.3406 | dist: 0.0064
Step: 724  | D:  0.0942 | CE:  0.1673 | S_OoD:  0.7337 | S_z:  0.2736 | G: -0.0003 | S_z:  0.2607 | dist: 0.1725
Step: 824  | D: -0.0026 | CE:  0.0708 | S_OoD:  0.7381 | S_z:  0.3316 | G: -0.0003 | S_z:  0.3385 | dist: 0.0902
Step: 924  | D:  0.2345 | CE:  0.3084 | S_OoD:  0.7427 | S_z:  0.3236 | G: -0.0003 | S_z:  0.3347 | dist: 0.2408
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.11336405529953919
mean: 0.11336 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.20175364017486572
mean: 0.20175 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.029800307219662092
mean: 0.0298 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.30148533463478105
mean: 0.30149 | std: 0.0 | MAD: 0.0
AUROC: 0.8616921953567438

Validation Accuracy: 0.9205143960674157
Validation Classification Loss: 0.2661874861236704
Step: 30   | D:  0.0112 | CE:  0.0799 | S_OoD:  0.6899 | S_z:  0.2809 | G: -0.0003 | S_z:  0.2748 | dist: 0.0355
Step: 130  | D: -0.0375 | CE:  0.0334 | S_OoD:  0.7117 | S_z:  0.2819 | G: -0.0003 | S_z:  0.2810 | dist: 0.2859
Step: 230  | D:  0.0925 | CE:  0.1658 | S_OoD:  0.7370 | S_z:  0.3489 | G: -0.0003 | S_z:  0.3460 | dist: 0.0199
Step: 330  | D: -0.0334 | CE:  0.0415 | S_OoD:  0.7531 | S_z:  0.3549 | G: -0.0004 | S_z:  0.3540 | dist: 0.2689
Step: 430  | D: -0.0109 | CE:  0.0655 | S_OoD:  0.7665 | S_z:  0.2460 | G: -0.0003 | S_z:  0.2504 | dist: 0.0190
Step: 530  | D: -0.0250 | CE:  0.0489 | S_OoD:  0.7415 | S_z:  0.2769 | G: -0.0003 | S_z:  0.2736 | dist: 0.1534
Step: 630  | D:  0.0088 | CE:  0.0852 | S_OoD:  0.7663 | S_z:  0.3060 | G: -0.0003 | S_z:  0.2982 | dist: 0.0064
Step: 730  | D:  0.0891 | CE:  0.1631 | S_OoD:  0.7436 | S_z:  0.3227 | G: -0.0003 | S_z:  0.3183 | dist: 0.2194
Step: 830  | D:  0.0895 | CE:  0.1617 | S_OoD:  0.7257 | S_z:  0.3167 | G: -0.0003 | S_z:  0.3035 | dist: 0.2530
Step: 930  | D:  0.0588 | CE:  0.1344 | S_OoD:  0.7592 | S_z:  0.2362 | G: -0.0002 | S_z:  0.2390 | dist: 0.3121
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.42519201228878645
mean: 0.42519 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.15549846887588503
mean: 0.1555 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.12903225806451613
mean: 0.12903 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2906556046009064
mean: 0.29066 | std: 0.0 | MAD: 0.0
AUROC: 0.9394689322987111

Validation Accuracy: 0.9413461893849793
Validation Classification Loss: 0.20574671170266157
Step: 36   | D: -0.0190 | CE:  0.0550 | S_OoD:  0.7433 | S_z:  0.3159 | G: -0.0003 | S_z:  0.3076 | dist: 0.2204
Step: 136  | D: -0.0405 | CE:  0.0354 | S_OoD:  0.7612 | S_z:  0.3138 | G: -0.0003 | S_z:  0.3132 | dist: 0.0409
Step: 236  | D:  0.0848 | CE:  0.1609 | S_OoD:  0.7642 | S_z:  0.3081 | G: -0.0003 | S_z:  0.3013 | dist: 0.1312
Step: 336  | D:  0.0626 | CE:  0.1398 | S_OoD:  0.7754 | S_z:  0.3562 | G: -0.0004 | S_z:  0.3575 | dist: 0.1193
Step: 436  | D:  0.0719 | CE:  0.1464 | S_OoD:  0.7473 | S_z:  0.2506 | G: -0.0003 | S_z:  0.2562 | dist: 0.1639
Step: 536  | D:  0.0838 | CE:  0.1611 | S_OoD:  0.7756 | S_z:  0.2568 | G: -0.0003 | S_z:  0.2595 | dist: 0.3087
Step: 636  | D: -0.0465 | CE:  0.0280 | S_OoD:  0.7483 | S_z:  0.3016 | G: -0.0003 | S_z:  0.2992 | dist: 0.1585
Step: 736  | D:  0.0350 | CE:  0.1126 | S_OoD:  0.7793 | S_z:  0.2926 | G: -0.0003 | S_z:  0.2924 | dist: 0.2268
Step: 836  | D: -0.0652 | CE:  0.0119 | S_OoD:  0.7746 | S_z:  0.2737 | G: -0.0003 | S_z:  0.2786 | dist: 0.2395
Step: 936  | D:  0.0450 | CE:  0.1228 | S_OoD:  0.7806 | S_z:  0.3023 | G: -0.0003 | S_z:  0.3074 | dist: 0.2019
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.31059907834101386
mean: 0.3106 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.1697465240955353
mean: 0.16975 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.09155145929339481
mean: 0.09155 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.29568599820137054
mean: 0.29569 | std: 0.0 | MAD: 0.0
AUROC: 0.9064475192487746

Validation Accuracy: 0.9306915902818845
Validation Classification Loss: 0.24530896834317553
Step: 42   | D:  0.1849 | CE:  0.2605 | S_OoD:  0.7600 | S_z:  0.3527 | G: -0.0003 | S_z:  0.3482 | dist: 0.0740
Step: 142  | D: -0.0272 | CE:  0.0483 | S_OoD:  0.7586 | S_z:  0.3021 | G: -0.0003 | S_z:  0.2985 | dist: 0.0840
Step: 242  | D: -0.0264 | CE:  0.0512 | S_OoD:  0.7791 | S_z:  0.3197 | G: -0.0003 | S_z:  0.3149 | dist: 0.0622
Step: 342  | D: -0.0413 | CE:  0.0382 | S_OoD:  0.7979 | S_z:  0.2739 | G: -0.0003 | S_z:  0.2644 | dist: 0.1866
Step: 442  | D: -0.0035 | CE:  0.0744 | S_OoD:  0.7828 | S_z:  0.3043 | G: -0.0003 | S_z:  0.3038 | dist: 0.1759
Step: 542  | D: -0.0580 | CE:  0.0192 | S_OoD:  0.7749 | S_z:  0.3196 | G: -0.0003 | S_z:  0.3191 | dist: 0.2487
Step: 642  | D: -0.0415 | CE:  0.0338 | S_OoD:  0.7555 | S_z:  0.2771 | G: -0.0003 | S_z:  0.2769 | dist: 0.3369
Step: 742  | D: -0.0274 | CE:  0.0504 | S_OoD:  0.7807 | S_z:  0.2779 | G: -0.0003 | S_z:  0.2882 | dist: 0.1592
Step: 842  | D:  0.0806 | CE:  0.1586 | S_OoD:  0.7835 | S_z:  0.3340 | G: -0.0003 | S_z:  0.3393 | dist: 0.2092
Step: 942  | D:  0.0378 | CE:  0.1155 | S_OoD:  0.7793 | S_z:  0.2521 | G: -0.0002 | S_z:  0.2458 | dist: 0.1246
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9864823348694316
mean: 0.98648 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.09281898438930523
mean: 0.09282 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.861136712749616
mean: 0.86114 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.27472579956054705
mean: 0.27473 | std: 0.0 | MAD: 0.0
AUROC: 0.9949767690167952

Validation Accuracy: 0.9543600926473487
Validation Classification Loss: 0.16583479430625905
New checkpoint created at the end of epoch 7.
Step: 48   | D: -0.0229 | CE:  0.0530 | S_OoD:  0.7622 | S_z:  0.3331 | G: -0.0003 | S_z:  0.3380 | dist: 0.1778
Step: 148  | D: -0.0279 | CE:  0.0443 | S_OoD:  0.7248 | S_z:  0.2673 | G: -0.0003 | S_z:  0.2693 | dist: 0.2281
Step: 248  | D:  0.0616 | CE:  0.1402 | S_OoD:  0.7882 | S_z:  0.2850 | G: -0.0003 | S_z:  0.2778 | dist: 0.0785
Step: 348  | D:  0.0147 | CE:  0.0937 | S_OoD:  0.7921 | S_z:  0.2787 | G: -0.0003 | S_z:  0.2858 | dist: 0.3298
Step: 448  | D:  0.0235 | CE:  0.1014 | S_OoD:  0.7818 | S_z:  0.2640 | G: -0.0003 | S_z:  0.2673 | dist: 0.0882
Step: 548  | D:  0.0209 | CE:  0.0978 | S_OoD:  0.7719 | S_z:  0.3069 | G: -0.0003 | S_z:  0.2989 | dist: 0.2769
Step: 648  | D: -0.0028 | CE:  0.0754 | S_OoD:  0.7851 | S_z:  0.2755 | G: -0.0003 | S_z:  0.2673 | dist: 0.1259
Step: 748  | D: -0.0195 | CE:  0.0580 | S_OoD:  0.7785 | S_z:  0.2882 | G: -0.0003 | S_z:  0.2969 | dist: 0.1805
Step: 848  | D:  0.0651 | CE:  0.1432 | S_OoD:  0.7845 | S_z:  0.3060 | G: -0.0003 | S_z:  0.3165 | dist: 0.0416
Step: 948  | D: -0.0544 | CE:  0.0263 | S_OoD:  0.8106 | S_z:  0.3496 | G: -0.0003 | S_z:  0.3456 | dist: 0.1661
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.19754224270353304
mean: 0.19754 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.1634353429079056
mean: 0.16344 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.03164362519201225
mean: 0.03164 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2939693140983582
mean: 0.29397 | std: 0.0 | MAD: 0.0
AUROC: 0.9123103810153707

Validation Accuracy: 0.9299015621919969
Validation Classification Loss: 0.2388848474228315
Step: 54   | D: -0.0509 | CE:  0.0248 | S_OoD:  0.7598 | S_z:  0.2360 | G: -0.0002 | S_z:  0.2316 | dist: 0.3292
Step: 154  | D: -0.0269 | CE:  0.0517 | S_OoD:  0.7884 | S_z:  0.2546 | G: -0.0003 | S_z:  0.2544 | dist: 0.3717
Step: 254  | D: -0.0155 | CE:  0.0648 | S_OoD:  0.8063 | S_z:  0.3204 | G: -0.0003 | S_z:  0.3209 | dist: 0.2415
Step: 354  | D: -0.0702 | CE:  0.0097 | S_OoD:  0.8021 | S_z:  0.2835 | G: -0.0003 | S_z:  0.2853 | dist: 0.1152
Step: 454  | D:  0.0981 | CE:  0.1766 | S_OoD:  0.7879 | S_z:  0.2771 | G: -0.0003 | S_z:  0.2896 | dist: 0.1458
Step: 554  | D:  0.1196 | CE:  0.1992 | S_OoD:  0.7980 | S_z:  0.2264 | G: -0.0002 | S_z:  0.2196 | dist: 0.2317
Step: 654  | D:  0.0162 | CE:  0.0957 | S_OoD:  0.7980 | S_z:  0.3163 | G: -0.0003 | S_z:  0.3218 | dist: 0.2444
Step: 754  | D:  0.0827 | CE:  0.1597 | S_OoD:  0.7723 | S_z:  0.2409 | G: -0.0002 | S_z:  0.2466 | dist: 0.0015
Step: 854  | D: -0.0514 | CE:  0.0254 | S_OoD:  0.7713 | S_z:  0.2886 | G: -0.0003 | S_z:  0.2932 | dist: 0.1136
Step: 954  | D:  0.0415 | CE:  0.1226 | S_OoD:  0.8145 | S_z:  0.2667 | G: -0.0003 | S_z:  0.2571 | dist: 0.0170
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9895545314900154
mean: 0.98955 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.10133847296237981
mean: 0.10134 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.8599078341013825
mean: 0.85991 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2771565198898317
mean: 0.27716 | std: 0.0 | MAD: 0.0
AUROC: 0.9952957233720088

Validation Accuracy: 0.946596873151981
Validation Classification Loss: 0.19014067997046735
Step: 60   | D: -0.0207 | CE:  0.0587 | S_OoD:  0.7959 | S_z:  0.2320 | G: -0.0002 | S_z:  0.2287 | dist: 0.1513
Step: 160  | D: -0.0222 | CE:  0.0543 | S_OoD:  0.7672 | S_z:  0.2004 | G: -0.0002 | S_z:  0.2169 | dist: 0.0358
Step: 260  | D:  0.0115 | CE:  0.0905 | S_OoD:  0.7927 | S_z:  0.2136 | G: -0.0002 | S_z:  0.2261 | dist: 0.1049
Step: 360  | D: -0.0216 | CE:  0.0577 | S_OoD:  0.7959 | S_z:  0.2346 | G: -0.0002 | S_z:  0.2380 | dist: 0.1175
Step: 460  | D:  0.0662 | CE:  0.1460 | S_OoD:  0.8000 | S_z:  0.2548 | G: -0.0002 | S_z:  0.2490 | dist: 0.0979
Step: 560  | D:  0.0258 | CE:  0.1042 | S_OoD:  0.7870 | S_z:  0.2639 | G: -0.0003 | S_z:  0.2625 | dist: 0.0267
Step: 660  | D: -0.0240 | CE:  0.0549 | S_OoD:  0.7924 | S_z:  0.3247 | G: -0.0003 | S_z:  0.3227 | dist: 0.0719
Step: 760  | D:  0.0905 | CE:  0.1681 | S_OoD:  0.7784 | S_z:  0.2156 | G: -0.0002 | S_z:  0.2191 | dist: 0.3069
Step: 860  | D: -0.0602 | CE:  0.0184 | S_OoD:  0.7882 | S_z:  0.2372 | G: -0.0002 | S_z:  0.2427 | dist: 0.0876
Step: 960  | D: -0.0607 | CE:  0.0200 | S_OoD:  0.8096 | S_z:  0.2691 | G: -0.0003 | S_z:  0.2696 | dist: 0.1573
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.4552995391705069
mean: 0.4553 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.12249573171138764
mean: 0.1225 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.15514592933947768
mean: 0.15515 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2741405987739564
mean: 0.27414 | std: 0.0 | MAD: 0.0
AUROC: 0.9421220250276726

Validation Accuracy: 0.9403259289375124
Validation Classification Loss: 0.2228705080205135
Step: 66   | D:  0.0057 | CE:  0.0821 | S_OoD:  0.7668 | S_z:  0.2428 | G: -0.0002 | S_z:  0.2376 | dist: 0.0142
Step: 166  | D: -0.0568 | CE:  0.0246 | S_OoD:  0.8162 | S_z:  0.1915 | G: -0.0002 | S_z:  0.1864 | dist: 0.4256
Step: 266  | D: -0.0256 | CE:  0.0529 | S_OoD:  0.7868 | S_z:  0.2181 | G: -0.0002 | S_z:  0.2075 | dist: 0.2646
Step: 366  | D: -0.0694 | CE:  0.0115 | S_OoD:  0.8116 | S_z:  0.2396 | G: -0.0002 | S_z:  0.2360 | dist: 0.2796
Step: 466  | D: -0.0607 | CE:  0.0189 | S_OoD:  0.7981 | S_z:  0.2485 | G: -0.0003 | S_z:  0.2501 | dist: 0.0063
Step: 566  | D: -0.0454 | CE:  0.0353 | S_OoD:  0.8087 | S_z:  0.2291 | G: -0.0002 | S_z:  0.2359 | dist: 0.1123
Step: 666  | D: -0.0148 | CE:  0.0655 | S_OoD:  0.8058 | S_z:  0.2398 | G: -0.0002 | S_z:  0.2270 | dist: 0.2385
Step: 766  | D:  0.0358 | CE:  0.1162 | S_OoD:  0.8071 | S_z:  0.2549 | G: -0.0003 | S_z:  0.2584 | dist: 0.1672
Step: 866  | D: -0.0528 | CE:  0.0281 | S_OoD:  0.8114 | S_z:  0.2543 | G: -0.0002 | S_z:  0.2420 | dist: 0.1651
Step: 966  | D: -0.0603 | CE:  0.0195 | S_OoD:  0.7998 | S_z:  0.2386 | G: -0.0002 | S_z:  0.2383 | dist: 0.0567
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.2789554531490015
mean: 0.27896 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.1296117424964906
mean: 0.12961 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.07188940092165896
mean: 0.07189 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.28583183884620683
mean: 0.28583 | std: 0.0 | MAD: 0.0
AUROC: 0.9198964757276977

Validation Accuracy: 0.9380328454563374
Validation Classification Loss: 0.23992513859477105
New checkpoint created at the end of epoch 11.
Step: 72   | D: -0.0526 | CE:  0.0278 | S_OoD:  0.8051 | S_z:  0.1840 | G: -0.0002 | S_z:  0.1966 | dist: 0.1472
Step: 172  | D: -0.0309 | CE:  0.0485 | S_OoD:  0.7956 | S_z:  0.1685 | G: -0.0002 | S_z:  0.1761 | dist: 0.1850
Step: 272  | D: -0.0510 | CE:  0.0303 | S_OoD:  0.8145 | S_z:  0.1927 | G: -0.0002 | S_z:  0.2048 | dist: 0.0975
Step: 372  | D: -0.0563 | CE:  0.0217 | S_OoD:  0.7826 | S_z:  0.2208 | G: -0.0002 | S_z:  0.2200 | dist: 0.0317
Step: 472  | D: -0.0210 | CE:  0.0590 | S_OoD:  0.8026 | S_z:  0.2138 | G: -0.0002 | S_z:  0.2088 | dist: 0.1479
Step: 572  | D: -0.0657 | CE:  0.0152 | S_OoD:  0.8114 | S_z:  0.2742 | G: -0.0003 | S_z:  0.2730 | dist: 0.2984
Step: 672  | D: -0.0542 | CE:  0.0276 | S_OoD:  0.8200 | S_z:  0.2071 | G: -0.0002 | S_z:  0.2034 | dist: 0.2069
Step: 772  | D:  0.0881 | CE:  0.1692 | S_OoD:  0.8134 | S_z:  0.2593 | G: -0.0002 | S_z:  0.2471 | dist: 0.0716
Step: 872  | D:  0.0453 | CE:  0.1268 | S_OoD:  0.8177 | S_z:  0.2551 | G: -0.0003 | S_z:  0.2501 | dist: 0.1474
Step: 972  | D:  0.0377 | CE:  0.1166 | S_OoD:  0.7916 | S_z:  0.2677 | G: -0.0003 | S_z:  0.2559 | dist: 0.0973
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.35238095238095235
mean: 0.35238 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.1550507575273516
mean: 0.15505 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.11643625192012286
mean: 0.11644 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.28856916427612334
mean: 0.28857 | std: 0.0 | MAD: 0.0
AUROC: 0.9308510815509244

Validation Accuracy: 0.9255787379262764
Validation Classification Loss: 0.2670348102980283
Step: 78   | D: -0.0580 | CE:  0.0216 | S_OoD:  0.7987 | S_z:  0.1960 | G: -0.0002 | S_z:  0.1979 | dist: 0.0838
Step: 178  | D: -0.0348 | CE:  0.0467 | S_OoD:  0.8165 | S_z:  0.1957 | G: -0.0002 | S_z:  0.1992 | dist: 0.2411
Step: 278  | D: -0.0415 | CE:  0.0380 | S_OoD:  0.7971 | S_z:  0.1915 | G: -0.0002 | S_z:  0.1927 | dist: 0.1528
Step: 378  | D:  0.0300 | CE:  0.1126 | S_OoD:  0.8276 | S_z:  0.2021 | G: -0.0002 | S_z:  0.2098 | dist: 0.0113
Step: 478  | D:  0.0849 | CE:  0.1656 | S_OoD:  0.8087 | S_z:  0.2057 | G: -0.0002 | S_z:  0.2154 | dist: 0.3473
Step: 578  | D: -0.0339 | CE:  0.0480 | S_OoD:  0.8206 | S_z:  0.2166 | G: -0.0002 | S_z:  0.2199 | dist: 0.1817
Step: 678  | D: -0.0335 | CE:  0.0461 | S_OoD:  0.7992 | S_z:  0.2160 | G: -0.0002 | S_z:  0.2126 | dist: 0.2694
Step: 778  | D: -0.0374 | CE:  0.0453 | S_OoD:  0.8299 | S_z:  0.2502 | G: -0.0002 | S_z:  0.2456 | dist: 0.3102
Step: 878  | D:  0.0543 | CE:  0.1357 | S_OoD:  0.8163 | S_z:  0.2047 | G: -0.0002 | S_z:  0.2173 | dist: 0.3857
Step: 978  | D: -0.0214 | CE:  0.0579 | S_OoD:  0.7947 | S_z:  0.1913 | G: -0.0002 | S_z:  0.2122 | dist: 0.1017
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.5649769585253457
mean: 0.56498 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.10396914482116722
mean: 0.10397 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.2036866359447005
mean: 0.20369 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2694730877876287
mean: 0.26947 | std: 0.0 | MAD: 0.0
AUROC: 0.953083550273415

Validation Accuracy: 0.9362056167455155
Validation Classification Loss: 0.2539493056600181
