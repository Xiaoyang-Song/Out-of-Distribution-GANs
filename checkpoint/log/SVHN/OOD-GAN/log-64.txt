
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: SVHN
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 64
Input Dimension: 32 x 32 x 3
Number of InD classes: 8
Number of Epochs: 25.
Hyperparameters: lambda_ce=1 & lambda_w=1 & scaling=0.1 & d_lr=0.001 & g_lr=0.005 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
Using downloaded and verified file: ./Datasets/SVHN/train_32x32.mat
Using downloaded and verified file: ./Datasets/SVHN/test_32x32.mat
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Counter({8: 64, 9: 64})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([128, 3, 32, 32])
Step: 0    | D:  1.4165 | CE:  2.1345 | S_OoD:  0.7983 | S_z:  0.8037 | G: -0.0835 | S_z:  0.8354 | dist: 0.2655
Step: 100  | D:  1.0823 | CE:  1.7979 | S_OoD:  0.7976 | S_z:  0.8198 | G: -0.0808 | S_z:  0.8080 | dist: 0.1695
Step: 200  | D:  0.4672 | CE:  1.1429 | S_OoD:  0.7262 | S_z:  0.5055 | G: -0.0491 | S_z:  0.4909 | dist: 0.3153
Step: 300  | D: -0.0932 | CE:  0.6431 | S_OoD:  0.7639 | S_z:  0.2756 | G: -0.0236 | S_z:  0.2364 | dist: 0.1046
Step: 400  | D: -0.3402 | CE:  0.4270 | S_OoD:  0.7838 | S_z:  0.1670 | G: -0.0077 | S_z:  0.0767 | dist: 0.1558
Step: 500  | D: -0.4473 | CE:  0.3431 | S_OoD:  0.7961 | S_z:  0.0568 | G: -0.0043 | S_z:  0.0426 | dist: 0.0459
Step: 600  | D: -0.5974 | CE:  0.2300 | S_OoD:  0.8327 | S_z:  0.0529 | G: -0.0035 | S_z:  0.0348 | dist: 0.1118
Step: 700  | D: -0.4826 | CE:  0.3373 | S_OoD:  0.8235 | S_z:  0.0358 | G: -0.0020 | S_z:  0.0198 | dist: 0.1044
Step: 800  | D: -0.5810 | CE:  0.2237 | S_OoD:  0.8084 | S_z:  0.0371 | G: -0.0020 | S_z:  0.0203 | dist: 0.2531
Step: 900  | D: -0.4252 | CE:  0.4005 | S_OoD:  0.8283 | S_z:  0.0254 | G: -0.0020 | S_z:  0.0203 | dist: 0.0191
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.23256528417818745
mean: 0.23257 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.24641435742378237
mean: 0.24641 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.049769585253456206
mean: 0.04977 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.33346796274185225
mean: 0.33347 | std: 0.0 | MAD: 0.0
AUROC: 0.9118933812756246

Validation Accuracy: 0.9119288081509955
Validation Classification Loss: 0.2927073794050833
Step: 6    | D: -0.5598 | CE:  0.2602 | S_OoD:  0.8219 | S_z:  0.0194 | G: -0.0016 | S_z:  0.0158 | dist: 0.0139
Step: 106  | D: -0.6308 | CE:  0.2029 | S_OoD:  0.8363 | S_z:  0.0259 | G: -0.0012 | S_z:  0.0116 | dist: 0.0464
Step: 206  | D: -0.4225 | CE:  0.4171 | S_OoD:  0.8423 | S_z:  0.0267 | G: -0.0012 | S_z:  0.0122 | dist: 0.1902
Step: 306  | D: -0.5885 | CE:  0.2516 | S_OoD:  0.8412 | S_z:  0.0116 | G: -0.0009 | S_z:  0.0093 | dist: 0.0492
Step: 406  | D: -0.6986 | CE:  0.1439 | S_OoD:  0.8436 | S_z:  0.0099 | G: -0.0008 | S_z:  0.0078 | dist: 0.0547
Step: 506  | D: -0.6914 | CE:  0.1524 | S_OoD:  0.8450 | S_z:  0.0120 | G: -0.0008 | S_z:  0.0077 | dist: 0.0365
Step: 606  | D: -0.5583 | CE:  0.2887 | S_OoD:  0.8477 | S_z:  0.0061 | G: -0.0007 | S_z:  0.0069 | dist: 0.0165
Step: 706  | D: -0.7231 | CE:  0.1243 | S_OoD:  0.8483 | S_z:  0.0085 | G: -0.0007 | S_z:  0.0069 | dist: 0.1214
Step: 806  | D: -0.6569 | CE:  0.1912 | S_OoD:  0.8495 | S_z:  0.0134 | G: -0.0009 | S_z:  0.0086 | dist: 0.2309
Step: 906  | D: -0.5986 | CE:  0.2509 | S_OoD:  0.8500 | S_z:  0.0055 | G: -0.0005 | S_z:  0.0052 | dist: 0.3514
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.5705069124423963
mean: 0.57051 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.21030413806438447
mean: 0.2103 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.1754224270353303
mean: 0.17542 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.31141302108764674
mean: 0.31141 | std: 0.0 | MAD: 0.0
AUROC: 0.9549040732671078

Validation Accuracy: 0.9309549329785137
Validation Classification Loss: 0.23513959779330854
Step: 12   | D: -0.7319 | CE:  0.1112 | S_OoD:  0.8440 | S_z:  0.0090 | G: -0.0008 | S_z:  0.0080 | dist: 0.0027
Step: 112  | D: -0.7991 | CE:  0.0570 | S_OoD:  0.8565 | S_z:  0.0040 | G: -0.0004 | S_z:  0.0041 | dist: 0.0071
Step: 212  | D: -0.6888 | CE:  0.1574 | S_OoD:  0.8467 | S_z:  0.0044 | G: -0.0005 | S_z:  0.0049 | dist: 0.3297
Step: 312  | D: -0.7145 | CE:  0.1372 | S_OoD:  0.8521 | S_z:  0.0046 | G: -0.0004 | S_z:  0.0045 | dist: 0.0075
Step: 412  | D: -0.6559 | CE:  0.1967 | S_OoD:  0.8530 | S_z:  0.0035 | G: -0.0004 | S_z:  0.0039 | dist: 0.1687
Step: 512  | D: -0.7481 | CE:  0.1006 | S_OoD:  0.8491 | S_z:  0.0047 | G: -0.0006 | S_z:  0.0057 | dist: 0.1465
Step: 612  | D: -0.6016 | CE:  0.2417 | S_OoD:  0.8437 | S_z:  0.0037 | G: -0.0004 | S_z:  0.0038 | dist: 0.2562
Step: 712  | D: -0.7717 | CE:  0.0868 | S_OoD:  0.8593 | S_z:  0.0085 | G: -0.0005 | S_z:  0.0047 | dist: 0.1627
Step: 812  | D: -0.6921 | CE:  0.1660 | S_OoD:  0.8584 | S_z:  0.0034 | G: -0.0004 | S_z:  0.0039 | dist: 0.0335
Step: 912  | D: -0.6743 | CE:  0.1796 | S_OoD:  0.8549 | S_z:  0.0093 | G: -0.0006 | S_z:  0.0055 | dist: 0.2635
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.4470046082949308
mean: 0.447 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.18688168525695803
mean: 0.18688 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.18494623655913978
mean: 0.18495 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2995535254478456
mean: 0.29955 | std: 0.0 | MAD: 0.0
AUROC: 0.9215986604105916

Validation Accuracy: 0.9245361472501478
Validation Classification Loss: 0.25347008274637917
Step: 18   | D: -0.6528 | CE:  0.1998 | S_OoD:  0.8529 | S_z:  0.0038 | G: -0.0004 | S_z:  0.0042 | dist: 0.0935
Step: 118  | D: -0.7251 | CE:  0.1256 | S_OoD:  0.8518 | S_z:  0.0106 | G: -0.0009 | S_z:  0.0088 | dist: 0.2683
Step: 218  | D: -0.6768 | CE:  0.1692 | S_OoD:  0.8462 | S_z:  0.0026 | G: -0.0003 | S_z:  0.0032 | dist: 0.1199
Step: 318  | D: -0.6801 | CE:  0.1748 | S_OoD:  0.8552 | S_z:  0.0032 | G: -0.0003 | S_z:  0.0030 | dist: 0.0281
Step: 418  | D: -0.6466 | CE:  0.2135 | S_OoD:  0.8604 | S_z:  0.0033 | G: -0.0004 | S_z:  0.0036 | dist: 0.0405
Step: 518  | D: -0.7076 | CE:  0.1487 | S_OoD:  0.8567 | S_z:  0.0049 | G: -0.0005 | S_z:  0.0055 | dist: 0.2730
Step: 618  | D: -0.8400 | CE:  0.0178 | S_OoD:  0.8581 | S_z:  0.0024 | G: -0.0002 | S_z:  0.0024 | dist: 0.2141
Step: 718  | D: -0.7184 | CE:  0.1374 | S_OoD:  0.8563 | S_z:  0.0041 | G: -0.0004 | S_z:  0.0041 | dist: 0.1087
Step: 818  | D: -0.7750 | CE:  0.0788 | S_OoD:  0.8542 | S_z:  0.0032 | G: -0.0003 | S_z:  0.0030 | dist: 0.0332
Step: 918  | D: -0.6401 | CE:  0.2135 | S_OoD:  0.8542 | S_z:  0.0050 | G: -0.0004 | S_z:  0.0045 | dist: 0.2358
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.996620583717358
mean: 0.99662 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.12650529742240915
mean: 0.12651 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9766513056835637
mean: 0.97665 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2859420061111454
mean: 0.28594 | std: 0.0 | MAD: 0.0
AUROC: 0.9989787714679973

Validation Accuracy: 0.9523134116893357
Validation Classification Loss: 0.16818148472210329
New checkpoint created at the end of epoch 3.
Step: 24   | D: -0.8269 | CE:  0.0327 | S_OoD:  0.8599 | S_z:  0.0026 | G: -0.0002 | S_z:  0.0025 | dist: 0.0424
Step: 124  | D: -0.7985 | CE:  0.0594 | S_OoD:  0.8582 | S_z:  0.0020 | G: -0.0002 | S_z:  0.0020 | dist: 0.0566
Step: 224  | D: -0.7902 | CE:  0.0642 | S_OoD:  0.8546 | S_z:  0.0020 | G: -0.0002 | S_z:  0.0020 | dist: 0.2519
Step: 324  | D: -0.6858 | CE:  0.1701 | S_OoD:  0.8562 | S_z:  0.0026 | G: -0.0003 | S_z:  0.0025 | dist: 0.2044
Step: 424  | D: -0.8143 | CE:  0.0437 | S_OoD:  0.8582 | S_z:  0.0016 | G: -0.0002 | S_z:  0.0018 | dist: 0.1025
Step: 524  | D: -0.7065 | CE:  0.1542 | S_OoD:  0.8610 | S_z:  0.0028 | G: -0.0003 | S_z:  0.0027 | dist: 0.1443
Step: 624  | D: -0.7154 | CE:  0.1415 | S_OoD:  0.8572 | S_z:  0.0033 | G: -0.0004 | S_z:  0.0037 | dist: 0.1212
Step: 724  | D: -0.6632 | CE:  0.1895 | S_OoD:  0.8531 | S_z:  0.0043 | G: -0.0003 | S_z:  0.0033 | dist: 0.1540
Step: 824  | D: -0.7515 | CE:  0.1044 | S_OoD:  0.8562 | S_z:  0.0032 | G: -0.0003 | S_z:  0.0029 | dist: 0.2076
Step: 924  | D: -0.8381 | CE:  0.0201 | S_OoD:  0.8584 | S_z:  0.0018 | G: -0.0002 | S_z:  0.0017 | dist: 0.2109
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9944700460829493
mean: 0.99447 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.12256995141506197
mean: 0.12257 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9794162826420891
mean: 0.97942 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2822011041641236
mean: 0.2822 | std: 0.0 | MAD: 0.0
AUROC: 0.9989216491398233

Validation Accuracy: 0.9510020882613837
Validation Classification Loss: 0.1722735083567795
Step: 30   | D: -0.7835 | CE:  0.0712 | S_OoD:  0.8549 | S_z:  0.0019 | G: -0.0002 | S_z:  0.0017 | dist: 0.2494
Step: 130  | D: -0.8003 | CE:  0.0562 | S_OoD:  0.8566 | S_z:  0.0016 | G: -0.0002 | S_z:  0.0017 | dist: 0.1073
Step: 230  | D: -0.7217 | CE:  0.1332 | S_OoD:  0.8551 | S_z:  0.0020 | G: -0.0002 | S_z:  0.0019 | dist: 0.0600
Step: 330  | D: -0.6281 | CE:  0.2315 | S_OoD:  0.8599 | S_z:  0.0025 | G: -0.0003 | S_z:  0.0028 | dist: 0.0149
Step: 430  | D: -0.7306 | CE:  0.1249 | S_OoD:  0.8559 | S_z:  0.0032 | G: -0.0003 | S_z:  0.0030 | dist: 0.2807
Step: 530  | D: -0.6950 | CE:  0.1644 | S_OoD:  0.8597 | S_z:  0.0029 | G: -0.0003 | S_z:  0.0031 | dist: 0.1144
Step: 630  | D: -0.6871 | CE:  0.1704 | S_OoD:  0.8577 | S_z:  0.0016 | G: -0.0002 | S_z:  0.0017 | dist: 0.2206
Step: 730  | D: -0.7166 | CE:  0.1425 | S_OoD:  0.8593 | S_z:  0.0019 | G: -0.0002 | S_z:  0.0022 | dist: 0.0033
Step: 830  | D: -0.7976 | CE:  0.0598 | S_OoD:  0.8577 | S_z:  0.0026 | G: -0.0002 | S_z:  0.0025 | dist: 0.2644
Step: 930  | D: -0.7194 | CE:  0.1386 | S_OoD:  0.8581 | S_z:  0.0016 | G: -0.0002 | S_z:  0.0017 | dist: 0.2963
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.8980030721966206
mean: 0.898 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.14854423105716716
mean: 0.14854 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.14039938556067588
mean: 0.1404 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.2926594305038456
mean: 0.29266 | std: 0.0 | MAD: 0.0
AUROC: 0.9715202369167107

Validation Accuracy: 0.9357613221959393
Validation Classification Loss: 0.2206996754125765
Step: 36   | D: -0.7726 | CE:  0.0911 | S_OoD:  0.8639 | S_z:  0.0026 | G: -0.0002 | S_z:  0.0023 | dist: 0.1568
Step: 136  | D: -0.7261 | CE:  0.1362 | S_OoD:  0.8626 | S_z:  0.0032 | G: -0.0004 | S_z:  0.0035 | dist: 0.1209
Step: 236  | D: -0.7589 | CE:  0.0995 | S_OoD:  0.8590 | S_z:  0.0066 | G: -0.0007 | S_z:  0.0067 | dist: 0.0790
Step: 336  | D: -0.8440 | CE:  0.0133 | S_OoD:  0.8575 | S_z:  0.0013 | G: -0.0001 | S_z:  0.0012 | dist: 0.0759
Step: 436  | D: -0.8266 | CE:  0.0344 | S_OoD:  0.8611 | S_z:  0.0013 | G: -0.0001 | S_z:  0.0014 | dist: 0.1180
Step: 536  | D: -0.7827 | CE:  0.0743 | S_OoD:  0.8572 | S_z:  0.0020 | G: -0.0002 | S_z:  0.0021 | dist: 0.1010
Step: 636  | D: -0.7174 | CE:  0.1353 | S_OoD:  0.8529 | S_z:  0.0024 | G: -0.0002 | S_z:  0.0020 | dist: 0.0910
Step: 736  | D: -0.7773 | CE:  0.0804 | S_OoD:  0.8578 | S_z:  0.0017 | G: -0.0002 | S_z:  0.0015 | dist: 0.1361
Step: 836  | D: -0.7764 | CE:  0.0838 | S_OoD:  0.8603 | S_z:  0.0015 | G: -0.0001 | S_z:  0.0014 | dist: 0.1897
Step: 936  | D: -0.7883 | CE:  0.0732 | S_OoD:  0.8616 | S_z:  0.0014 | G: -0.0001 | S_z:  0.0013 | dist: 0.2736
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9978494623655914
mean: 0.99785 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.11629709005355846
mean: 0.1163 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9898617511520738
mean: 0.98986 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.27611663818359383
mean: 0.27612 | std: 0.0 | MAD: 0.0
AUROC: 0.9995423334788031

Validation Accuracy: 0.9477595850581509
Validation Classification Loss: 0.18322501761650437
Step: 42   | D: -0.7613 | CE:  0.0970 | S_OoD:  0.8584 | S_z:  0.0016 | G: -0.0002 | S_z:  0.0017 | dist: 0.2616
Step: 142  | D: -0.6788 | CE:  0.1817 | S_OoD:  0.8607 | S_z:  0.0020 | G: -0.0002 | S_z:  0.0021 | dist: 0.2129
Step: 242  | D: -0.8288 | CE:  0.0333 | S_OoD:  0.8624 | S_z:  0.0026 | G: -0.0003 | S_z:  0.0027 | dist: 0.3423
Step: 342  | D: -0.8009 | CE:  0.0604 | S_OoD:  0.8615 | S_z:  0.0019 | G: -0.0002 | S_z:  0.0019 | dist: 0.0821
Step: 442  | D: -0.7715 | CE:  0.0845 | S_OoD:  0.8561 | S_z:  0.0014 | G: -0.0001 | S_z:  0.0014 | dist: 0.1067
Step: 542  | D: -0.7582 | CE:  0.1042 | S_OoD:  0.8627 | S_z:  0.0028 | G: -0.0003 | S_z:  0.0026 | dist: 0.0176
Step: 642  | D: -0.7110 | CE:  0.1534 | S_OoD:  0.8647 | S_z:  0.0027 | G: -0.0003 | S_z:  0.0033 | dist: 0.0387
Step: 742  | D: -0.8237 | CE:  0.0376 | S_OoD:  0.8614 | S_z:  0.0016 | G: -0.0002 | S_z:  0.0016 | dist: 0.2404
Step: 842  | D: -0.7215 | CE:  0.1378 | S_OoD:  0.8595 | S_z:  0.0016 | G: -0.0001 | S_z:  0.0015 | dist: 0.1659
Step: 942  | D: -0.7953 | CE:  0.0647 | S_OoD:  0.8602 | S_z:  0.0017 | G: -0.0002 | S_z:  0.0018 | dist: 0.0950
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.8328725038402458
mean: 0.83287 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.2118355453014374
mean: 0.21184 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.1846390168970814
mean: 0.18464 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.31378104448318483
mean: 0.31378 | std: 0.0 | MAD: 0.0
AUROC: 0.9695983639409874

Validation Accuracy: 0.9030467671988961
Validation Classification Loss: 0.32603402622044086
New checkpoint created at the end of epoch 7.
Step: 48   | D: -0.6759 | CE:  0.1845 | S_OoD:  0.8606 | S_z:  0.0015 | G: -0.0002 | S_z:  0.0016 | dist: 0.1759
Step: 148  | D: -0.8068 | CE:  0.0496 | S_OoD:  0.8565 | S_z:  0.0014 | G: -0.0001 | S_z:  0.0013 | dist: 0.0069
Step: 248  | D: -0.7586 | CE:  0.1072 | S_OoD:  0.8660 | S_z:  0.0014 | G: -0.0001 | S_z:  0.0013 | dist: 0.1160
Step: 348  | D: -0.7128 | CE:  0.1437 | S_OoD:  0.8567 | S_z:  0.0017 | G: -0.0002 | S_z:  0.0021 | dist: 0.1335
Step: 448  | D: -0.8358 | CE:  0.0274 | S_OoD:  0.8633 | S_z:  0.0018 | G: -0.0002 | S_z:  0.0016 | dist: 0.2354
Step: 548  | D: -0.6610 | CE:  0.2015 | S_OoD:  0.8628 | S_z:  0.0030 | G: -0.0002 | S_z:  0.0018 | dist: 0.0226
Step: 648  | D: -0.8564 | CE:  0.0090 | S_OoD:  0.8656 | S_z:  0.0014 | G: -0.0001 | S_z:  0.0014 | dist: 0.2246
Step: 748  | D: -0.7131 | CE:  0.1464 | S_OoD:  0.8597 | S_z:  0.0021 | G: -0.0002 | S_z:  0.0019 | dist: 0.2406
Step: 848  | D: -0.8028 | CE:  0.0583 | S_OoD:  0.8614 | S_z:  0.0024 | G: -0.0002 | S_z:  0.0025 | dist: 0.0527
Step: 948  | D: -0.7935 | CE:  0.0650 | S_OoD:  0.8588 | S_z:  0.0030 | G: -0.0002 | S_z:  0.0017 | dist: 0.1928
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.8811059907834101
mean: 0.88111 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.10461874455213564
mean: 0.10462 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.1898617511520737
mean: 0.18986 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.27050753593444893
mean: 0.27051 | std: 0.0 | MAD: 0.0
AUROC: 0.972591992070045

Validation Accuracy: 0.948159989158289
Validation Classification Loss: 0.1955788170845572
Step: 54   | D: -0.7167 | CE:  0.1479 | S_OoD:  0.8647 | S_z:  0.0014 | G: -0.0001 | S_z:  0.0013 | dist: 0.0337
Step: 154  | D: -0.5284 | CE:  0.3360 | S_OoD:  0.8646 | S_z:  0.0015 | G: -0.0002 | S_z:  0.0017 | dist: 0.0440
Step: 254  | D: -0.7314 | CE:  0.1324 | S_OoD:  0.8639 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0012 | dist: 0.1467
Step: 354  | D: -0.7782 | CE:  0.0825 | S_OoD:  0.8608 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0013 | dist: 0.2297
Step: 454  | D: -0.7616 | CE:  0.1026 | S_OoD:  0.8644 | S_z:  0.0012 | G: -0.0001 | S_z:  0.0013 | dist: 0.3115
Step: 554  | D: -0.5389 | CE:  0.3252 | S_OoD:  0.8643 | S_z:  0.0015 | G: -0.0002 | S_z:  0.0015 | dist: 0.1096
Step: 654  | D: -0.7949 | CE:  0.0705 | S_OoD:  0.8658 | S_z:  0.0037 | G: -0.0002 | S_z:  0.0024 | dist: 0.3529
Step: 754  | D: -0.7618 | CE:  0.0983 | S_OoD:  0.8602 | S_z:  0.0016 | G: -0.0001 | S_z:  0.0013 | dist: 0.0003
Step: 854  | D: -0.7869 | CE:  0.0761 | S_OoD:  0.8631 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0011 | dist: 0.0737
Step: 954  | D: -0.6723 | CE:  0.1910 | S_OoD:  0.8634 | S_z:  0.0017 | G: -0.0001 | S_z:  0.0013 | dist: 0.2675
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.2605222734254993
mean: 0.26052 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.293752920627594
mean: 0.29375 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.030414746543778848
mean: 0.03041 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.36222735881805446
mean: 0.36223 | std: 0.0 | MAD: 0.0
AUROC: 0.9248982200830911

Validation Accuracy: 0.849967043662527
Validation Classification Loss: 0.5096052269336213
Step: 60   | D: -0.7221 | CE:  0.1367 | S_OoD:  0.8596 | S_z:  0.0070 | G: -0.0005 | S_z:  0.0054 | dist: 0.0058
Step: 160  | D: -0.8278 | CE:  0.0347 | S_OoD:  0.8628 | S_z:  0.0027 | G: -0.0003 | S_z:  0.0026 | dist: 0.2782
Step: 260  | D: -0.8346 | CE:  0.0319 | S_OoD:  0.8666 | S_z:  0.0019 | G: -0.0002 | S_z:  0.0020 | dist: 0.0168
Step: 360  | D: -0.7776 | CE:  0.0878 | S_OoD:  0.8655 | S_z:  0.0016 | G: -0.0001 | S_z:  0.0015 | dist: 0.1599
Step: 460  | D: -0.6879 | CE:  0.1770 | S_OoD:  0.8650 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0010 | dist: 0.1651
Step: 560  | D: -0.8276 | CE:  0.0313 | S_OoD:  0.8590 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0010 | dist: 0.1459
Step: 660  | D: -0.7517 | CE:  0.1056 | S_OoD:  0.8575 | S_z:  0.0013 | G: -0.0001 | S_z:  0.0014 | dist: 0.0597
Step: 760  | D: -0.6613 | CE:  0.2006 | S_OoD:  0.8619 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.0557
Step: 860  | D: -0.7885 | CE:  0.0760 | S_OoD:  0.8647 | S_z:  0.0014 | G: -0.0002 | S_z:  0.0016 | dist: 0.1017
Step: 960  | D: -0.7916 | CE:  0.0737 | S_OoD:  0.8654 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.0011
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9944700460829493
mean: 0.99447 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.11261355727911003
mean: 0.11261 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.4015360983102919
mean: 0.40154 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.28192805051803627
mean: 0.28193 | std: 0.0 | MAD: 0.0
AUROC: 0.9857264385401853

Validation Accuracy: 0.9471397287108219
Validation Classification Loss: 0.19677987908211986
Step: 66   | D: -0.7339 | CE:  0.1336 | S_OoD:  0.8676 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0012 | dist: 0.2260
Step: 166  | D: -0.8192 | CE:  0.0487 | S_OoD:  0.8679 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0009 | dist: 0.2803
Step: 266  | D: -0.8233 | CE:  0.0384 | S_OoD:  0.8618 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.2251
Step: 366  | D: -0.8476 | CE:  0.0180 | S_OoD:  0.8657 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0011 | dist: 0.1421
Step: 466  | D: -0.7884 | CE:  0.0758 | S_OoD:  0.8644 | S_z:  0.0016 | G: -0.0001 | S_z:  0.0015 | dist: 0.0036
Step: 566  | D: -0.8222 | CE:  0.0390 | S_OoD:  0.8613 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0011 | dist: 0.1957
Step: 666  | D: -0.8486 | CE:  0.0170 | S_OoD:  0.8657 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0011 | dist: 0.1206
Step: 766  | D: -0.8165 | CE:  0.0476 | S_OoD:  0.8642 | S_z:  0.0012 | G: -0.0001 | S_z:  0.0013 | dist: 0.0642
Step: 866  | D: -0.8336 | CE:  0.0331 | S_OoD:  0.8667 | S_z:  0.0010 | G: -0.0001 | S_z:  0.0010 | dist: 0.1089
Step: 966  | D: -0.7687 | CE:  0.0978 | S_OoD:  0.8667 | S_z:  0.0016 | G: -0.0002 | S_z:  0.0019 | dist: 0.0879
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9738863287250384
mean: 0.97389 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.10795940309762961
mean: 0.10796 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.5311827956989248
mean: 0.53118 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.27093712925910957
mean: 0.27094 | std: 0.0 | MAD: 0.0
AUROC: 0.9872448538818265

Validation Accuracy: 0.9381968571358171
Validation Classification Loss: 0.22916106708619868
New checkpoint created at the end of epoch 11.
Step: 72   | D: -0.8359 | CE:  0.0317 | S_OoD:  0.8677 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0010 | dist: 0.1531
Step: 172  | D: -0.8525 | CE:  0.0117 | S_OoD:  0.8643 | S_z:  0.0015 | G: -0.0002 | S_z:  0.0016 | dist: 0.0815
Step: 272  | D: -0.8350 | CE:  0.0336 | S_OoD:  0.8687 | S_z:  0.0010 | G: -0.0001 | S_z:  0.0010 | dist: 0.0411
Step: 372  | D: -0.7633 | CE:  0.1021 | S_OoD:  0.8655 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0010 | dist: 0.0188
Step: 472  | D: -0.7861 | CE:  0.0783 | S_OoD:  0.8645 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0010 | dist: 0.0303
Step: 572  | D: -0.6685 | CE:  0.1976 | S_OoD:  0.8662 | S_z:  0.0012 | G: -0.0001 | S_z:  0.0011 | dist: 0.1957
Step: 672  | D: -0.7531 | CE:  0.1114 | S_OoD:  0.8646 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0010 | dist: 0.2107
Step: 772  | D: -0.8281 | CE:  0.0352 | S_OoD:  0.8635 | S_z:  0.0022 | G: -0.0002 | S_z:  0.0023 | dist: 0.0070
Step: 872  | D: -0.7130 | CE:  0.1542 | S_OoD:  0.8673 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.0422
Step: 972  | D: -0.7931 | CE:  0.0738 | S_OoD:  0.8670 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0010 | dist: 0.0032
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.997542242703533
mean: 0.99754 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.17519704699516309
mean: 0.1752 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.8580645161290322
mean: 0.85806 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.30158961534500134
mean: 0.30159 | std: 0.0 | MAD: 0.0
AUROC: 0.9953236843132847

Validation Accuracy: 0.922785919327814
Validation Classification Loss: 0.26811730158462954
Step: 78   | D: -0.8399 | CE:  0.0233 | S_OoD:  0.8634 | S_z:  0.0013 | G: -0.0001 | S_z:  0.0013 | dist: 0.2287
Step: 178  | D: -0.8087 | CE:  0.0599 | S_OoD:  0.8688 | S_z:  0.0017 | G: -0.0001 | S_z:  0.0011 | dist: 0.0973
Step: 278  | D: -0.7713 | CE:  0.0950 | S_OoD:  0.8664 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0009 | dist: 0.0446
Step: 378  | D: -0.8278 | CE:  0.0397 | S_OoD:  0.8676 | S_z:  0.0010 | G: -0.0001 | S_z:  0.0009 | dist: 0.1027
Step: 478  | D: -0.8154 | CE:  0.0484 | S_OoD:  0.8640 | S_z:  0.0017 | G: -0.0002 | S_z:  0.0017 | dist: 0.3643
Step: 578  | D: -0.7818 | CE:  0.0857 | S_OoD:  0.8676 | S_z:  0.0012 | G: -0.0001 | S_z:  0.0013 | dist: 0.0613
Step: 678  | D: -0.7499 | CE:  0.1164 | S_OoD:  0.8665 | S_z:  0.0015 | G: -0.0001 | S_z:  0.0015 | dist: 0.0320
Step: 778  | D: -0.8633 | CE:  0.0034 | S_OoD:  0.8668 | S_z:  0.0012 | G: -0.0001 | S_z:  0.0012 | dist: 0.1301
Step: 878  | D: -0.8303 | CE:  0.0330 | S_OoD:  0.8634 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.2266
Step: 978  | D: -0.8064 | CE:  0.0584 | S_OoD:  0.8650 | S_z:  0.0013 | G: -0.0001 | S_z:  0.0013 | dist: 0.1454
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9864823348694316
mean: 0.98648 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.044289444386959115
mean: 0.04429 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.954531490015361
mean: 0.95453 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.23800571143627186
mean: 0.23801 | std: 0.0 | MAD: 0.0
AUROC: 0.9976167917254497

Validation Accuracy: 0.9474084614626453
Validation Classification Loss: 0.22321143687383554
Step: 84   | D: -0.8307 | CE:  0.0341 | S_OoD:  0.8650 | S_z:  0.0021 | G: -0.0002 | S_z:  0.0021 | dist: 0.1167
Step: 184  | D: -0.8396 | CE:  0.0257 | S_OoD:  0.8654 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0009 | dist: 0.2084
Step: 284  | D: -0.8176 | CE:  0.0462 | S_OoD:  0.8638 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.0382
Step: 384  | D: -0.8476 | CE:  0.0131 | S_OoD:  0.8608 | S_z:  0.0014 | G: -0.0001 | S_z:  0.0015 | dist: 0.1050
Step: 484  | D: -0.8525 | CE:  0.0107 | S_OoD:  0.8633 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0012 | dist: 0.1217
Step: 584  | D: -0.7272 | CE:  0.1399 | S_OoD:  0.8672 | S_z:  0.0010 | G: -0.0001 | S_z:  0.0011 | dist: 0.1954
Step: 684  | D: -0.8389 | CE:  0.0282 | S_OoD:  0.8673 | S_z:  0.0023 | G: -0.0004 | S_z:  0.0040 | dist: 0.0021
Step: 784  | D: -0.6615 | CE:  0.2056 | S_OoD:  0.8672 | S_z:  0.0012 | G: -0.0001 | S_z:  0.0014 | dist: 0.0608
Step: 884  | D: -0.8261 | CE:  0.0387 | S_OoD:  0.8648 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.0076
Step: 984  | D: -0.7912 | CE:  0.0750 | S_OoD:  0.8663 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0006 | dist: 0.0910
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9984639016897081
mean: 0.99846 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.13877657055854817
mean: 0.13878 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.7806451612903226
mean: 0.78065 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.28252713680267383
mean: 0.28253 | std: 0.0 | MAD: 0.0
AUROC: 0.9938311122728907

Validation Accuracy: 0.9230877624186871
Validation Classification Loss: 0.2846827263253207
Step: 90   | D: -0.8467 | CE:  0.0167 | S_OoD:  0.8635 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.1843
Step: 190  | D: -0.8650 | CE:  0.0040 | S_OoD:  0.8691 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.1837
Step: 290  | D: -0.8608 | CE:  0.0063 | S_OoD:  0.8672 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0009 | dist: 0.0473
Step: 390  | D: -0.7922 | CE:  0.0731 | S_OoD:  0.8657 | S_z:  0.0041 | G: -0.0004 | S_z:  0.0041 | dist: 0.0154
Step: 490  | D: -0.8543 | CE:  0.0141 | S_OoD:  0.8686 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0010 | dist: 0.1699
Step: 590  | D: -0.8431 | CE:  0.0232 | S_OoD:  0.8664 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.1298
Step: 690  | D: -0.8494 | CE:  0.0135 | S_OoD:  0.8630 | S_z:  0.0005 | G: -0.0001 | S_z:  0.0005 | dist: 0.2541
Step: 790  | D: -0.7980 | CE:  0.0645 | S_OoD:  0.8626 | S_z:  0.0013 | G: -0.0001 | S_z:  0.0010 | dist: 0.0172
Step: 890  | D: -0.7565 | CE:  0.1110 | S_OoD:  0.8676 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0007 | dist: 0.0698
Step: 990  | D: -0.8633 | CE:  0.0030 | S_OoD:  0.8663 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.0508
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.770199692780338
mean: 0.7702 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.2919211864471436
mean: 0.29192 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.34439324116743475
mean: 0.34439 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.35421932578086857
mean: 0.35422 | std: 0.0 | MAD: 0.0
AUROC: 0.9678532936754658

Validation Accuracy: 0.6941343879361325
Validation Classification Loss: 1.1924985802910302
New checkpoint created at the end of epoch 15.
Step: 96   | D: -0.7618 | CE:  0.0993 | S_OoD:  0.8616 | S_z:  0.0045 | G: -0.0003 | S_z:  0.0025 | dist: 0.0302
Step: 196  | D: -0.8285 | CE:  0.0400 | S_OoD:  0.8685 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.0880
Step: 296  | D: -0.8225 | CE:  0.0431 | S_OoD:  0.8657 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.0177
Step: 396  | D: -0.7880 | CE:  0.0793 | S_OoD:  0.8674 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0007 | dist: 0.1084
Step: 496  | D: -0.8541 | CE:  0.0148 | S_OoD:  0.8690 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.1289
Step: 596  | D: -0.8544 | CE:  0.0133 | S_OoD:  0.8677 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.1145
Step: 696  | D: -0.8468 | CE:  0.0200 | S_OoD:  0.8669 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.1135
Step: 796  | D: -0.8350 | CE:  0.0311 | S_OoD:  0.8662 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.0891
Step: 896  | D: -0.8293 | CE:  0.0394 | S_OoD:  0.8687 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.0873
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9993855606758832
mean: 0.99939 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.038963343948125846
mean: 0.03896 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9984639016897081
mean: 0.99846 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.23572172760963506
mean: 0.23572 | std: 0.0 | MAD: 0.0
AUROC: 0.999897436084195

Validation Accuracy: 0.9593466637098363
Validation Classification Loss: 0.1658821962525273
Step: 2    | D: -0.8037 | CE:  0.0563 | S_OoD:  0.8601 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0008 | dist: 0.0467
Step: 102  | D: -0.8555 | CE:  0.0114 | S_OoD:  0.8669 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.1444
Step: 202  | D: -0.8629 | CE:  0.0042 | S_OoD:  0.8672 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0009 | dist: 0.1140
Step: 302  | D: -0.8313 | CE:  0.0361 | S_OoD:  0.8675 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.0137
Step: 402  | D: -0.8252 | CE:  0.0435 | S_OoD:  0.8688 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.1015
Step: 502  | D: -0.7595 | CE:  0.1077 | S_OoD:  0.8672 | S_z:  0.0005 | G: -0.0000 | S_z:  0.0004 | dist: 0.2709
Step: 602  | D: -0.8607 | CE:  0.0061 | S_OoD:  0.8669 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0005 | dist: 0.1899
Step: 702  | D: -0.8582 | CE:  0.0072 | S_OoD:  0.8655 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.0069
Step: 802  | D: -0.8557 | CE:  0.0131 | S_OoD:  0.8689 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.2358
Step: 902  | D: -0.7727 | CE:  0.0900 | S_OoD:  0.8627 | S_z:  0.0005 | G: -0.0001 | S_z:  0.0006 | dist: 0.2312
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9993855606758832
mean: 0.99939 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.04057535231113434
mean: 0.04058 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9969278033794163
mean: 0.99693 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.24165381371974984
mean: 0.24165 | std: 0.0 | MAD: 0.0
AUROC: 0.9996872636833435

Validation Accuracy: 0.9574100938793613
Validation Classification Loss: 0.17180431280952219
Step: 8    | D: -0.8418 | CE:  0.0165 | S_OoD:  0.8583 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.0694
Step: 108  | D: -0.8543 | CE:  0.0136 | S_OoD:  0.8680 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.1722
Step: 208  | D: -0.8138 | CE:  0.0491 | S_OoD:  0.8629 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.0083
Step: 308  | D: -0.7725 | CE:  0.0925 | S_OoD:  0.8650 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0008 | dist: 0.0628
Step: 408  | D: -0.7860 | CE:  0.0811 | S_OoD:  0.8672 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.0967
Step: 508  | D: -0.8403 | CE:  0.0248 | S_OoD:  0.8652 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.1107
Step: 608  | D: -0.7924 | CE:  0.0769 | S_OoD:  0.8694 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.2057
Step: 708  | D: -0.7494 | CE:  0.1186 | S_OoD:  0.8681 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0009 | dist: 0.0369
Step: 808  | D: -0.8450 | CE:  0.0230 | S_OoD:  0.8680 | S_z:  0.0005 | G: -0.0001 | S_z:  0.0005 | dist: 0.0313
Step: 908  | D: -0.8366 | CE:  0.0297 | S_OoD:  0.8664 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0006 | dist: 0.1324
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9763440860215054
mean: 0.97634 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.04575192928314211
mean: 0.04575 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.8258064516129032
mean: 0.82581 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.24002983689308222
mean: 0.24003 | std: 0.0 | MAD: 0.0
AUROC: 0.9939975358493189

Validation Accuracy: 0.9489230669722057
Validation Classification Loss: 0.20844441078854412
Step: 14   | D: -0.8463 | CE:  0.0147 | S_OoD:  0.8611 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0007 | dist: 0.0729
Step: 114  | D: -0.8625 | CE:  0.0054 | S_OoD:  0.8680 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.1269
Step: 214  | D: -0.8635 | CE:  0.0050 | S_OoD:  0.8687 | S_z:  0.0011 | G: -0.0001 | S_z:  0.0010 | dist: 0.1476
Step: 314  | D: -0.8588 | CE:  0.0107 | S_OoD:  0.8696 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.0963
Step: 414  | D: -0.8292 | CE:  0.0385 | S_OoD:  0.8677 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0005 | dist: 0.1661
Step: 514  | D: -0.8010 | CE:  0.0664 | S_OoD:  0.8676 | S_z:  0.0015 | G: -0.0002 | S_z:  0.0021 | dist: 0.0304
Step: 614  | D: -0.8367 | CE:  0.0304 | S_OoD:  0.8672 | S_z:  0.0005 | G: -0.0001 | S_z:  0.0006 | dist: 0.0123
Step: 714  | D: -0.7239 | CE:  0.1433 | S_OoD:  0.8673 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0009 | dist: 0.1502
Step: 814  | D: -0.8312 | CE:  0.0380 | S_OoD:  0.8692 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.2239
Step: 914  | D: -0.8350 | CE:  0.0304 | S_OoD:  0.8655 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0008 | dist: 0.0058
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9996927803379416
mean: 0.99969 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.09406125098466879
mean: 0.09406 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.8746543778801843
mean: 0.87465 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.26496664762496985
mean: 0.26497 | std: 0.0 | MAD: 0.0
AUROC: 0.9963170058566235

Validation Accuracy: 0.9438533350581509
Validation Classification Loss: 0.2217450960908148
New checkpoint created at the end of epoch 19.
Step: 20   | D: -0.8327 | CE:  0.0339 | S_OoD:  0.8666 | S_z:  0.0005 | G: -0.0000 | S_z:  0.0005 | dist: 0.0613
Step: 120  | D: -0.8099 | CE:  0.0593 | S_OoD:  0.8693 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0006 | dist: 0.0097
Step: 220  | D: -0.8604 | CE:  0.0092 | S_OoD:  0.8696 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.2115
Step: 320  | D: -0.8597 | CE:  0.0066 | S_OoD:  0.8664 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0009 | dist: 0.1562
Step: 420  | D: -0.7695 | CE:  0.0982 | S_OoD:  0.8678 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0007 | dist: 0.0135
Step: 520  | D: -0.8544 | CE:  0.0135 | S_OoD:  0.8680 | S_z:  0.0006 | G: -0.0001 | S_z:  0.0006 | dist: 0.0036
Step: 620  | D: -0.8318 | CE:  0.0342 | S_OoD:  0.8661 | S_z:  0.0005 | G: -0.0000 | S_z:  0.0005 | dist: 0.2366
Step: 720  | D: -0.8510 | CE:  0.0162 | S_OoD:  0.8672 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.0802
Step: 820  | D: -0.8382 | CE:  0.0296 | S_OoD:  0.8679 | S_z:  0.0009 | G: -0.0001 | S_z:  0.0008 | dist: 0.0763
Step: 920  | D: -0.8161 | CE:  0.0519 | S_OoD:  0.8681 | S_z:  0.0008 | G: -0.0001 | S_z:  0.0007 | dist: 0.1003
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9932411674347158
mean: 0.99324 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.05267489627003671
mean: 0.05267 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.7631336405529954
mean: 0.76313 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.24971028685569766
mean: 0.24971 | std: 0.0 | MAD: 0.0
AUROC: 0.9935359105552014

Validation Accuracy: 0.9485111127537946
Validation Classification Loss: 0.21549168686785347
Step: 26   | D: -0.8503 | CE:  0.0164 | S_OoD:  0.8668 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.2201
Step: 126  | D: -0.8501 | CE:  0.0183 | S_OoD:  0.8684 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.2297
Step: 226  | D: -0.8482 | CE:  0.0189 | S_OoD:  0.8671 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0006 | dist: 0.1425
Step: 326  | D: -0.8503 | CE:  0.0186 | S_OoD:  0.8690 | S_z:  0.0005 | G: -0.0000 | S_z:  0.0005 | dist: 0.2859
Step: 426  | D: -0.8366 | CE:  0.0307 | S_OoD:  0.8673 | S_z:  0.0005 | G: -0.0000 | S_z:  0.0005 | dist: 0.0957
Step: 526  | D: -0.8137 | CE:  0.0549 | S_OoD:  0.8686 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.2262
Step: 626  | D: -0.8392 | CE:  0.0293 | S_OoD:  0.8686 | S_z:  0.0005 | G: -0.0001 | S_z:  0.0005 | dist: 0.0622
Step: 726  | D: -0.8270 | CE:  0.0403 | S_OoD:  0.8674 | S_z:  0.0016 | G: -0.0002 | S_z:  0.0017 | dist: 0.1203
Step: 826  | D: -0.8147 | CE:  0.0538 | S_OoD:  0.8689 | S_z:  0.0044 | G: -0.0003 | S_z:  0.0027 | dist: 0.1632
Step: 926  | D: -0.8308 | CE:  0.0370 | S_OoD:  0.8679 | S_z:  0.0012 | G: -0.0001 | S_z:  0.0011 | dist: 0.1092
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.0694254174828531
mean: 0.06943 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9969278033794163
mean: 0.99693 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.25767333149910004
mean: 0.25767 | std: 0.0 | MAD: 0.0
AUROC: 0.9998504028945038

Validation Accuracy: 0.950968977922334
Validation Classification Loss: 0.20076808970149482
Step: 32   | D: -0.8663 | CE:  0.0036 | S_OoD:  0.8699 | S_z:  0.0005 | G: -0.0001 | S_z:  0.0005 | dist: 0.0476
Step: 132  | D: -0.8672 | CE:  0.0022 | S_OoD:  0.8695 | S_z:  0.0005 | G: -0.0000 | S_z:  0.0004 | dist: 0.0692
Step: 232  | D: -0.8610 | CE:  0.0085 | S_OoD:  0.8695 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.1697
Step: 332  | D: -0.8596 | CE:  0.0032 | S_OoD:  0.8628 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.0593
Step: 432  | D: -0.8562 | CE:  0.0118 | S_OoD:  0.8681 | S_z:  0.0007 | G: -0.0001 | S_z:  0.0007 | dist: 0.0222
Step: 532  | D: -0.7667 | CE:  0.1020 | S_OoD:  0.8687 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.0271
Step: 632  | D: -0.7849 | CE:  0.0814 | S_OoD:  0.8663 | S_z:  0.0005 | G: -0.0000 | S_z:  0.0005 | dist: 0.2679
Step: 732  | D: -0.7846 | CE:  0.0840 | S_OoD:  0.8686 | S_z:  0.0004 | G: -0.0000 | S_z:  0.0004 | dist: 0.0143
Step: 832  | D: -0.8545 | CE:  0.0137 | S_OoD:  0.8683 | S_z:  0.0003 | G: -0.0000 | S_z:  0.0003 | dist: 0.1182
Step: 932  | D: -0.7896 | CE:  0.0800 | S_OoD:  0.8696 | S_z:  0.0005 | G: -0.0001 | S_z:  0.0005 | dist: 0.0214
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
