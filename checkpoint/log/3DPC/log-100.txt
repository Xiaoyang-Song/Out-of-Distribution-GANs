
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: 3DPC
Experiment regime: Imbalanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 100
Input Dimension: 300 x 3 x 1
Number of InD classes: 5
Number of Epochs: 100.
Hyperparameters: lambda_ce=1 & lambda_w=0.1 & scaling=0.01 & d_lr=0.001 & g_lr=0.001 & B_InD: 100 & B_OoD: 10 & n_d: 1 & n_g: 1
Score Function: Dynamic_Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
tensor([5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,
        5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,
        5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,
        5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,
        5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,
        5., 5., 5., 5., 5., 5., 5., 5., 5., 5.])
Counter({5.0: 100})
Monte Carlo Iteration 0
3DPC
3DPC
OoD sample shape: torch.Size([100, 1, 300, 3])
Step: 0    | D:  1.5831 | CE:  1.6146 | S_OoD:  0.3178 | S_z:  0.3191 | G: -0.0003 | S_z:  0.3191 | dist: 0.1345
Step: 25   | D:  1.2790 | CE:  1.3072 | S_OoD:  0.2849 | S_z:  0.3145 | G: -0.0003 | S_z:  0.3165 | dist: 0.0093
Step: 50   | D:  0.9475 | CE:  0.9731 | S_OoD:  0.2586 | S_z:  0.3049 | G: -0.0003 | S_z:  0.3008 | dist: 0.2384
Step: 75   | D:  0.7816 | CE:  0.8050 | S_OoD:  0.2373 | S_z:  0.2786 | G: -0.0003 | S_z:  0.2582 | dist: 0.0570
Step: 100  | D:  0.7400 | CE:  0.7611 | S_OoD:  0.2138 | S_z:  0.2725 | G: -0.0003 | S_z:  0.2670 | dist: 0.2542
Step: 125  | D:  0.7298 | CE:  0.7534 | S_OoD:  0.2380 | S_z:  0.2470 | G: -0.0002 | S_z:  0.2466 | dist: 0.1601
Step: 150  | D:  0.7951 | CE:  0.8171 | S_OoD:  0.2225 | S_z:  0.2379 | G: -0.0002 | S_z:  0.2488 | dist: 0.0467
Step: 175  | D:  0.8258 | CE:  0.8465 | S_OoD:  0.2086 | S_z:  0.2022 | G: -0.0002 | S_z:  0.1980 | dist: 0.1053
Step: 200  | D:  0.8811 | CE:  0.8952 | S_OoD:  0.1433 | S_z:  0.2342 | G: -0.0002 | S_z:  0.2311 | dist: 0.0219
Step: 225  | D:  0.7166 | CE:  0.7376 | S_OoD:  0.2105 | S_z:  0.0058 | G: -0.0000 | S_z:  0.0019 | dist: 0.1815
Step: 250  | D:  0.6290 | CE:  0.6511 | S_OoD:  0.2206 | S_z:  0.0010 | G: -0.0000 | S_z:  0.0017 | dist: 0.1323
Step: 275  | D:  0.6705 | CE:  0.6911 | S_OoD:  0.2063 | S_z:  0.0208 | G: -0.0000 | S_z:  0.0242 | dist: 0.0959
Step: 300  | D:  0.7278 | CE:  0.7435 | S_OoD:  0.1567 | S_z:  0.0168 | G: -0.0000 | S_z:  0.0145 | dist: 0.2259
Step: 325  | D:  0.6817 | CE:  0.7014 | S_OoD:  0.1977 | S_z:  0.0002 | G: -0.0000 | S_z:  0.0002 | dist: 0.0926
Step: 350  | D:  0.5896 | CE:  0.6051 | S_OoD:  0.1559 | S_z:  0.0032 | G: -0.0000 | S_z:  0.0011 | dist: 0.1716
Step: 375  | D:  0.6750 | CE:  0.6905 | S_OoD:  0.1547 | S_z:  0.0006 | G: -0.0000 | S_z:  0.0257 | dist: 0.1415
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
