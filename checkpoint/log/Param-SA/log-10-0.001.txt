
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 64
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=10 & scaling=0.0001 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
Verifying OOD set labels: tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Verifying OOD class distribution: Counter({8: 64, 9: 64})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([128, 1, 28, 28])
Step: 0    | D: -5.9520 | CE:  2.1043 | S_OoD:  0.8057 | S_z:  0.8016 | G: -0.0008 | S_z:  0.8424 | dist: 0.0906
Step: 20   | D: -6.8821 | CE:  1.6844 | S_OoD:  0.8567 | S_z:  0.8612 | G: -0.0009 | S_z:  0.8616 | dist: 0.0843
Step: 40   | D: -7.2334 | CE:  1.2791 | S_OoD:  0.8513 | S_z:  0.8548 | G: -0.0009 | S_z:  0.8546 | dist: 0.0994
Step: 60   | D: -7.1838 | CE:  1.3396 | S_OoD:  0.8524 | S_z:  0.8506 | G: -0.0008 | S_z:  0.8438 | dist: 0.1018
Step: 80   | D: -7.5995 | CE:  0.9596 | S_OoD:  0.8560 | S_z:  0.8277 | G: -0.0008 | S_z:  0.8247 | dist: 0.0592
Step: 100  | D: -7.5137 | CE:  1.0131 | S_OoD:  0.8528 | S_z:  0.8284 | G: -0.0008 | S_z:  0.8301 | dist: 0.0763
Step: 120  | D: -7.6395 | CE:  0.9474 | S_OoD:  0.8588 | S_z:  0.8322 | G: -0.0008 | S_z:  0.8301 | dist: 0.0771
Step: 140  | D: -7.7935 | CE:  0.7690 | S_OoD:  0.8563 | S_z:  0.8226 | G: -0.0008 | S_z:  0.8235 | dist: 0.0891
Step: 160  | D: -7.8191 | CE:  0.7461 | S_OoD:  0.8566 | S_z:  0.8133 | G: -0.0008 | S_z:  0.8188 | dist: 0.0852
Step: 180  | D: -7.9167 | CE:  0.6107 | S_OoD:  0.8528 | S_z:  0.8044 | G: -0.0008 | S_z:  0.8045 | dist: 0.0997
Step: 200  | D: -7.9315 | CE:  0.5965 | S_OoD:  0.8529 | S_z:  0.8136 | G: -0.0008 | S_z:  0.8115 | dist: 0.1130
Step: 220  | D: -8.0504 | CE:  0.4976 | S_OoD:  0.8549 | S_z:  0.7900 | G: -0.0008 | S_z:  0.7932 | dist: 0.1073
Step: 240  | D: -7.3875 | CE:  1.0732 | S_OoD:  0.8462 | S_z:  0.8306 | G: -0.0008 | S_z:  0.8328 | dist: 0.0949
Step: 260  | D: -7.9302 | CE:  0.6852 | S_OoD:  0.8616 | S_z:  0.8238 | G: -0.0008 | S_z:  0.8238 | dist: 0.0827
Step: 280  | D: -7.7814 | CE:  0.8254 | S_OoD:  0.8608 | S_z:  0.8046 | G: -0.0008 | S_z:  0.8041 | dist: 0.0736
Step: 300  | D: -7.9517 | CE:  0.6143 | S_OoD:  0.8567 | S_z:  0.7962 | G: -0.0008 | S_z:  0.7981 | dist: 0.0953
Step: 320  | D: -7.9891 | CE:  0.6109 | S_OoD:  0.8601 | S_z:  0.8121 | G: -0.0008 | S_z:  0.8063 | dist: 0.0870
Step: 340  | D: -7.9985 | CE:  0.6556 | S_OoD:  0.8655 | S_z:  0.8006 | G: -0.0008 | S_z:  0.8024 | dist: 0.0945
Step: 360  | D: -8.1350 | CE:  0.5094 | S_OoD:  0.8645 | S_z:  0.8115 | G: -0.0008 | S_z:  0.8138 | dist: 0.0723
Step: 380  | D: -7.9582 | CE:  0.7070 | S_OoD:  0.8666 | S_z:  0.8202 | G: -0.0008 | S_z:  0.8127 | dist: 0.1227
Step: 400  | D: -7.9792 | CE:  0.6608 | S_OoD:  0.8641 | S_z:  0.8087 | G: -0.0008 | S_z:  0.7938 | dist: 0.0969
Step: 420  | D: -8.1642 | CE:  0.4944 | S_OoD:  0.8659 | S_z:  0.7866 | G: -0.0008 | S_z:  0.7929 | dist: 0.0895
Step: 440  | D: -8.0187 | CE:  0.5895 | S_OoD:  0.8609 | S_z:  0.8076 | G: -0.0008 | S_z:  0.8120 | dist: 0.0694
Step: 460  | D: -8.1570 | CE:  0.4984 | S_OoD:  0.8656 | S_z:  0.8208 | G: -0.0008 | S_z:  0.8106 | dist: 0.0863
Step: 480  | D: -8.2228 | CE:  0.4035 | S_OoD:  0.8627 | S_z:  0.7893 | G: -0.0008 | S_z:  0.7887 | dist: 0.0969
Step: 500  | D: -8.1719 | CE:  0.4937 | S_OoD:  0.8666 | S_z:  0.7926 | G: -0.0008 | S_z:  0.7968 | dist: 0.0722
Step: 520  | D: -8.2090 | CE:  0.4640 | S_OoD:  0.8674 | S_z:  0.7935 | G: -0.0008 | S_z:  0.8032 | dist: 0.0931
Step: 540  | D: -8.2181 | CE:  0.4539 | S_OoD:  0.8673 | S_z:  0.8143 | G: -0.0008 | S_z:  0.8151 | dist: 0.0850
Step: 560  | D: -8.2119 | CE:  0.4600 | S_OoD:  0.8673 | S_z:  0.7907 | G: -0.0008 | S_z:  0.7967 | dist: 0.0886
Step: 580  | D: -8.2619 | CE:  0.3861 | S_OoD:  0.8649 | S_z:  0.7852 | G: -0.0008 | S_z:  0.7828 | dist: 0.0975
Step: 600  | D: -8.2614 | CE:  0.4117 | S_OoD:  0.8674 | S_z:  0.7583 | G: -0.0008 | S_z:  0.7568 | dist: 0.0673
Step: 620  | D: -8.1926 | CE:  0.4656 | S_OoD:  0.8659 | S_z:  0.7830 | G: -0.0008 | S_z:  0.7847 | dist: 0.0936
Step: 640  | D: -8.1697 | CE:  0.5014 | S_OoD:  0.8672 | S_z:  0.7608 | G: -0.0008 | S_z:  0.7754 | dist: 0.1096
Step: 660  | D: -8.3160 | CE:  0.3190 | S_OoD:  0.8636 | S_z:  0.8040 | G: -0.0008 | S_z:  0.8141 | dist: 0.0686
Step: 680  | D: -8.1756 | CE:  0.4428 | S_OoD:  0.8619 | S_z:  0.7746 | G: -0.0008 | S_z:  0.8010 | dist: 0.0823
Step: 700  | D: -7.9873 | CE:  0.6713 | S_OoD:  0.8659 | S_z:  0.8336 | G: -0.0008 | S_z:  0.8326 | dist: 0.0772
Step: 720  | D: -8.3150 | CE:  0.3197 | S_OoD:  0.8635 | S_z:  0.8248 | G: -0.0008 | S_z:  0.8204 | dist: 0.0827
Step: 740  | D: -8.1919 | CE:  0.4667 | S_OoD:  0.8659 | S_z:  0.8393 | G: -0.0008 | S_z:  0.8395 | dist: 0.0949
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.5394191414117809
mean: 0.53942 | std: 0.0 | MAD: 0.0
TPR@99TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.6539980953931809
mean: 0.654 | std: 0.0 | MAD: 0.0
AUROC: 0.9999999999999999

Validation Accuracy: 0.85675
Validation Classification Loss: 0.40051314198970794
