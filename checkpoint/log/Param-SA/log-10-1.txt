
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 64
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=10 & scaling=0.1 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
Verifying OOD set labels: tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Verifying OOD class distribution: Counter({8: 64, 9: 64})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([128, 1, 28, 28])
Step: 0    | D: -5.1512 | CE:  2.1043 | S_OoD:  0.8057 | S_z:  0.8016 | G: -0.8421 | S_z:  0.8421 | dist: 0.0906
Step: 20   | D: -6.0628 | CE:  1.6401 | S_OoD:  0.8564 | S_z:  0.8607 | G: -0.8589 | S_z:  0.8589 | dist: 0.0843
Step: 40   | D: -6.3475 | CE:  1.2823 | S_OoD:  0.8476 | S_z:  0.8464 | G: -0.8442 | S_z:  0.8442 | dist: 0.0994
Step: 60   | D: -6.5654 | CE:  1.0938 | S_OoD:  0.8487 | S_z:  0.8275 | G: -0.8224 | S_z:  0.8224 | dist: 0.1018
Step: 80   | D: -6.7885 | CE:  0.9349 | S_OoD:  0.8485 | S_z:  0.7617 | G: -0.7518 | S_z:  0.7518 | dist: 0.0592
Step: 100  | D: -6.5426 | CE:  1.2360 | S_OoD:  0.8465 | S_z:  0.6862 | G: -0.6472 | S_z:  0.6472 | dist: 0.0763
Step: 120  | D: -6.9480 | CE:  0.9964 | S_OoD:  0.8540 | S_z:  0.5960 | G: -0.5516 | S_z:  0.5516 | dist: 0.0771
Step: 140  | D: -7.3688 | CE:  0.7499 | S_OoD:  0.8611 | S_z:  0.4925 | G: -0.4284 | S_z:  0.4284 | dist: 0.0891
Step: 160  | D: -7.2296 | CE:  0.9069 | S_OoD:  0.8499 | S_z:  0.3625 | G: -0.2636 | S_z:  0.2636 | dist: 0.0852
Step: 180  | D: -7.6158 | CE:  0.5713 | S_OoD:  0.8541 | S_z:  0.3540 | G: -0.2457 | S_z:  0.2457 | dist: 0.0997
Step: 200  | D: -7.7344 | CE:  0.6136 | S_OoD:  0.8624 | S_z:  0.2759 | G: -0.1604 | S_z:  0.1604 | dist: 0.1130
Step: 220  | D: -6.9724 | CE:  1.3237 | S_OoD:  0.8523 | S_z:  0.2266 | G: -0.1527 | S_z:  0.1527 | dist: 0.1073
Step: 240  | D: -7.5742 | CE:  0.7729 | S_OoD:  0.8567 | S_z:  0.2203 | G: -0.1255 | S_z:  0.1255 | dist: 0.0949
Step: 260  | D: -7.7016 | CE:  0.6459 | S_OoD:  0.8585 | S_z:  0.2379 | G: -0.1364 | S_z:  0.1364 | dist: 0.0827
Step: 280  | D: -7.7513 | CE:  0.7820 | S_OoD:  0.8635 | S_z:  0.1015 | G: -0.0611 | S_z:  0.0611 | dist: 0.0736
Step: 300  | D: -7.8095 | CE:  0.6338 | S_OoD:  0.8580 | S_z:  0.1371 | G: -0.0664 | S_z:  0.0664 | dist: 0.0953
Step: 320  | D: -7.8890 | CE:  0.6213 | S_OoD:  0.8597 | S_z:  0.0869 | G: -0.0617 | S_z:  0.0617 | dist: 0.0870
Step: 340  | D: -7.8637 | CE:  0.6421 | S_OoD:  0.8610 | S_z:  0.1044 | G: -0.0967 | S_z:  0.0967 | dist: 0.0945
Step: 360  | D: -7.9928 | CE:  0.5346 | S_OoD:  0.8607 | S_z:  0.0794 | G: -0.0373 | S_z:  0.0373 | dist: 0.0723
Step: 380  | D: -7.7539 | CE:  0.7817 | S_OoD:  0.8653 | S_z:  0.1169 | G: -0.0568 | S_z:  0.0568 | dist: 0.1227
Step: 400  | D: -7.9145 | CE:  0.5922 | S_OoD:  0.8574 | S_z:  0.0671 | G: -0.0568 | S_z:  0.0568 | dist: 0.0969
Step: 420  | D: -8.0550 | CE:  0.5090 | S_OoD:  0.8644 | S_z:  0.0797 | G: -0.0373 | S_z:  0.0373 | dist: 0.0895
Step: 440  | D: -7.9417 | CE:  0.5894 | S_OoD:  0.8609 | S_z:  0.0780 | G: -0.0400 | S_z:  0.0400 | dist: 0.0694
Step: 460  | D: -7.9234 | CE:  0.5416 | S_OoD:  0.8577 | S_z:  0.1122 | G: -0.0544 | S_z:  0.0544 | dist: 0.0863
Step: 480  | D: -8.0806 | CE:  0.4721 | S_OoD:  0.8624 | S_z:  0.0710 | G: -0.0477 | S_z:  0.0477 | dist: 0.0969
Step: 500  | D: -7.9361 | CE:  0.5268 | S_OoD:  0.8557 | S_z:  0.0940 | G: -0.0688 | S_z:  0.0688 | dist: 0.0722
Step: 520  | D: -8.0274 | CE:  0.4885 | S_OoD:  0.8586 | S_z:  0.0702 | G: -0.0141 | S_z:  0.0141 | dist: 0.0931
Step: 540  | D: -8.1449 | CE:  0.4257 | S_OoD:  0.8617 | S_z:  0.0464 | G: -0.0297 | S_z:  0.0297 | dist: 0.0850
Step: 560  | D: -8.0664 | CE:  0.4771 | S_OoD:  0.8583 | S_z:  0.0390 | G: -0.0195 | S_z:  0.0195 | dist: 0.0886
Step: 580  | D: -8.0658 | CE:  0.4863 | S_OoD:  0.8580 | S_z:  0.0283 | G: -0.0253 | S_z:  0.0253 | dist: 0.0975
Step: 600  | D: -8.0831 | CE:  0.4455 | S_OoD:  0.8553 | S_z:  0.0247 | G: -0.0195 | S_z:  0.0195 | dist: 0.0673
Step: 620  | D: -8.1193 | CE:  0.4448 | S_OoD:  0.8592 | S_z:  0.0281 | G: -0.0184 | S_z:  0.0184 | dist: 0.0936
Step: 640  | D: -7.8976 | CE:  0.6628 | S_OoD:  0.8598 | S_z:  0.0376 | G: -0.0229 | S_z:  0.0229 | dist: 0.1096
Step: 660  | D: -8.2588 | CE:  0.3543 | S_OoD:  0.8652 | S_z:  0.0386 | G: -0.0149 | S_z:  0.0149 | dist: 0.0686
Step: 680  | D: -8.0983 | CE:  0.4725 | S_OoD:  0.8606 | S_z:  0.0353 | G: -0.0133 | S_z:  0.0133 | dist: 0.0823
Step: 700  | D: -7.6371 | CE:  0.8056 | S_OoD:  0.8487 | S_z:  0.0440 | G: -0.0402 | S_z:  0.0402 | dist: 0.0772
Step: 720  | D: -8.2492 | CE:  0.3714 | S_OoD:  0.8646 | S_z:  0.0253 | G: -0.0232 | S_z:  0.0232 | dist: 0.0827
Step: 740  | D: -7.9774 | CE:  0.6160 | S_OoD:  0.8615 | S_z:  0.0211 | G: -0.0263 | S_z:  0.0263 | dist: 0.0949
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.5617297530174254
mean: 0.56173 | std: 0.0 | MAD: 0.0
TPR@99TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.6665572202205658
mean: 0.66656 | std: 0.0 | MAD: 0.0
AUROC: 1.0

Validation Accuracy: 0.833125
Validation Classification Loss: 0.4708691625595093
