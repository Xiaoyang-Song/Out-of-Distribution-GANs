
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 64
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=10 & scaling=0.01 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
Verifying OOD set labels: tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Verifying OOD class distribution: Counter({8: 64, 9: 64})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([128, 1, 28, 28])
Step: 0    | D: -5.8727 | CE:  2.1043 | S_OoD:  0.8057 | S_z:  0.8016 | G: -0.0842 | S_z:  0.8424 | dist: 0.0906
Step: 20   | D: -6.8110 | CE:  1.6452 | S_OoD:  0.8542 | S_z:  0.8580 | G: -0.0859 | S_z:  0.8593 | dist: 0.0843
Step: 40   | D: -7.0641 | CE:  1.3064 | S_OoD:  0.8456 | S_z:  0.8545 | G: -0.0852 | S_z:  0.8516 | dist: 0.0994
Step: 60   | D: -7.3980 | CE:  1.0804 | S_OoD:  0.8563 | S_z:  0.8460 | G: -0.0845 | S_z:  0.8451 | dist: 0.1018
Step: 80   | D: -7.5007 | CE:  0.9486 | S_OoD:  0.8533 | S_z:  0.8355 | G: -0.0835 | S_z:  0.8345 | dist: 0.0592
Step: 100  | D: -7.4524 | CE:  1.0453 | S_OoD:  0.8580 | S_z:  0.8215 | G: -0.0823 | S_z:  0.8228 | dist: 0.0763
Step: 120  | D: -7.5247 | CE:  0.9697 | S_OoD:  0.8576 | S_z:  0.8121 | G: -0.0810 | S_z:  0.8100 | dist: 0.0771
Step: 140  | D: -7.7218 | CE:  0.7841 | S_OoD:  0.8585 | S_z:  0.7957 | G: -0.0792 | S_z:  0.7922 | dist: 0.0891
Step: 160  | D: -7.8319 | CE:  0.7223 | S_OoD:  0.8633 | S_z:  0.7841 | G: -0.0772 | S_z:  0.7724 | dist: 0.0852
Step: 180  | D: -7.7988 | CE:  0.6265 | S_OoD:  0.8503 | S_z:  0.7810 | G: -0.0768 | S_z:  0.7677 | dist: 0.0997
Step: 200  | D: -7.9316 | CE:  0.5751 | S_OoD:  0.8583 | S_z:  0.7631 | G: -0.0756 | S_z:  0.7561 | dist: 0.1130
Step: 220  | D: -8.0569 | CE:  0.4834 | S_OoD:  0.8615 | S_z:  0.7509 | G: -0.0742 | S_z:  0.7421 | dist: 0.1073
Step: 240  | D: -7.5959 | CE:  0.8614 | S_OoD:  0.8537 | S_z:  0.7992 | G: -0.0796 | S_z:  0.7964 | dist: 0.0949
Step: 260  | D: -7.9039 | CE:  0.6639 | S_OoD:  0.8644 | S_z:  0.7636 | G: -0.0756 | S_z:  0.7555 | dist: 0.0827
Step: 280  | D: -7.7544 | CE:  0.8132 | S_OoD:  0.8642 | S_z:  0.7430 | G: -0.0731 | S_z:  0.7313 | dist: 0.0736
Step: 300  | D: -7.9259 | CE:  0.6460 | S_OoD:  0.8642 | S_z:  0.6981 | G: -0.0691 | S_z:  0.6908 | dist: 0.0953
Step: 320  | D: -7.8156 | CE:  0.6224 | S_OoD:  0.8506 | S_z:  0.6772 | G: -0.0660 | S_z:  0.6604 | dist: 0.0870
Step: 340  | D: -7.9104 | CE:  0.6009 | S_OoD:  0.8576 | S_z:  0.6475 | G: -0.0633 | S_z:  0.6334 | dist: 0.0945
Step: 360  | D: -7.9518 | CE:  0.5587 | S_OoD:  0.8582 | S_z:  0.7132 | G: -0.0703 | S_z:  0.7025 | dist: 0.0723
Step: 380  | D: -7.7966 | CE:  0.7308 | S_OoD:  0.8593 | S_z:  0.6603 | G: -0.0633 | S_z:  0.6326 | dist: 0.1227
Step: 400  | D: -7.8998 | CE:  0.6308 | S_OoD:  0.8593 | S_z:  0.6199 | G: -0.0613 | S_z:  0.6125 | dist: 0.0969
Step: 420  | D: -8.0884 | CE:  0.4691 | S_OoD:  0.8619 | S_z:  0.6153 | G: -0.0594 | S_z:  0.5941 | dist: 0.0895
Step: 440  | D: -7.9706 | CE:  0.5551 | S_OoD:  0.8584 | S_z:  0.5793 | G: -0.0558 | S_z:  0.5581 | dist: 0.0694
Step: 460  | D: -8.1011 | CE:  0.5010 | S_OoD:  0.8659 | S_z:  0.5697 | G: -0.0546 | S_z:  0.5464 | dist: 0.0863
Step: 480  | D: -8.1298 | CE:  0.3994 | S_OoD:  0.8585 | S_z:  0.5633 | G: -0.0537 | S_z:  0.5368 | dist: 0.0969
Step: 500  | D: -8.0624 | CE:  0.4813 | S_OoD:  0.8597 | S_z:  0.5328 | G: -0.0500 | S_z:  0.4999 | dist: 0.0722
Step: 520  | D: -8.0903 | CE:  0.4639 | S_OoD:  0.8605 | S_z:  0.5094 | G: -0.0475 | S_z:  0.4750 | dist: 0.0931
Step: 540  | D: -8.1535 | CE:  0.4118 | S_OoD:  0.8615 | S_z:  0.4996 | G: -0.0462 | S_z:  0.4622 | dist: 0.0850
Step: 560  | D: -7.8752 | CE:  0.6175 | S_OoD:  0.8562 | S_z:  0.6873 | G: -0.0672 | S_z:  0.6718 | dist: 0.0886
Step: 580  | D: -8.1283 | CE:  0.4443 | S_OoD:  0.8622 | S_z:  0.4983 | G: -0.0468 | S_z:  0.4675 | dist: 0.0975
Step: 600  | D: -8.1146 | CE:  0.4390 | S_OoD:  0.8607 | S_z:  0.5332 | G: -0.0503 | S_z:  0.5028 | dist: 0.0673
Step: 620  | D: -8.1137 | CE:  0.4161 | S_OoD:  0.8576 | S_z:  0.4626 | G: -0.0426 | S_z:  0.4261 | dist: 0.0936
Step: 640  | D: -8.0300 | CE:  0.5077 | S_OoD:  0.8584 | S_z:  0.4624 | G: -0.0432 | S_z:  0.4322 | dist: 0.1096
Step: 660  | D: -8.2439 | CE:  0.3237 | S_OoD:  0.8609 | S_z:  0.4165 | G: -0.0393 | S_z:  0.3933 | dist: 0.0686
Step: 680  | D: -8.1816 | CE:  0.4526 | S_OoD:  0.8675 | S_z:  0.4100 | G: -0.0364 | S_z:  0.3643 | dist: 0.0823
Step: 700  | D: -7.8256 | CE:  0.6982 | S_OoD:  0.8565 | S_z:  0.4129 | G: -0.0382 | S_z:  0.3818 | dist: 0.0772
Step: 720  | D: -8.1438 | CE:  0.3315 | S_OoD:  0.8521 | S_z:  0.4572 | G: -0.0408 | S_z:  0.4079 | dist: 0.0827
Step: 740  | D: -8.1804 | CE:  0.4410 | S_OoD:  0.8660 | S_z:  0.3839 | G: -0.0329 | S_z:  0.3290 | dist: 0.0949
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.5464032888412474
mean: 0.5464 | std: 0.0 | MAD: 0.0
TPR@99TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.6570206129550934
mean: 0.65702 | std: 0.0 | MAD: 0.0
AUROC: 1.0

Validation Accuracy: 0.85175
Validation Classification Loss: 0.41501226782798767
