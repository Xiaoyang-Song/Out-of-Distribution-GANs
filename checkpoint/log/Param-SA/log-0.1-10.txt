
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.


[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 64
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=0.1 & scaling=100.0 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
Verifying OOD set labels: tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Verifying OOD class distribution: Counter({8: 64, 9: 64})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([128, 1, 28, 28])
Step: 0    | D:  10.0399 | CE:  2.1043 | S_OoD:  0.8057 | S_z:  0.8016 | G: -7.4787 | S_z:  0.7479 | dist: 0.0906
Step: 20   | D:  2.7144 | CE:  2.0328 | S_OoD:  0.2517 | S_z:  0.0707 | G: -0.6483 | S_z:  0.0648 | dist: 0.0843
Step: 40   | D:  1.6072 | CE:  1.3829 | S_OoD:  0.4716 | S_z:  0.0272 | G: -0.2544 | S_z:  0.0254 | dist: 0.0994
Step: 60   | D:  1.2909 | CE:  1.1944 | S_OoD:  0.5196 | S_z:  0.0148 | G: -0.1442 | S_z:  0.0144 | dist: 0.1018
Step: 80   | D:  1.0398 | CE:  0.9841 | S_OoD:  0.5433 | S_z:  0.0110 | G: -0.1060 | S_z:  0.0106 | dist: 0.0592
Step: 100  | D:  1.0409 | CE:  1.0185 | S_OoD:  0.5058 | S_z:  0.0073 | G: -0.0714 | S_z:  0.0071 | dist: 0.0763
Step: 120  | D:  0.9338 | CE:  0.9293 | S_OoD:  0.5367 | S_z:  0.0058 | G: -0.0576 | S_z:  0.0058 | dist: 0.0771
Step: 140  | D:  0.7018 | CE:  0.7059 | S_OoD:  0.4973 | S_z:  0.0046 | G: -0.0442 | S_z:  0.0044 | dist: 0.0891
Step: 160  | D:  0.6189 | CE:  0.6312 | S_OoD:  0.4883 | S_z:  0.0037 | G: -0.0362 | S_z:  0.0036 | dist: 0.0852
Step: 180  | D:  0.5185 | CE:  0.5397 | S_OoD:  0.5197 | S_z:  0.0031 | G: -0.0300 | S_z:  0.0030 | dist: 0.0997
Step: 200  | D:  0.5755 | CE:  0.6013 | S_OoD:  0.5172 | S_z:  0.0026 | G: -0.0256 | S_z:  0.0026 | dist: 0.1130
Step: 220  | D:  0.5384 | CE:  0.5688 | S_OoD:  0.5414 | S_z:  0.0024 | G: -0.0236 | S_z:  0.0024 | dist: 0.1073
Step: 240  | D:  0.6125 | CE:  0.6506 | S_OoD:  0.5877 | S_z:  0.0021 | G: -0.0210 | S_z:  0.0021 | dist: 0.0949
Step: 260  | D:  0.5127 | CE:  0.5483 | S_OoD:  0.5405 | S_z:  0.0018 | G: -0.0184 | S_z:  0.0018 | dist: 0.0827
Step: 280  | D:  0.7580 | CE:  0.7964 | S_OoD:  0.5509 | S_z:  0.0017 | G: -0.0165 | S_z:  0.0016 | dist: 0.0736
Step: 300  | D:  0.5198 | CE:  0.5585 | S_OoD:  0.5409 | S_z:  0.0015 | G: -0.0152 | S_z:  0.0015 | dist: 0.0953
Step: 320  | D:  0.5074 | CE:  0.5442 | S_OoD:  0.5090 | S_z:  0.0014 | G: -0.0139 | S_z:  0.0014 | dist: 0.0870
Step: 340  | D:  0.5801 | CE:  0.6235 | S_OoD:  0.5616 | S_z:  0.0013 | G: -0.0129 | S_z:  0.0013 | dist: 0.0945
Step: 360  | D:  0.3045 | CE:  0.3486 | S_OoD:  0.5617 | S_z:  0.0012 | G: -0.0119 | S_z:  0.0012 | dist: 0.0723
Step: 380  | D:  0.6026 | CE:  0.6410 | S_OoD:  0.4982 | S_z:  0.0011 | G: -0.0113 | S_z:  0.0011 | dist: 0.1227
Step: 400  | D:  0.4806 | CE:  0.5299 | S_OoD:  0.6035 | S_z:  0.0011 | G: -0.0110 | S_z:  0.0011 | dist: 0.0969
Step: 420  | D:  0.3436 | CE:  0.3894 | S_OoD:  0.5540 | S_z:  0.0010 | G: -0.0096 | S_z:  0.0010 | dist: 0.0895
Step: 440  | D:  0.5223 | CE:  0.5681 | S_OoD:  0.5565 | S_z:  0.0010 | G: -0.0100 | S_z:  0.0010 | dist: 0.0694
Step: 460  | D:  0.3320 | CE:  0.3812 | S_OoD:  0.5813 | S_z:  0.0009 | G: -0.0088 | S_z:  0.0009 | dist: 0.0863
Step: 480  | D:  0.3719 | CE:  0.4154 | S_OoD:  0.5203 | S_z:  0.0009 | G: -0.0084 | S_z:  0.0008 | dist: 0.0969
Step: 500  | D:  0.4352 | CE:  0.4824 | S_OoD:  0.5482 | S_z:  0.0008 | G: -0.0076 | S_z:  0.0008 | dist: 0.0722
Step: 520  | D:  0.3206 | CE:  0.3732 | S_OoD:  0.5979 | S_z:  0.0007 | G: -0.0072 | S_z:  0.0007 | dist: 0.0931
Step: 540  | D:  0.3388 | CE:  0.3896 | S_OoD:  0.5755 | S_z:  0.0007 | G: -0.0066 | S_z:  0.0007 | dist: 0.0850
Step: 560  | D:  0.3295 | CE:  0.3729 | S_OoD:  0.4954 | S_z:  0.0006 | G: -0.0061 | S_z:  0.0006 | dist: 0.0886
Step: 580  | D:  0.2535 | CE:  0.3075 | S_OoD:  0.6041 | S_z:  0.0006 | G: -0.0065 | S_z:  0.0007 | dist: 0.0975
Step: 600  | D:  0.3027 | CE:  0.3574 | S_OoD:  0.6105 | S_z:  0.0006 | G: -0.0063 | S_z:  0.0006 | dist: 0.0673
Step: 620  | D:  0.3417 | CE:  0.3989 | S_OoD:  0.6253 | S_z:  0.0005 | G: -0.0054 | S_z:  0.0005 | dist: 0.0936
Step: 640  | D:  0.4298 | CE:  0.4858 | S_OoD:  0.6187 | S_z:  0.0006 | G: -0.0058 | S_z:  0.0006 | dist: 0.1096
Step: 660  | D:  0.2054 | CE:  0.2629 | S_OoD:  0.6270 | S_z:  0.0005 | G: -0.0051 | S_z:  0.0005 | dist: 0.0686
Step: 680  | D:  0.3783 | CE:  0.4355 | S_OoD:  0.6214 | S_z:  0.0005 | G: -0.0049 | S_z:  0.0005 | dist: 0.0823
Step: 700  | D:  0.6386 | CE:  0.6991 | S_OoD:  0.6482 | S_z:  0.0004 | G: -0.0045 | S_z:  0.0004 | dist: 0.0772
Step: 720  | D:  0.2193 | CE:  0.2814 | S_OoD:  0.6649 | S_z:  0.0004 | G: -0.0043 | S_z:  0.0004 | dist: 0.0827
Step: 740  | D:  0.3975 | CE:  0.4567 | S_OoD:  0.6370 | S_z:  0.0004 | G: -0.0045 | S_z:  0.0004 | dist: 0.0949
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.7145
mean: 0.7145 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.5200166463851926
mean: 0.52002 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.479
mean: 0.479 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.6263167381286623
mean: 0.62632 | std: 0.0 | MAD: 0.0
AUROC: 0.942244375

Validation Accuracy: 0.86475
Validation Classification Loss: 0.3787988088130951
