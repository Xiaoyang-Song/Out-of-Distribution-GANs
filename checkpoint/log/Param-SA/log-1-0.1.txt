
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.


[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 64
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=1 & scaling=0.1 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
Verifying OOD set labels: tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Verifying OOD class distribution: Counter({8: 64, 9: 64})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([128, 1, 28, 28])
Step: 0    | D:  1.3787 | CE:  2.1043 | S_OoD:  0.8057 | S_z:  0.8016 | G: -0.0831 | S_z:  0.8311 | dist: 0.0906
Step: 20   | D:  0.5060 | CE:  1.2065 | S_OoD:  0.7836 | S_z:  0.8300 | G: -0.0829 | S_z:  0.8291 | dist: 0.0843
Step: 40   | D:  0.2912 | CE:  0.9600 | S_OoD:  0.7481 | S_z:  0.7935 | G: -0.0799 | S_z:  0.7985 | dist: 0.0994
Step: 60   | D: -0.0554 | CE:  0.6669 | S_OoD:  0.7989 | S_z:  0.7656 | G: -0.0759 | S_z:  0.7593 | dist: 0.1018
Step: 80   | D: -0.1120 | CE:  0.6205 | S_OoD:  0.8057 | S_z:  0.7323 | G: -0.0716 | S_z:  0.7160 | dist: 0.0592
Step: 100  | D:  0.0362 | CE:  0.7842 | S_OoD:  0.8183 | S_z:  0.7030 | G: -0.0698 | S_z:  0.6980 | dist: 0.0763
Step: 120  | D:  0.0654 | CE:  0.7850 | S_OoD:  0.7862 | S_z:  0.6660 | G: -0.0643 | S_z:  0.6434 | dist: 0.0771
Step: 140  | D: -0.1883 | CE:  0.5720 | S_OoD:  0.8251 | S_z:  0.6487 | G: -0.0634 | S_z:  0.6337 | dist: 0.0891
Step: 160  | D: -0.2663 | CE:  0.5053 | S_OoD:  0.8331 | S_z:  0.6148 | G: -0.0588 | S_z:  0.5880 | dist: 0.0852
Step: 180  | D: -0.3768 | CE:  0.4053 | S_OoD:  0.8443 | S_z:  0.6226 | G: -0.0591 | S_z:  0.5911 | dist: 0.0997
Step: 200  | D: -0.4302 | CE:  0.3500 | S_OoD:  0.8401 | S_z:  0.5977 | G: -0.0565 | S_z:  0.5655 | dist: 0.1130
Step: 220  | D: -0.4437 | CE:  0.3484 | S_OoD:  0.8469 | S_z:  0.5477 | G: -0.0514 | S_z:  0.5136 | dist: 0.1073
Step: 240  | D: -0.2382 | CE:  0.5514 | S_OoD:  0.8414 | S_z:  0.5180 | G: -0.0488 | S_z:  0.4877 | dist: 0.0949
Step: 260  | D: -0.3432 | CE:  0.4495 | S_OoD:  0.8480 | S_z:  0.5529 | G: -0.0513 | S_z:  0.5129 | dist: 0.0827
Step: 280  | D: -0.3341 | CE:  0.4759 | S_OoD:  0.8510 | S_z:  0.4101 | G: -0.0372 | S_z:  0.3716 | dist: 0.0736
Step: 300  | D: -0.3638 | CE:  0.4391 | S_OoD:  0.8491 | S_z:  0.4620 | G: -0.0418 | S_z:  0.4178 | dist: 0.0953
Step: 320  | D: -0.3223 | CE:  0.4768 | S_OoD:  0.8446 | S_z:  0.4545 | G: -0.0394 | S_z:  0.3941 | dist: 0.0870
Step: 340  | D: -0.3106 | CE:  0.4893 | S_OoD:  0.8458 | S_z:  0.4584 | G: -0.0410 | S_z:  0.4099 | dist: 0.0945
Step: 360  | D: -0.4439 | CE:  0.3599 | S_OoD:  0.8404 | S_z:  0.3654 | G: -0.0331 | S_z:  0.3312 | dist: 0.0723
Step: 380  | D: -0.3376 | CE:  0.4811 | S_OoD:  0.8525 | S_z:  0.3392 | G: -0.0315 | S_z:  0.3147 | dist: 0.1227
Step: 400  | D: -0.3581 | CE:  0.4590 | S_OoD:  0.8547 | S_z:  0.3753 | G: -0.0308 | S_z:  0.3079 | dist: 0.0969
Step: 420  | D: -0.4594 | CE:  0.3644 | S_OoD:  0.8549 | S_z:  0.3114 | G: -0.0262 | S_z:  0.2619 | dist: 0.0895
Step: 440  | D: -0.3725 | CE:  0.4391 | S_OoD:  0.8440 | S_z:  0.3250 | G: -0.0292 | S_z:  0.2918 | dist: 0.0694
Step: 460  | D: -0.4479 | CE:  0.3714 | S_OoD:  0.8525 | S_z:  0.3312 | G: -0.0275 | S_z:  0.2751 | dist: 0.0863
Step: 480  | D: -0.5105 | CE:  0.3045 | S_OoD:  0.8465 | S_z:  0.3145 | G: -0.0273 | S_z:  0.2725 | dist: 0.0969
Step: 500  | D: -0.3996 | CE:  0.4198 | S_OoD:  0.8520 | S_z:  0.3255 | G: -0.0261 | S_z:  0.2614 | dist: 0.0722
Step: 520  | D: -0.4805 | CE:  0.3500 | S_OoD:  0.8573 | S_z:  0.2675 | G: -0.0226 | S_z:  0.2262 | dist: 0.0931
Step: 540  | D: -0.4850 | CE:  0.3462 | S_OoD:  0.8558 | S_z:  0.2452 | G: -0.0194 | S_z:  0.1940 | dist: 0.0850
Step: 560  | D: -0.4381 | CE:  0.3882 | S_OoD:  0.8552 | S_z:  0.2895 | G: -0.0222 | S_z:  0.2221 | dist: 0.0886
Step: 580  | D: -0.5692 | CE:  0.2669 | S_OoD:  0.8579 | S_z:  0.2169 | G: -0.0164 | S_z:  0.1639 | dist: 0.0975
Step: 600  | D: -0.5027 | CE:  0.3109 | S_OoD:  0.8390 | S_z:  0.2545 | G: -0.0184 | S_z:  0.1835 | dist: 0.0673
Step: 620  | D: -0.4561 | CE:  0.3680 | S_OoD:  0.8511 | S_z:  0.2698 | G: -0.0211 | S_z:  0.2113 | dist: 0.0936
Step: 640  | D: -0.4265 | CE:  0.4053 | S_OoD:  0.8545 | S_z:  0.2279 | G: -0.0190 | S_z:  0.1897 | dist: 0.1096
Step: 660  | D: -0.6441 | CE:  0.1937 | S_OoD:  0.8569 | S_z:  0.1904 | G: -0.0146 | S_z:  0.1462 | dist: 0.0686
Step: 680  | D: -0.3991 | CE:  0.4253 | S_OoD:  0.8462 | S_z:  0.2175 | G: -0.0174 | S_z:  0.1743 | dist: 0.0823
Step: 700  | D: -0.1838 | CE:  0.6488 | S_OoD:  0.8528 | S_z:  0.2017 | G: -0.0148 | S_z:  0.1476 | dist: 0.0772
Step: 720  | D: -0.5421 | CE:  0.2949 | S_OoD:  0.8592 | S_z:  0.2219 | G: -0.0164 | S_z:  0.1636 | dist: 0.0827
Step: 740  | D: -0.4207 | CE:  0.4189 | S_OoD:  0.8593 | S_z:  0.1972 | G: -0.0134 | S_z:  0.1341 | dist: 0.0949
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.49846033453941346
mean: 0.49846 | std: 0.0 | MAD: 0.0
TPR@99TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.6094118344783788
mean: 0.60941 | std: 0.0 | MAD: 0.0
AUROC: 0.9999996250000001

Validation Accuracy: 0.877375
Validation Classification Loss: 0.343318287730217
Step: 10   | D: -0.5822 | CE:  0.2584 | S_OoD:  0.8576 | S_z:  0.1705 | G: -0.0116 | S_z:  0.1156 | dist: 0.1035
Step: 30   | D: -0.6551 | CE:  0.1767 | S_OoD:  0.8535 | S_z:  0.2168 | G: -0.0136 | S_z:  0.1358 | dist: 0.1042
Step: 50   | D: -0.5771 | CE:  0.2592 | S_OoD:  0.8547 | S_z:  0.1848 | G: -0.0123 | S_z:  0.1229 | dist: 0.0839
Step: 70   | D: -0.5678 | CE:  0.2649 | S_OoD:  0.8522 | S_z:  0.1947 | G: -0.0127 | S_z:  0.1271 | dist: 0.0859
Step: 90   | D: -0.5680 | CE:  0.2723 | S_OoD:  0.8567 | S_z:  0.1641 | G: -0.0111 | S_z:  0.1108 | dist: 0.1002
Step: 110  | D: -0.5646 | CE:  0.2759 | S_OoD:  0.8526 | S_z:  0.1209 | G: -0.0069 | S_z:  0.0686 | dist: 0.0725
Step: 130  | D: -0.5037 | CE:  0.3467 | S_OoD:  0.8612 | S_z:  0.1092 | G: -0.0058 | S_z:  0.0580 | dist: 0.1029
Step: 150  | D: -0.5375 | CE:  0.3114 | S_OoD:  0.8612 | S_z:  0.1233 | G: -0.0100 | S_z:  0.1000 | dist: 0.0965
Step: 170  | D: -0.4392 | CE:  0.4077 | S_OoD:  0.8590 | S_z:  0.1202 | G: -0.0063 | S_z:  0.0633 | dist: 0.1104
Step: 190  | D: -0.5725 | CE:  0.2743 | S_OoD:  0.8609 | S_z:  0.1413 | G: -0.0087 | S_z:  0.0868 | dist: 0.1066
Step: 210  | D: -0.5299 | CE:  0.3112 | S_OoD:  0.8531 | S_z:  0.1201 | G: -0.0074 | S_z:  0.0742 | dist: 0.0739
Step: 230  | D: -0.4984 | CE:  0.3421 | S_OoD:  0.8500 | S_z:  0.0940 | G: -0.0051 | S_z:  0.0506 | dist: 0.1004
Step: 250  | D: -0.6682 | CE:  0.1809 | S_OoD:  0.8590 | S_z:  0.0989 | G: -0.0058 | S_z:  0.0577 | dist: 0.1035
Step: 270  | D: -0.6695 | CE:  0.1796 | S_OoD:  0.8572 | S_z:  0.0815 | G: -0.0047 | S_z:  0.0470 | dist: 0.0853
Step: 290  | D: -0.3722 | CE:  0.4809 | S_OoD:  0.8611 | S_z:  0.0803 | G: -0.0050 | S_z:  0.0498 | dist: 0.0967
Step: 310  | D: -0.5531 | CE:  0.2932 | S_OoD:  0.8566 | S_z:  0.1037 | G: -0.0056 | S_z:  0.0563 | dist: 0.0908
Step: 330  | D: -0.5740 | CE:  0.2758 | S_OoD:  0.8574 | S_z:  0.0753 | G: -0.0043 | S_z:  0.0429 | dist: 0.0500
Step: 350  | D: -0.5634 | CE:  0.2858 | S_OoD:  0.8579 | S_z:  0.0871 | G: -0.0042 | S_z:  0.0416 | dist: 0.0971
Step: 370  | D: -0.5662 | CE:  0.2886 | S_OoD:  0.8620 | S_z:  0.0713 | G: -0.0034 | S_z:  0.0343 | dist: 0.0810
Step: 390  | D: -0.6196 | CE:  0.2293 | S_OoD:  0.8589 | S_z:  0.1006 | G: -0.0044 | S_z:  0.0443 | dist: 0.0898
Step: 410  | D: -0.5273 | CE:  0.3133 | S_OoD:  0.8494 | S_z:  0.0875 | G: -0.0042 | S_z:  0.0422 | dist: 0.0903
Step: 430  | D: -0.6240 | CE:  0.2270 | S_OoD:  0.8576 | S_z:  0.0664 | G: -0.0035 | S_z:  0.0349 | dist: 0.0713
Step: 450  | D: -0.5112 | CE:  0.3390 | S_OoD:  0.8581 | S_z:  0.0792 | G: -0.0021 | S_z:  0.0211 | dist: 0.0844
Step: 470  | D: -0.6898 | CE:  0.1607 | S_OoD:  0.8593 | S_z:  0.0883 | G: -0.0033 | S_z:  0.0334 | dist: 0.0795
Step: 490  | D: -0.4913 | CE:  0.3578 | S_OoD:  0.8561 | S_z:  0.0697 | G: -0.0021 | S_z:  0.0206 | dist: 0.0648
Step: 510  | D: -0.4941 | CE:  0.3606 | S_OoD:  0.8601 | S_z:  0.0534 | G: -0.0027 | S_z:  0.0266 | dist: 0.0870
Step: 530  | D: -0.4953 | CE:  0.3495 | S_OoD:  0.8526 | S_z:  0.0778 | G: -0.0028 | S_z:  0.0278 | dist: 0.0886
Step: 550  | D: -0.5853 | CE:  0.2620 | S_OoD:  0.8536 | S_z:  0.0626 | G: -0.0025 | S_z:  0.0252 | dist: 0.1026
Step: 570  | D: -0.6488 | CE:  0.2065 | S_OoD:  0.8635 | S_z:  0.0811 | G: -0.0022 | S_z:  0.0217 | dist: 0.1117
Step: 590  | D: -0.5251 | CE:  0.3228 | S_OoD:  0.8549 | S_z:  0.0705 | G: -0.0030 | S_z:  0.0303 | dist: 0.0614
Step: 610  | D: -0.7049 | CE:  0.1472 | S_OoD:  0.8587 | S_z:  0.0663 | G: -0.0024 | S_z:  0.0240 | dist: 0.0772
Step: 630  | D: -0.5919 | CE:  0.2496 | S_OoD:  0.8511 | S_z:  0.0960 | G: -0.0025 | S_z:  0.0250 | dist: 0.0990
Step: 650  | D: -0.6725 | CE:  0.1797 | S_OoD:  0.8576 | S_z:  0.0541 | G: -0.0023 | S_z:  0.0226 | dist: 0.0624
Step: 670  | D: -0.4743 | CE:  0.3826 | S_OoD:  0.8647 | S_z:  0.0781 | G: -0.0024 | S_z:  0.0238 | dist: 0.0771
Step: 690  | D: -0.6493 | CE:  0.1975 | S_OoD:  0.8565 | S_z:  0.0969 | G: -0.0027 | S_z:  0.0272 | dist: 0.0719
Step: 710  | D: -0.5169 | CE:  0.3352 | S_OoD:  0.8584 | S_z:  0.0636 | G: -0.0025 | S_z:  0.0249 | dist: 0.0556
Step: 730  | D: -0.6190 | CE:  0.2351 | S_OoD:  0.8570 | S_z:  0.0296 | G: -0.0013 | S_z:  0.0127 | dist: 0.0710
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.4654349237680435
mean: 0.46543 | std: 0.0 | MAD: 0.0
TPR@99TNR: 1.0
mean: 1.0 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5852570146322251
mean: 0.58526 | std: 0.0 | MAD: 0.0
AUROC: 0.9999996250000001

Validation Accuracy: 0.906625
Validation Classification Loss: 0.2679895802140236
