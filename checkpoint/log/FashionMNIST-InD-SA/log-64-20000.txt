
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 64
InD Sensitivity Analysis experiment for 20000 InD samples.
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=0.1 & scaling=0.01 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
================================================================================
Conducting Sensitivity Analysis with 20000 InD samples.
Verifying InD training set size: 20000
Verifying InD class distribution: Counter({5: 2551, 1: 2528, 4: 2508, 6: 2493, 0: 2491, 2: 2478, 7: 2476, 3: 2475})
================================================================================
Verifying OOD set labels: tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Verifying OOD class distribution: Counter({8: 64, 9: 64})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([128, 1, 28, 28])
Step: 0    | D:  2.0389 | CE:  2.1185 | S_OoD:  0.8044 | S_z:  0.8016 | G: -0.0008 | S_z:  0.8253 | dist: 0.0933
Step: 20   | D:  0.9618 | CE:  1.0347 | S_OoD:  0.7369 | S_z:  0.7827 | G: -0.0008 | S_z:  0.7809 | dist: 0.0775
Step: 40   | D:  0.7727 | CE:  0.8401 | S_OoD:  0.6812 | S_z:  0.7727 | G: -0.0008 | S_z:  0.7732 | dist: 0.0892
Step: 60   | D:  0.9870 | CE:  1.0513 | S_OoD:  0.6512 | S_z:  0.7587 | G: -0.0008 | S_z:  0.7622 | dist: 0.0727
Step: 80   | D:  0.5206 | CE:  0.5898 | S_OoD:  0.6999 | S_z:  0.7224 | G: -0.0007 | S_z:  0.7277 | dist: 0.0962
Step: 100  | D:  0.5866 | CE:  0.6531 | S_OoD:  0.6723 | S_z:  0.7100 | G: -0.0007 | S_z:  0.7138 | dist: 0.0988
Step: 120  | D:  0.6848 | CE:  0.7450 | S_OoD:  0.6092 | S_z:  0.7187 | G: -0.0007 | S_z:  0.7202 | dist: 0.0701
Step: 140  | D:  0.3452 | CE:  0.4098 | S_OoD:  0.6534 | S_z:  0.7076 | G: -0.0007 | S_z:  0.7063 | dist: 0.0940
Step: 160  | D:  0.5238 | CE:  0.5862 | S_OoD:  0.6311 | S_z:  0.6876 | G: -0.0007 | S_z:  0.6778 | dist: 0.1149
Step: 180  | D:  0.6854 | CE:  0.7553 | S_OoD:  0.7058 | S_z:  0.6793 | G: -0.0007 | S_z:  0.6879 | dist: 0.0899
Step: 200  | D:  0.4511 | CE:  0.5177 | S_OoD:  0.6720 | S_z:  0.6680 | G: -0.0007 | S_z:  0.6626 | dist: 0.0707
Step: 220  | D:  0.4356 | CE:  0.5033 | S_OoD:  0.6833 | S_z:  0.6630 | G: -0.0007 | S_z:  0.6631 | dist: 0.0950
Step: 240  | D:  0.4777 | CE:  0.5409 | S_OoD:  0.6382 | S_z:  0.6552 | G: -0.0007 | S_z:  0.6762 | dist: 0.1148
Step: 260  | D:  0.4845 | CE:  0.5530 | S_OoD:  0.6914 | S_z:  0.6293 | G: -0.0006 | S_z:  0.6304 | dist: 0.0770
Step: 280  | D:  0.3213 | CE:  0.3820 | S_OoD:  0.6131 | S_z:  0.6372 | G: -0.0007 | S_z:  0.6511 | dist: 0.0812
Step: 300  | D:  0.3608 | CE:  0.4238 | S_OoD:  0.6361 | S_z:  0.6201 | G: -0.0006 | S_z:  0.6204 | dist: 0.0620
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.7015
mean: 0.7015 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.5706653177738189
mean: 0.57067 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.4405
mean: 0.4405 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.671362340450287
mean: 0.67136 | std: 0.0 | MAD: 0.0
AUROC: 0.93872175

Validation Accuracy: 0.838
Validation Classification Loss: 0.45468655705451966
Step: 7    | D:  0.2737 | CE:  0.3412 | S_OoD:  0.6809 | S_z:  0.6344 | G: -0.0006 | S_z:  0.6317 | dist: 0.0828
Step: 27   | D:  0.5764 | CE:  0.6453 | S_OoD:  0.6952 | S_z:  0.6307 | G: -0.0006 | S_z:  0.6295 | dist: 0.0849
Step: 47   | D:  0.1823 | CE:  0.2510 | S_OoD:  0.6932 | S_z:  0.6397 | G: -0.0006 | S_z:  0.6317 | dist: 0.0697
Step: 67   | D:  0.3281 | CE:  0.3916 | S_OoD:  0.6407 | S_z:  0.6137 | G: -0.0006 | S_z:  0.6195 | dist: 0.0832
Step: 87   | D:  0.3888 | CE:  0.4587 | S_OoD:  0.7042 | S_z:  0.5955 | G: -0.0006 | S_z:  0.6027 | dist: 0.1005
Step: 107  | D:  0.1636 | CE:  0.2323 | S_OoD:  0.6933 | S_z:  0.6268 | G: -0.0006 | S_z:  0.6344 | dist: 0.0959
Step: 127  | D:  0.2614 | CE:  0.3275 | S_OoD:  0.6663 | S_z:  0.6204 | G: -0.0006 | S_z:  0.6320 | dist: 0.0764
Step: 147  | D:  0.2161 | CE:  0.2847 | S_OoD:  0.6919 | S_z:  0.5993 | G: -0.0006 | S_z:  0.5994 | dist: 0.0706
Step: 167  | D:  0.2631 | CE:  0.3328 | S_OoD:  0.7029 | S_z:  0.6178 | G: -0.0006 | S_z:  0.6180 | dist: 0.0726
Step: 187  | D:  0.2139 | CE:  0.2836 | S_OoD:  0.7027 | S_z:  0.6189 | G: -0.0006 | S_z:  0.6184 | dist: 0.0711
Step: 207  | D:  0.2305 | CE:  0.2978 | S_OoD:  0.6792 | S_z:  0.5634 | G: -0.0006 | S_z:  0.5504 | dist: 0.1012
Step: 227  | D:  0.2875 | CE:  0.3522 | S_OoD:  0.6532 | S_z:  0.6335 | G: -0.0006 | S_z:  0.6289 | dist: 0.1058
Step: 247  | D:  0.1909 | CE:  0.2597 | S_OoD:  0.6941 | S_z:  0.5978 | G: -0.0006 | S_z:  0.6022 | dist: 0.0837
Step: 267  | D:  0.4098 | CE:  0.4788 | S_OoD:  0.6956 | S_z:  0.6296 | G: -0.0006 | S_z:  0.6282 | dist: 0.0928
Step: 287  | D:  0.2768 | CE:  0.3455 | S_OoD:  0.6931 | S_z:  0.6320 | G: -0.0006 | S_z:  0.6375 | dist: 0.0736
Step: 307  | D:  0.2373 | CE:  0.3091 | S_OoD:  0.7243 | S_z:  0.6330 | G: -0.0006 | S_z:  0.6180 | dist: 0.1285
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.7955
mean: 0.7955 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.5090352535247802
mean: 0.50904 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.616
mean: 0.616 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.6201012611389161
mean: 0.6201 | std: 0.0 | MAD: 0.0
AUROC: 0.9604512499999999

Validation Accuracy: 0.865375
Validation Classification Loss: 0.36501454961299895
Step: 14   | D:  0.2573 | CE:  0.3256 | S_OoD:  0.6885 | S_z:  0.5816 | G: -0.0006 | S_z:  0.5908 | dist: 0.0890
Step: 34   | D:  0.2812 | CE:  0.3535 | S_OoD:  0.7290 | S_z:  0.6125 | G: -0.0006 | S_z:  0.6097 | dist: 0.1005
Step: 54   | D:  0.1325 | CE:  0.2029 | S_OoD:  0.7098 | S_z:  0.6147 | G: -0.0006 | S_z:  0.6125 | dist: 0.0749
Step: 74   | D:  0.2141 | CE:  0.2847 | S_OoD:  0.7120 | S_z:  0.5809 | G: -0.0006 | S_z:  0.5784 | dist: 0.0959
Step: 94   | D:  0.2772 | CE:  0.3488 | S_OoD:  0.7217 | S_z:  0.5910 | G: -0.0006 | S_z:  0.5993 | dist: 0.0895
Step: 114  | D:  0.1725 | CE:  0.2456 | S_OoD:  0.7369 | S_z:  0.6090 | G: -0.0006 | S_z:  0.6014 | dist: 0.0610
Step: 134  | D:  0.1689 | CE:  0.2418 | S_OoD:  0.7353 | S_z:  0.6181 | G: -0.0006 | S_z:  0.6173 | dist: 0.0813
Step: 154  | D:  0.2232 | CE:  0.2920 | S_OoD:  0.6947 | S_z:  0.5780 | G: -0.0006 | S_z:  0.5878 | dist: 0.0769
Step: 174  | D:  0.1766 | CE:  0.2493 | S_OoD:  0.7336 | S_z:  0.6009 | G: -0.0006 | S_z:  0.6010 | dist: 0.0698
Step: 194  | D:  0.1634 | CE:  0.2359 | S_OoD:  0.7318 | S_z:  0.6170 | G: -0.0006 | S_z:  0.6102 | dist: 0.0958
Step: 214  | D:  0.1384 | CE:  0.2119 | S_OoD:  0.7401 | S_z:  0.5715 | G: -0.0006 | S_z:  0.5684 | dist: 0.0821
Step: 234  | D:  0.2972 | CE:  0.3695 | S_OoD:  0.7281 | S_z:  0.5736 | G: -0.0006 | S_z:  0.5702 | dist: 0.1022
Step: 254  | D:  0.1700 | CE:  0.2437 | S_OoD:  0.7426 | S_z:  0.6098 | G: -0.0006 | S_z:  0.6110 | dist: 0.1014
Step: 274  | D:  0.1750 | CE:  0.2471 | S_OoD:  0.7263 | S_z:  0.5613 | G: -0.0006 | S_z:  0.5634 | dist: 0.0930
Step: 294  | D:  0.3159 | CE:  0.3876 | S_OoD:  0.7221 | S_z:  0.5852 | G: -0.0006 | S_z:  0.5850 | dist: 0.0872
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.8895
mean: 0.8895 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.500736540555954
mean: 0.50074 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.7105
mean: 0.7105 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.6264517658948898
mean: 0.62645 | std: 0.0 | MAD: 0.0
AUROC: 0.97970175

Validation Accuracy: 0.8835
Validation Classification Loss: 0.3318899727463722
Step: 1    | D:  0.2397 | CE:  0.3108 | S_OoD:  0.7175 | S_z:  0.5990 | G: -0.0006 | S_z:  0.6052 | dist: 0.0929
Step: 21   | D:  0.0883 | CE:  0.1640 | S_OoD:  0.7630 | S_z:  0.5850 | G: -0.0006 | S_z:  0.5865 | dist: 0.0631
Step: 41   | D:  0.1544 | CE:  0.2296 | S_OoD:  0.7578 | S_z:  0.5976 | G: -0.0006 | S_z:  0.6011 | dist: 0.0847
Step: 61   | D:  0.2307 | CE:  0.3049 | S_OoD:  0.7479 | S_z:  0.6051 | G: -0.0006 | S_z:  0.5980 | dist: 0.0658
Step: 81   | D:  0.2610 | CE:  0.3329 | S_OoD:  0.7247 | S_z:  0.5692 | G: -0.0006 | S_z:  0.5647 | dist: 0.0739
Step: 101  | D:  0.1854 | CE:  0.2604 | S_OoD:  0.7566 | S_z:  0.6066 | G: -0.0006 | S_z:  0.6082 | dist: 0.0584
Step: 121  | D:  0.1718 | CE:  0.2419 | S_OoD:  0.7068 | S_z:  0.5689 | G: -0.0006 | S_z:  0.5551 | dist: 0.0904
Step: 141  | D:  0.1640 | CE:  0.2401 | S_OoD:  0.7674 | S_z:  0.5710 | G: -0.0006 | S_z:  0.5676 | dist: 0.0842
Step: 161  | D:  0.2575 | CE:  0.3305 | S_OoD:  0.7353 | S_z:  0.5424 | G: -0.0005 | S_z:  0.5279 | dist: 0.1067
Step: 181  | D:  0.0931 | CE:  0.1670 | S_OoD:  0.7448 | S_z:  0.5863 | G: -0.0006 | S_z:  0.5948 | dist: 0.0855
Step: 201  | D:  0.2293 | CE:  0.3025 | S_OoD:  0.7381 | S_z:  0.5729 | G: -0.0006 | S_z:  0.5761 | dist: 0.0777
Step: 221  | D:  0.2939 | CE:  0.3695 | S_OoD:  0.7616 | S_z:  0.5755 | G: -0.0006 | S_z:  0.5748 | dist: 0.0896
Step: 241  | D:  0.1170 | CE:  0.1919 | S_OoD:  0.7550 | S_z:  0.5763 | G: -0.0006 | S_z:  0.5772 | dist: 0.0982
Step: 261  | D:  0.1577 | CE:  0.2326 | S_OoD:  0.7545 | S_z:  0.5469 | G: -0.0005 | S_z:  0.5429 | dist: 0.0925
Step: 281  | D:  0.0849 | CE:  0.1593 | S_OoD:  0.7499 | S_z:  0.5782 | G: -0.0006 | S_z:  0.5761 | dist: 0.0916
Step: 301  | D:  0.1139 | CE:  0.1860 | S_OoD:  0.7271 | S_z:  0.5741 | G: -0.0006 | S_z:  0.5701 | dist: 0.0998
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.907
mean: 0.907 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.4772180080413818
mean: 0.47722 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.7885
mean: 0.7885 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5922536587715155
mean: 0.59225 | std: 0.0 | MAD: 0.0
AUROC: 0.9842219374999999

Validation Accuracy: 0.881875
Validation Classification Loss: 0.32020382821559906
New checkpoint created at the end of epoch 3.
Step: 8    | D:  0.2034 | CE:  0.2799 | S_OoD:  0.7703 | S_z:  0.5473 | G: -0.0005 | S_z:  0.5323 | dist: 0.0754
Step: 28   | D:  0.0982 | CE:  0.1741 | S_OoD:  0.7641 | S_z:  0.5687 | G: -0.0006 | S_z:  0.5568 | dist: 0.1000
Step: 48   | D:  0.2879 | CE:  0.3632 | S_OoD:  0.7591 | S_z:  0.5578 | G: -0.0005 | S_z:  0.5464 | dist: 0.0584
Step: 68   | D:  0.0807 | CE:  0.1557 | S_OoD:  0.7552 | S_z:  0.5582 | G: -0.0006 | S_z:  0.5516 | dist: 0.0943
Step: 88   | D:  0.0513 | CE:  0.1277 | S_OoD:  0.7689 | S_z:  0.5745 | G: -0.0006 | S_z:  0.5715 | dist: 0.0848
Step: 108  | D:  0.0907 | CE:  0.1669 | S_OoD:  0.7675 | S_z:  0.5591 | G: -0.0006 | S_z:  0.5553 | dist: 0.0929
Step: 128  | D:  0.2451 | CE:  0.3192 | S_OoD:  0.7466 | S_z:  0.5612 | G: -0.0006 | S_z:  0.5803 | dist: 0.0675
Step: 148  | D:  0.2227 | CE:  0.2991 | S_OoD:  0.7702 | S_z:  0.5548 | G: -0.0006 | S_z:  0.5567 | dist: 0.0833
Step: 168  | D:  0.0956 | CE:  0.1713 | S_OoD:  0.7624 | S_z:  0.5608 | G: -0.0006 | S_z:  0.5583 | dist: 0.1080
Step: 188  | D:  0.2867 | CE:  0.3602 | S_OoD:  0.7396 | S_z:  0.5520 | G: -0.0006 | S_z:  0.5541 | dist: 0.0845
Step: 208  | D:  0.1127 | CE:  0.1863 | S_OoD:  0.7410 | S_z:  0.4823 | G: -0.0005 | S_z:  0.4937 | dist: 0.0708
Step: 228  | D:  0.0719 | CE:  0.1466 | S_OoD:  0.7527 | S_z:  0.5768 | G: -0.0006 | S_z:  0.5768 | dist: 0.0699
Step: 248  | D:  0.3245 | CE:  0.4015 | S_OoD:  0.7765 | S_z:  0.5810 | G: -0.0006 | S_z:  0.5885 | dist: 0.0752
Step: 268  | D:  0.1182 | CE:  0.1916 | S_OoD:  0.7395 | S_z:  0.5259 | G: -0.0005 | S_z:  0.5252 | dist: 0.0991
Step: 288  | D:  0.1317 | CE:  0.2071 | S_OoD:  0.7604 | S_z:  0.5836 | G: -0.0006 | S_z:  0.5829 | dist: 0.0734
Step: 308  | D:  0.0285 | CE:  0.1045 | S_OoD:  0.7654 | S_z:  0.5525 | G: -0.0005 | S_z:  0.5493 | dist: 0.1096
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.89
mean: 0.89 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.4597403049468992
mean: 0.45974 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.7335
mean: 0.7335 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5902369910478592
mean: 0.59024 | std: 0.0 | MAD: 0.0
AUROC: 0.9816359062500001

Validation Accuracy: 0.889
Validation Classification Loss: 0.3165249000787735
Step: 15   | D:  0.0910 | CE:  0.1670 | S_OoD:  0.7653 | S_z:  0.5025 | G: -0.0005 | S_z:  0.5079 | dist: 0.0958
Step: 35   | D:  0.0954 | CE:  0.1738 | S_OoD:  0.7896 | S_z:  0.5621 | G: -0.0006 | S_z:  0.5591 | dist: 0.0853
Step: 55   | D:  0.1244 | CE:  0.2003 | S_OoD:  0.7642 | S_z:  0.5522 | G: -0.0005 | S_z:  0.5475 | dist: 0.0933
Step: 75   | D:  0.1002 | CE:  0.1723 | S_OoD:  0.7267 | S_z:  0.5330 | G: -0.0005 | S_z:  0.5278 | dist: 0.0858
Step: 95   | D:  0.1645 | CE:  0.2387 | S_OoD:  0.7460 | S_z:  0.4912 | G: -0.0005 | S_z:  0.4927 | dist: 0.1085
Step: 115  | D:  0.2531 | CE:  0.3290 | S_OoD:  0.7645 | S_z:  0.5512 | G: -0.0005 | S_z:  0.5457 | dist: 0.0922
Step: 135  | D:  0.1235 | CE:  0.1993 | S_OoD:  0.7635 | S_z:  0.5663 | G: -0.0006 | S_z:  0.5511 | dist: 0.1107
Step: 155  | D:  0.1429 | CE:  0.2180 | S_OoD:  0.7560 | S_z:  0.5154 | G: -0.0005 | S_z:  0.5115 | dist: 0.0890
Step: 175  | D:  0.1005 | CE:  0.1743 | S_OoD:  0.7426 | S_z:  0.5187 | G: -0.0005 | S_z:  0.5239 | dist: 0.0670
Step: 195  | D:  0.1821 | CE:  0.2571 | S_OoD:  0.7555 | S_z:  0.4915 | G: -0.0005 | S_z:  0.5008 | dist: 0.0765
Step: 215  | D:  0.1134 | CE:  0.1895 | S_OoD:  0.7664 | S_z:  0.5287 | G: -0.0005 | S_z:  0.5256 | dist: 0.0592
Step: 235  | D:  0.0128 | CE:  0.0885 | S_OoD:  0.7629 | S_z:  0.5739 | G: -0.0006 | S_z:  0.5708 | dist: 0.0615
Step: 255  | D:  0.2201 | CE:  0.2963 | S_OoD:  0.7669 | S_z:  0.5224 | G: -0.0005 | S_z:  0.5208 | dist: 0.0910
Step: 275  | D:  0.1396 | CE:  0.2148 | S_OoD:  0.7574 | S_z:  0.5397 | G: -0.0005 | S_z:  0.5231 | dist: 0.0696
Step: 295  | D:  0.2559 | CE:  0.3297 | S_OoD:  0.7433 | S_z:  0.5366 | G: -0.0005 | S_z:  0.5432 | dist: 0.0572
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9275
mean: 0.9275 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.4384468019008633
mean: 0.43845 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.8415
mean: 0.8415 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5652299445867539
mean: 0.56523 | std: 0.0 | MAD: 0.0
AUROC: 0.9879463437500001

Validation Accuracy: 0.89925
Validation Classification Loss: 0.28394395077228546
Step: 2    | D:  0.1181 | CE:  0.1936 | S_OoD:  0.7597 | S_z:  0.5155 | G: -0.0005 | S_z:  0.5147 | dist: 0.0822
Step: 22   | D:  0.0272 | CE:  0.1029 | S_OoD:  0.7622 | S_z:  0.5339 | G: -0.0005 | S_z:  0.5343 | dist: 0.0982
Step: 42   | D:  0.1376 | CE:  0.2122 | S_OoD:  0.7511 | S_z:  0.5437 | G: -0.0006 | S_z:  0.5525 | dist: 0.1061
Step: 62   | D:  0.0894 | CE:  0.1670 | S_OoD:  0.7819 | S_z:  0.5082 | G: -0.0005 | S_z:  0.4940 | dist: 0.0802
Step: 82   | D:  0.0893 | CE:  0.1662 | S_OoD:  0.7743 | S_z:  0.5271 | G: -0.0005 | S_z:  0.5304 | dist: 0.0765
Step: 102  | D:  0.2475 | CE:  0.3240 | S_OoD:  0.7707 | S_z:  0.5079 | G: -0.0005 | S_z:  0.5020 | dist: 0.0835
Step: 122  | D:  0.2184 | CE:  0.2953 | S_OoD:  0.7739 | S_z:  0.5416 | G: -0.0005 | S_z:  0.5428 | dist: 0.0890
Step: 142  | D:  0.1881 | CE:  0.2654 | S_OoD:  0.7782 | S_z:  0.5317 | G: -0.0005 | S_z:  0.5256 | dist: 0.0665
Step: 162  | D:  0.1338 | CE:  0.2110 | S_OoD:  0.7774 | S_z:  0.5141 | G: -0.0005 | S_z:  0.5038 | dist: 0.0534
Step: 182  | D:  0.0517 | CE:  0.1276 | S_OoD:  0.7646 | S_z:  0.5253 | G: -0.0005 | S_z:  0.5259 | dist: 0.0746
Step: 202  | D:  0.2541 | CE:  0.3289 | S_OoD:  0.7535 | S_z:  0.5512 | G: -0.0005 | S_z:  0.5421 | dist: 0.0916
Step: 222  | D:  0.1677 | CE:  0.2438 | S_OoD:  0.7663 | S_z:  0.5651 | G: -0.0006 | S_z:  0.5536 | dist: 0.0594
Step: 242  | D:  0.1329 | CE:  0.2103 | S_OoD:  0.7795 | S_z:  0.5519 | G: -0.0006 | S_z:  0.5549 | dist: 0.0903
Step: 262  | D:  0.1273 | CE:  0.2058 | S_OoD:  0.7901 | S_z:  0.5073 | G: -0.0005 | S_z:  0.5059 | dist: 0.0845
Step: 282  | D:  0.1080 | CE:  0.1856 | S_OoD:  0.7804 | S_z:  0.4986 | G: -0.0005 | S_z:  0.5019 | dist: 0.0662
Step: 302  | D:  0.0869 | CE:  0.1637 | S_OoD:  0.7730 | S_z:  0.4904 | G: -0.0005 | S_z:  0.4817 | dist: 0.0779
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9555
mean: 0.9555 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.423831686377525
mean: 0.42383 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.8835
mean: 0.8835 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5752533930540086
mean: 0.57525 | std: 0.0 | MAD: 0.0
AUROC: 0.9913595

Validation Accuracy: 0.90225
Validation Classification Loss: 0.28751550513505936
Step: 9    | D:  0.0286 | CE:  0.1056 | S_OoD:  0.7749 | S_z:  0.4872 | G: -0.0005 | S_z:  0.4848 | dist: 0.0710
Step: 29   | D: -0.0451 | CE:  0.0343 | S_OoD:  0.7988 | S_z:  0.5386 | G: -0.0005 | S_z:  0.5344 | dist: 0.0919
Step: 49   | D: -0.0113 | CE:  0.0681 | S_OoD:  0.7987 | S_z:  0.5112 | G: -0.0005 | S_z:  0.5089 | dist: 0.0984
Step: 69   | D:  0.0328 | CE:  0.1118 | S_OoD:  0.7943 | S_z:  0.4713 | G: -0.0005 | S_z:  0.4792 | dist: 0.0905
Step: 89   | D:  0.1126 | CE:  0.1886 | S_OoD:  0.7647 | S_z:  0.5391 | G: -0.0005 | S_z:  0.5430 | dist: 0.0667
Step: 109  | D:  0.1437 | CE:  0.2216 | S_OoD:  0.7837 | S_z:  0.4977 | G: -0.0005 | S_z:  0.4978 | dist: 0.0749
Step: 129  | D:  0.1640 | CE:  0.2428 | S_OoD:  0.7936 | S_z:  0.5163 | G: -0.0005 | S_z:  0.5211 | dist: 0.0926
Step: 149  | D:  0.0215 | CE:  0.0986 | S_OoD:  0.7761 | S_z:  0.5444 | G: -0.0005 | S_z:  0.5263 | dist: 0.0714
Step: 169  | D: -0.0317 | CE:  0.0459 | S_OoD:  0.7821 | S_z:  0.5728 | G: -0.0006 | S_z:  0.5743 | dist: 0.0808
Step: 189  | D:  0.0419 | CE:  0.1177 | S_OoD:  0.7636 | S_z:  0.5471 | G: -0.0005 | S_z:  0.5449 | dist: 0.0793
Step: 209  | D:  0.2017 | CE:  0.2805 | S_OoD:  0.7928 | S_z:  0.5095 | G: -0.0005 | S_z:  0.4979 | dist: 0.0696
Step: 229  | D:  0.0161 | CE:  0.0935 | S_OoD:  0.7781 | S_z:  0.4472 | G: -0.0005 | S_z:  0.4533 | dist: 0.1209
Step: 249  | D:  0.0273 | CE:  0.1043 | S_OoD:  0.7759 | S_z:  0.5375 | G: -0.0005 | S_z:  0.5357 | dist: 0.0655
Step: 269  | D:  0.1997 | CE:  0.2780 | S_OoD:  0.7877 | S_z:  0.4847 | G: -0.0005 | S_z:  0.4840 | dist: 0.0869
Step: 289  | D:  0.0370 | CE:  0.1163 | S_OoD:  0.7970 | S_z:  0.4742 | G: -0.0005 | S_z:  0.4682 | dist: 0.0908
Step: 309  | D:  0.0638 | CE:  0.1422 | S_OoD:  0.7882 | S_z:  0.4755 | G: -0.0005 | S_z:  0.4791 | dist: 0.0874
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.963
mean: 0.963 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.4288009077310562
mean: 0.4288 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.8965
mean: 0.8965 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5707587397098548
mean: 0.57076 | std: 0.0 | MAD: 0.0
AUROC: 0.9935151874999999

Validation Accuracy: 0.89925
Validation Classification Loss: 0.2832336487770081
New checkpoint created at the end of epoch 7.
Step: 16   | D:  0.0170 | CE:  0.0945 | S_OoD:  0.7797 | S_z:  0.5247 | G: -0.0005 | S_z:  0.5199 | dist: 0.0609
Step: 36   | D:  0.1267 | CE:  0.2051 | S_OoD:  0.7884 | S_z:  0.5090 | G: -0.0005 | S_z:  0.5067 | dist: 0.0936
Step: 56   | D:  0.1065 | CE:  0.1864 | S_OoD:  0.8045 | S_z:  0.5139 | G: -0.0005 | S_z:  0.5173 | dist: 0.0682
Step: 76   | D:  0.0745 | CE:  0.1528 | S_OoD:  0.7879 | S_z:  0.4763 | G: -0.0005 | S_z:  0.4744 | dist: 0.0770
Step: 96   | D:  0.1709 | CE:  0.2487 | S_OoD:  0.7822 | S_z:  0.4793 | G: -0.0005 | S_z:  0.4630 | dist: 0.0669
Step: 116  | D:  0.1584 | CE:  0.2358 | S_OoD:  0.7786 | S_z:  0.4760 | G: -0.0005 | S_z:  0.4900 | dist: 0.1033
Step: 136  | D: -0.0148 | CE:  0.0632 | S_OoD:  0.7854 | S_z:  0.5076 | G: -0.0005 | S_z:  0.5058 | dist: 0.0696
Step: 156  | D: -0.0091 | CE:  0.0700 | S_OoD:  0.7959 | S_z:  0.4775 | G: -0.0005 | S_z:  0.4690 | dist: 0.0663
Step: 176  | D:  0.0374 | CE:  0.1167 | S_OoD:  0.7975 | S_z:  0.4995 | G: -0.0005 | S_z:  0.5011 | dist: 0.0726
Step: 196  | D:  0.0607 | CE:  0.1411 | S_OoD:  0.8083 | S_z:  0.4305 | G: -0.0004 | S_z:  0.4299 | dist: 0.0777
Step: 216  | D:  0.1311 | CE:  0.2082 | S_OoD:  0.7758 | S_z:  0.4619 | G: -0.0005 | S_z:  0.4616 | dist: 0.0849
Step: 236  | D: -0.0121 | CE:  0.0639 | S_OoD:  0.7650 | S_z:  0.4741 | G: -0.0005 | S_z:  0.4775 | dist: 0.0798
Step: 256  | D:  0.0977 | CE:  0.1751 | S_OoD:  0.7780 | S_z:  0.4424 | G: -0.0005 | S_z:  0.4568 | dist: 0.1313
Step: 276  | D:  0.1705 | CE:  0.2486 | S_OoD:  0.7861 | S_z:  0.5043 | G: -0.0005 | S_z:  0.4845 | dist: 0.0737
Step: 296  | D: -0.0001 | CE:  0.0781 | S_OoD:  0.7870 | S_z:  0.5117 | G: -0.0005 | S_z:  0.5054 | dist: 0.0871
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9525
mean: 0.9525 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.43869081437587687
mean: 0.43869 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.878
mean: 0.878 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5649804347753525
mean: 0.56498 | std: 0.0 | MAD: 0.0
AUROC: 0.9913371249999999

Validation Accuracy: 0.885875
Validation Classification Loss: 0.35052419102191923
Step: 3    | D:  0.1788 | CE:  0.2557 | S_OoD:  0.7747 | S_z:  0.4945 | G: -0.0005 | S_z:  0.4889 | dist: 0.0936
Step: 23   | D: -0.0031 | CE:  0.0760 | S_OoD:  0.7951 | S_z:  0.4533 | G: -0.0005 | S_z:  0.4526 | dist: 0.0781
Step: 43   | D:  0.0024 | CE:  0.0822 | S_OoD:  0.8030 | S_z:  0.4687 | G: -0.0005 | S_z:  0.4734 | dist: 0.0743
Step: 63   | D:  0.1091 | CE:  0.1887 | S_OoD:  0.8005 | S_z:  0.4601 | G: -0.0005 | S_z:  0.4606 | dist: 0.0642
Step: 83   | D: -0.0091 | CE:  0.0687 | S_OoD:  0.7824 | S_z:  0.4443 | G: -0.0004 | S_z:  0.4464 | dist: 0.0922
Step: 103  | D:  0.2101 | CE:  0.2884 | S_OoD:  0.7876 | S_z:  0.5062 | G: -0.0005 | S_z:  0.4977 | dist: 0.1103
Step: 123  | D:  0.1414 | CE:  0.2194 | S_OoD:  0.7857 | S_z:  0.4813 | G: -0.0005 | S_z:  0.4835 | dist: 0.0953
Step: 143  | D:  0.0087 | CE:  0.0873 | S_OoD:  0.7910 | S_z:  0.4988 | G: -0.0005 | S_z:  0.5028 | dist: 0.0795
Step: 163  | D:  0.0028 | CE:  0.0820 | S_OoD:  0.7971 | S_z:  0.4799 | G: -0.0005 | S_z:  0.4746 | dist: 0.0837
Step: 183  | D: -0.0167 | CE:  0.0609 | S_OoD:  0.7800 | S_z:  0.4622 | G: -0.0005 | S_z:  0.4556 | dist: 0.1138
Step: 203  | D: -0.0233 | CE:  0.0540 | S_OoD:  0.7777 | S_z:  0.4382 | G: -0.0004 | S_z:  0.4403 | dist: 0.0704
Step: 223  | D:  0.0547 | CE:  0.1344 | S_OoD:  0.8009 | S_z:  0.4532 | G: -0.0005 | S_z:  0.4584 | dist: 0.0733
Step: 243  | D: -0.0303 | CE:  0.0457 | S_OoD:  0.7649 | S_z:  0.4833 | G: -0.0005 | S_z:  0.4856 | dist: 0.0849
Step: 263  | D: -0.0014 | CE:  0.0770 | S_OoD:  0.7894 | S_z:  0.5125 | G: -0.0005 | S_z:  0.5258 | dist: 0.1075
Step: 283  | D:  0.1104 | CE:  0.1874 | S_OoD:  0.7753 | S_z:  0.4885 | G: -0.0005 | S_z:  0.5030 | dist: 0.1073
Step: 303  | D:  0.1043 | CE:  0.1841 | S_OoD:  0.8027 | S_z:  0.4706 | G: -0.0005 | S_z:  0.4769 | dist: 0.0758
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9485
mean: 0.9485 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.4108394265174862
mean: 0.41084 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.875
mean: 0.875 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5466926187276843
mean: 0.54669 | std: 0.0 | MAD: 0.0
AUROC: 0.9914705625

Validation Accuracy: 0.891875
Validation Classification Loss: 0.3406268622279167
Step: 10   | D:  0.0635 | CE:  0.1412 | S_OoD:  0.7818 | S_z:  0.4750 | G: -0.0005 | S_z:  0.4705 | dist: 0.0959
Step: 30   | D: -0.0149 | CE:  0.0649 | S_OoD:  0.8031 | S_z:  0.4758 | G: -0.0005 | S_z:  0.4745 | dist: 0.0568
Step: 50   | D: -0.0196 | CE:  0.0603 | S_OoD:  0.8041 | S_z:  0.4623 | G: -0.0005 | S_z:  0.4635 | dist: 0.0972
Step: 70   | D: -0.0432 | CE:  0.0347 | S_OoD:  0.7833 | S_z:  0.4607 | G: -0.0005 | S_z:  0.4643 | dist: 0.0971
Step: 90   | D:  0.0097 | CE:  0.0871 | S_OoD:  0.7792 | S_z:  0.4637 | G: -0.0005 | S_z:  0.4668 | dist: 0.0668
Step: 110  | D:  0.0568 | CE:  0.1358 | S_OoD:  0.7947 | S_z:  0.4535 | G: -0.0005 | S_z:  0.4583 | dist: 0.0812
Step: 130  | D:  0.0109 | CE:  0.0895 | S_OoD:  0.7905 | S_z:  0.4500 | G: -0.0004 | S_z:  0.4457 | dist: 0.0478
Step: 150  | D: -0.0336 | CE:  0.0443 | S_OoD:  0.7825 | S_z:  0.4121 | G: -0.0004 | S_z:  0.4089 | dist: 0.0544
Step: 170  | D:  0.1100 | CE:  0.1863 | S_OoD:  0.7685 | S_z:  0.4859 | G: -0.0005 | S_z:  0.4958 | dist: 0.0765
Step: 190  | D:  0.0053 | CE:  0.0831 | S_OoD:  0.7824 | S_z:  0.4302 | G: -0.0004 | S_z:  0.4249 | dist: 0.0655
Step: 210  | D:  0.0813 | CE:  0.1616 | S_OoD:  0.8074 | S_z:  0.4543 | G: -0.0005 | S_z:  0.4576 | dist: 0.0827
Step: 230  | D: -0.0085 | CE:  0.0707 | S_OoD:  0.7969 | S_z:  0.4531 | G: -0.0005 | S_z:  0.4509 | dist: 0.0977
Step: 250  | D: -0.0345 | CE:  0.0439 | S_OoD:  0.7879 | S_z:  0.4436 | G: -0.0004 | S_z:  0.4425 | dist: 0.1109
Step: 270  | D:  0.0762 | CE:  0.1543 | S_OoD:  0.7857 | S_z:  0.4534 | G: -0.0004 | S_z:  0.4492 | dist: 0.0842
Step: 290  | D:  0.1197 | CE:  0.1968 | S_OoD:  0.7763 | S_z:  0.4598 | G: -0.0005 | S_z:  0.4523 | dist: 0.0624
Step: 310  | D: -0.0019 | CE:  0.0773 | S_OoD:  0.7964 | S_z:  0.4361 | G: -0.0004 | S_z:  0.4305 | dist: 0.0964
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.965
mean: 0.965 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.39732403159141527
mean: 0.39732 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9
mean: 0.9 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5436893212795257
mean: 0.54369 | std: 0.0 | MAD: 0.0
AUROC: 0.9940993125

Validation Accuracy: 0.89775
Validation Classification Loss: 0.32391104418039324
Step: 17   | D: -0.0112 | CE:  0.0699 | S_OoD:  0.8148 | S_z:  0.4470 | G: -0.0004 | S_z:  0.4408 | dist: 0.0885
Step: 37   | D:  0.0054 | CE:  0.0845 | S_OoD:  0.7958 | S_z:  0.4599 | G: -0.0005 | S_z:  0.4616 | dist: 0.0753
Step: 57   | D: -0.0263 | CE:  0.0524 | S_OoD:  0.7919 | S_z:  0.4446 | G: -0.0004 | S_z:  0.4428 | dist: 0.0578
Step: 77   | D:  0.0197 | CE:  0.1007 | S_OoD:  0.8146 | S_z:  0.4344 | G: -0.0004 | S_z:  0.4323 | dist: 0.0899
Step: 97   | D:  0.1045 | CE:  0.1839 | S_OoD:  0.7986 | S_z:  0.4170 | G: -0.0004 | S_z:  0.4278 | dist: 0.0645
Step: 117  | D:  0.0251 | CE:  0.1038 | S_OoD:  0.7914 | S_z:  0.4482 | G: -0.0004 | S_z:  0.4394 | dist: 0.1007
Step: 137  | D:  0.0091 | CE:  0.0884 | S_OoD:  0.7981 | S_z:  0.4201 | G: -0.0004 | S_z:  0.4108 | dist: 0.0884
Step: 157  | D:  0.0196 | CE:  0.1017 | S_OoD:  0.8250 | S_z:  0.4321 | G: -0.0004 | S_z:  0.4317 | dist: 0.0755
Step: 177  | D: -0.0001 | CE:  0.0794 | S_OoD:  0.7998 | S_z:  0.4247 | G: -0.0004 | S_z:  0.4253 | dist: 0.1094
Step: 197  | D:  0.0168 | CE:  0.0947 | S_OoD:  0.7835 | S_z:  0.4552 | G: -0.0004 | S_z:  0.4458 | dist: 0.1024
Step: 217  | D: -0.0183 | CE:  0.0603 | S_OoD:  0.7905 | S_z:  0.4392 | G: -0.0004 | S_z:  0.4413 | dist: 0.1026
Step: 237  | D: -0.0378 | CE:  0.0420 | S_OoD:  0.8021 | S_z:  0.4123 | G: -0.0004 | S_z:  0.4062 | dist: 0.0679
Step: 257  | D: -0.0379 | CE:  0.0419 | S_OoD:  0.8019 | S_z:  0.4312 | G: -0.0004 | S_z:  0.4282 | dist: 0.0641
Step: 277  | D:  0.0044 | CE:  0.0846 | S_OoD:  0.8059 | S_z:  0.4036 | G: -0.0004 | S_z:  0.4026 | dist: 0.0823
Step: 297  | D:  0.0012 | CE:  0.0787 | S_OoD:  0.7794 | S_z:  0.4206 | G: -0.0004 | S_z:  0.4261 | dist: 0.1103
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.947
mean: 0.947 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.4397243648767471
mean: 0.43972 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.885
mean: 0.885 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5541872650384904
mean: 0.55419 | std: 0.0 | MAD: 0.0
AUROC: 0.9914811875

Validation Accuracy: 0.869875
Validation Classification Loss: 0.39938603150844576
New checkpoint created at the end of epoch 11.
Step: 4    | D: -0.0122 | CE:  0.0657 | S_OoD:  0.7836 | S_z:  0.4736 | G: -0.0005 | S_z:  0.4744 | dist: 0.0877
Step: 24   | D: -0.0256 | CE:  0.0551 | S_OoD:  0.8115 | S_z:  0.4178 | G: -0.0004 | S_z:  0.4153 | dist: 0.0962
Step: 44   | D:  0.0193 | CE:  0.0986 | S_OoD:  0.7978 | S_z:  0.4686 | G: -0.0005 | S_z:  0.4623 | dist: 0.0912
Step: 64   | D: -0.0080 | CE:  0.0723 | S_OoD:  0.8075 | S_z:  0.4222 | G: -0.0004 | S_z:  0.4137 | dist: 0.0826
Step: 84   | D:  0.0113 | CE:  0.0911 | S_OoD:  0.8017 | S_z:  0.4247 | G: -0.0004 | S_z:  0.4322 | dist: 0.0959
Step: 104  | D: -0.0275 | CE:  0.0496 | S_OoD:  0.7754 | S_z:  0.4264 | G: -0.0004 | S_z:  0.4313 | dist: 0.0766
Step: 124  | D:  0.0287 | CE:  0.1104 | S_OoD:  0.8213 | S_z:  0.4306 | G: -0.0004 | S_z:  0.4225 | dist: 0.0838
Step: 144  | D: -0.0364 | CE:  0.0444 | S_OoD:  0.8132 | S_z:  0.4602 | G: -0.0005 | S_z:  0.4519 | dist: 0.0798
Step: 164  | D:  0.0037 | CE:  0.0835 | S_OoD:  0.8025 | S_z:  0.4153 | G: -0.0004 | S_z:  0.3938 | dist: 0.0647
Step: 184  | D:  0.1025 | CE:  0.1812 | S_OoD:  0.7909 | S_z:  0.4078 | G: -0.0004 | S_z:  0.3924 | dist: 0.0985
Step: 204  | D: -0.0322 | CE:  0.0494 | S_OoD:  0.8187 | S_z:  0.3543 | G: -0.0004 | S_z:  0.3608 | dist: 0.0998
Step: 224  | D: -0.0199 | CE:  0.0611 | S_OoD:  0.8142 | S_z:  0.4108 | G: -0.0004 | S_z:  0.4217 | dist: 0.0806
Step: 244  | D:  0.1038 | CE:  0.1838 | S_OoD:  0.8041 | S_z:  0.4038 | G: -0.0004 | S_z:  0.4087 | dist: 0.1073
Step: 264  | D:  0.0523 | CE:  0.1303 | S_OoD:  0.7844 | S_z:  0.4472 | G: -0.0004 | S_z:  0.4337 | dist: 0.0974
Step: 284  | D: -0.0250 | CE:  0.0527 | S_OoD:  0.7808 | S_z:  0.4177 | G: -0.0004 | S_z:  0.4207 | dist: 0.0672
Step: 304  | D: -0.0101 | CE:  0.0708 | S_OoD:  0.8122 | S_z:  0.3783 | G: -0.0004 | S_z:  0.3800 | dist: 0.0781
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9655
mean: 0.9655 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.3518237173557281
mean: 0.35182 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.903
mean: 0.903 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.510484134554863
mean: 0.51048 | std: 0.0 | MAD: 0.0
AUROC: 0.9941190624999999

Validation Accuracy: 0.8965
Validation Classification Loss: 0.35973725593090056
Step: 11   | D:  0.1012 | CE:  0.1765 | S_OoD:  0.7575 | S_z:  0.4001 | G: -0.0004 | S_z:  0.4098 | dist: 0.0727
Step: 31   | D:  0.0114 | CE:  0.0926 | S_OoD:  0.8162 | S_z:  0.4214 | G: -0.0004 | S_z:  0.4225 | dist: 0.0894
Step: 51   | D: -0.0493 | CE:  0.0321 | S_OoD:  0.8174 | S_z:  0.3966 | G: -0.0004 | S_z:  0.3967 | dist: 0.0705
Step: 71   | D: -0.0005 | CE:  0.0806 | S_OoD:  0.8144 | S_z:  0.4032 | G: -0.0004 | S_z:  0.4178 | dist: 0.0804
Step: 91   | D: -0.0258 | CE:  0.0540 | S_OoD:  0.8034 | S_z:  0.4892 | G: -0.0005 | S_z:  0.4841 | dist: 0.0950
Step: 111  | D: -0.0023 | CE:  0.0772 | S_OoD:  0.7988 | S_z:  0.3579 | G: -0.0004 | S_z:  0.3708 | dist: 0.0798
Step: 131  | D:  0.0020 | CE:  0.0822 | S_OoD:  0.8057 | S_z:  0.3839 | G: -0.0004 | S_z:  0.3932 | dist: 0.1023
Step: 151  | D: -0.0224 | CE:  0.0585 | S_OoD:  0.8130 | S_z:  0.4165 | G: -0.0004 | S_z:  0.4186 | dist: 0.0851
Step: 171  | D: -0.0263 | CE:  0.0523 | S_OoD:  0.7898 | S_z:  0.3743 | G: -0.0004 | S_z:  0.3932 | dist: 0.0990
Step: 191  | D: -0.0472 | CE:  0.0344 | S_OoD:  0.8194 | S_z:  0.4078 | G: -0.0004 | S_z:  0.4084 | dist: 0.0934
Step: 211  | D: -0.0022 | CE:  0.0789 | S_OoD:  0.8161 | S_z:  0.4401 | G: -0.0004 | S_z:  0.4411 | dist: 0.0788
Step: 231  | D: -0.0174 | CE:  0.0611 | S_OoD:  0.7887 | S_z:  0.3943 | G: -0.0004 | S_z:  0.3884 | dist: 0.1028
Step: 251  | D: -0.0081 | CE:  0.0722 | S_OoD:  0.8068 | S_z:  0.4195 | G: -0.0004 | S_z:  0.4152 | dist: 0.0836
Step: 271  | D:  0.0186 | CE:  0.0965 | S_OoD:  0.7831 | S_z:  0.3894 | G: -0.0004 | S_z:  0.3947 | dist: 0.0749
Step: 291  | D: -0.0218 | CE:  0.0569 | S_OoD:  0.7914 | S_z:  0.3932 | G: -0.0004 | S_z:  0.3893 | dist: 0.0819
Step: 311  | D:  0.0057 | CE:  0.0854 | S_OoD:  0.8009 | S_z:  0.3868 | G: -0.0004 | S_z:  0.3918 | dist: 0.0871
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9725
mean: 0.9725 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.3685713440179821
mean: 0.36857 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9075
mean: 0.9075 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5224802672863007
mean: 0.52248 | std: 0.0 | MAD: 0.0
AUROC: 0.9949279374999999

Validation Accuracy: 0.90425
Validation Classification Loss: 0.3284779249429703
Step: 18   | D:  0.0517 | CE:  0.1318 | S_OoD:  0.8051 | S_z:  0.4065 | G: -0.0004 | S_z:  0.4214 | dist: 0.0899
Step: 38   | D:  0.0030 | CE:  0.0835 | S_OoD:  0.8089 | S_z:  0.4032 | G: -0.0004 | S_z:  0.3958 | dist: 0.0853
Step: 58   | D:  0.0159 | CE:  0.0976 | S_OoD:  0.8217 | S_z:  0.4068 | G: -0.0004 | S_z:  0.4128 | dist: 0.0949
Step: 78   | D: -0.0738 | CE:  0.0069 | S_OoD:  0.8110 | S_z:  0.3936 | G: -0.0004 | S_z:  0.3912 | dist: 0.0820
Step: 98   | D: -0.0357 | CE:  0.0438 | S_OoD:  0.7994 | S_z:  0.3848 | G: -0.0004 | S_z:  0.3737 | dist: 0.0733
Step: 118  | D: -0.0440 | CE:  0.0373 | S_OoD:  0.8179 | S_z:  0.4174 | G: -0.0004 | S_z:  0.4183 | dist: 0.1032
Step: 138  | D: -0.0655 | CE:  0.0158 | S_OoD:  0.8172 | S_z:  0.3884 | G: -0.0004 | S_z:  0.3781 | dist: 0.0946
Step: 158  | D:  0.0445 | CE:  0.1252 | S_OoD:  0.8106 | S_z:  0.3625 | G: -0.0004 | S_z:  0.3763 | dist: 0.0655
Step: 178  | D:  0.0978 | CE:  0.1793 | S_OoD:  0.8192 | S_z:  0.3908 | G: -0.0004 | S_z:  0.3985 | dist: 0.0804
Step: 198  | D:  0.0331 | CE:  0.1144 | S_OoD:  0.8169 | S_z:  0.4244 | G: -0.0004 | S_z:  0.4152 | dist: 0.0499
Step: 218  | D: -0.0542 | CE:  0.0263 | S_OoD:  0.8096 | S_z:  0.3873 | G: -0.0004 | S_z:  0.3870 | dist: 0.0748
Step: 238  | D: -0.0229 | CE:  0.0568 | S_OoD:  0.8011 | S_z:  0.3859 | G: -0.0004 | S_z:  0.3914 | dist: 0.0829
Step: 258  | D: -0.0024 | CE:  0.0765 | S_OoD:  0.7923 | S_z:  0.3637 | G: -0.0004 | S_z:  0.3713 | dist: 0.1129
Step: 278  | D:  0.0114 | CE:  0.0905 | S_OoD:  0.7946 | S_z:  0.3758 | G: -0.0004 | S_z:  0.3786 | dist: 0.0772
Step: 298  | D: -0.0130 | CE:  0.0631 | S_OoD:  0.7652 | S_z:  0.3995 | G: -0.0004 | S_z:  0.3909 | dist: 0.0827
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9865
mean: 0.9865 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.35039961636066397
mean: 0.3504 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9505
mean: 0.9505 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.5019361066818239
mean: 0.50194 | std: 0.0 | MAD: 0.0
AUROC: 0.997493125

Validation Accuracy: 0.90975
Validation Classification Loss: 0.30312387049198153
Step: 5    | D: -0.0421 | CE:  0.0375 | S_OoD:  0.8003 | S_z:  0.3509 | G: -0.0004 | S_z:  0.3543 | dist: 0.1161
Step: 25   | D: -0.0652 | CE:  0.0148 | S_OoD:  0.8045 | S_z:  0.4260 | G: -0.0004 | S_z:  0.4240 | dist: 0.0887
Step: 45   | D:  0.0553 | CE:  0.1360 | S_OoD:  0.8108 | S_z:  0.3815 | G: -0.0004 | S_z:  0.3775 | dist: 0.0915
Step: 65   | D: -0.0102 | CE:  0.0702 | S_OoD:  0.8078 | S_z:  0.3680 | G: -0.0004 | S_z:  0.3706 | dist: 0.0932
Step: 85   | D:  0.0196 | CE:  0.1016 | S_OoD:  0.8243 | S_z:  0.3688 | G: -0.0004 | S_z:  0.3600 | dist: 0.0839
Step: 105  | D:  0.0171 | CE:  0.0953 | S_OoD:  0.7857 | S_z:  0.3834 | G: -0.0004 | S_z:  0.3906 | dist: 0.0709
Step: 125  | D: -0.0622 | CE:  0.0180 | S_OoD:  0.8067 | S_z:  0.3889 | G: -0.0004 | S_z:  0.3758 | dist: 0.0892
Step: 145  | D:  0.0419 | CE:  0.1232 | S_OoD:  0.8166 | S_z:  0.3522 | G: -0.0004 | S_z:  0.3652 | dist: 0.0775
Step: 165  | D:  0.0529 | CE:  0.1327 | S_OoD:  0.8010 | S_z:  0.3698 | G: -0.0004 | S_z:  0.3558 | dist: 0.1088
Step: 185  | D: -0.0684 | CE:  0.0097 | S_OoD:  0.7840 | S_z:  0.3440 | G: -0.0003 | S_z:  0.3446 | dist: 0.0580
Step: 205  | D: -0.0188 | CE:  0.0624 | S_OoD:  0.8156 | S_z:  0.3999 | G: -0.0004 | S_z:  0.4012 | dist: 0.0929
Step: 225  | D: -0.0316 | CE:  0.0440 | S_OoD:  0.7592 | S_z:  0.3982 | G: -0.0004 | S_z:  0.3899 | dist: 0.0792
Step: 245  | D:  0.0046 | CE:  0.0841 | S_OoD:  0.7994 | S_z:  0.4184 | G: -0.0004 | S_z:  0.4149 | dist: 0.0896
Step: 265  | D: -0.0197 | CE:  0.0593 | S_OoD:  0.7942 | S_z:  0.3885 | G: -0.0004 | S_z:  0.3816 | dist: 0.0522
Step: 285  | D: -0.0210 | CE:  0.0579 | S_OoD:  0.7934 | S_z:  0.4080 | G: -0.0004 | S_z:  0.3960 | dist: 0.0728
Step: 305  | D: -0.0271 | CE:  0.0538 | S_OoD:  0.8125 | S_z:  0.4110 | G: -0.0004 | S_z:  0.4038 | dist: 0.0972
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...

Overall Statistics
TPR@95TNR: 0.9825
mean: 0.9825 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: 0.3201823025941846
mean: 0.32018 | std: 0.0 | MAD: 0.0
TPR@99TNR: 0.9455
mean: 0.9455 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold
: 0.49637031614780425
mean: 0.49637 | std: 0.0 | MAD: 0.0
AUROC: 0.9971675

Validation Accuracy: 0.903375
Validation Classification Loss: 0.3412444556355476
New checkpoint created at the end of epoch 15.
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
> Evaluating OoD Wasserstein distances...
Validation Accuracy: 0.90275
Validation Classification Loss: 0.33948514276742936
MC #0 time spent: 1104.85 seconds | About 18.41 minutes | About 0.31 hours

================================================================================
Overall Statistics
TPR@95TNR: [0.9855]
mean: 0.9855 | std: 0.0 | MAD: 0.0
TPR@95TNR-Threshold: [0.32014651894569235]
mean: 0.32015 | std: 0.0 | MAD: 0.0
TPR@99TNR: [0.9465]
mean: 0.9465 | std: 0.0 | MAD: 0.0
TPR@99TNR-Threshold: [0.49600268542766585]
mean: 0.496 | std: 0.0 | MAD: 0.0
AUROC: [0.9972256249999999]
mean: 0.99723 | std: 0.0 | MAD: 0.0

================================================================================
EVALER & Stats saved successfully!
Training time: 1110.68 seconds | About 18.51 minutes | About 0.31 hours
