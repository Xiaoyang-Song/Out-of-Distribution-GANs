
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 32
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=0.1 & scaling=0.01 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9])
Counter({8: 32, 9: 32})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([64, 1, 28, 28])
Step: 0    | D:  2.0601 | CE:  2.1395 | S_OoD:  0.8021 | S_z:  0.7997 | G: -0.0008 | S_z:  0.8244 | dist: 0.9800
Step: 20   | D:  0.8307 | CE:  0.9057 | S_OoD:  0.7583 | S_z:  0.8141 | G: -0.0008 | S_z:  0.8099 | dist: 0.9907
Step: 40   | D:  0.8118 | CE:  0.8801 | S_OoD:  0.6913 | S_z:  0.7642 | G: -0.0008 | S_z:  0.7640 | dist: 1.0067
Step: 60   | D:  0.4868 | CE:  0.5541 | S_OoD:  0.6796 | S_z:  0.7163 | G: -0.0007 | S_z:  0.7195 | dist: 0.9593
Step: 80   | D:  0.4874 | CE:  0.5480 | S_OoD:  0.6141 | S_z:  0.7296 | G: -0.0007 | S_z:  0.7371 | dist: 0.9875
Step: 100  | D:  0.5846 | CE:  0.6486 | S_OoD:  0.6468 | S_z:  0.7096 | G: -0.0007 | S_z:  0.7017 | dist: 0.9806
Step: 120  | D:  0.5296 | CE:  0.5950 | S_OoD:  0.6610 | S_z:  0.7145 | G: -0.0007 | S_z:  0.7088 | dist: 0.9934
Step: 140  | D:  0.4641 | CE:  0.5325 | S_OoD:  0.6912 | S_z:  0.6920 | G: -0.0007 | S_z:  0.6964 | dist: 0.9724
Step: 160  | D:  0.3826 | CE:  0.4467 | S_OoD:  0.6483 | S_z:  0.6730 | G: -0.0007 | S_z:  0.6703 | dist: 0.9831
Step: 180  | D:  0.4560 | CE:  0.5211 | S_OoD:  0.6585 | S_z:  0.6980 | G: -0.0007 | S_z:  0.6963 | dist: 0.9815
Step: 200  | D:  0.4204 | CE:  0.4893 | S_OoD:  0.6955 | S_z:  0.6664 | G: -0.0007 | S_z:  0.6721 | dist: 0.9856
Step: 220  | D:  0.4237 | CE:  0.4915 | S_OoD:  0.6847 | S_z:  0.6489 | G: -0.0007 | S_z:  0.6615 | dist: 0.9728
Step: 240  | D:  0.6638 | CE:  0.7284 | S_OoD:  0.6527 | S_z:  0.6646 | G: -0.0006 | S_z:  0.6492 | dist: 0.9646
Step: 260  | D:  0.4909 | CE:  0.5534 | S_OoD:  0.6311 | S_z:  0.6069 | G: -0.0006 | S_z:  0.5972 | dist: 0.9902
Step: 280  | D:  0.3293 | CE:  0.3970 | S_OoD:  0.6822 | S_z:  0.5941 | G: -0.0006 | S_z:  0.5864 | dist: 0.9843
Step: 300  | D:  0.3515 | CE:  0.4174 | S_OoD:  0.6646 | S_z:  0.5847 | G: -0.0006 | S_z:  0.5916 | dist: 0.9768
Step: 320  | D:  0.5146 | CE:  0.5811 | S_OoD:  0.6710 | S_z:  0.6329 | G: -0.0006 | S_z:  0.6334 | dist: 0.9995
Step: 340  | D:  0.2512 | CE:  0.3223 | S_OoD:  0.7163 | S_z:  0.6113 | G: -0.0006 | S_z:  0.6035 | dist: 0.9988
Step: 360  | D:  0.3981 | CE:  0.4645 | S_OoD:  0.6701 | S_z:  0.6151 | G: -0.0006 | S_z:  0.6187 | dist: 0.9967
Step: 380  | D:  0.3528 | CE:  0.4237 | S_OoD:  0.7158 | S_z:  0.6447 | G: -0.0006 | S_z:  0.6402 | dist: 0.9717
Step: 400  | D:  0.5634 | CE:  0.6324 | S_OoD:  0.6959 | S_z:  0.6256 | G: -0.0006 | S_z:  0.6256 | dist: 0.9864
Step: 420  | D:  0.3104 | CE:  0.3804 | S_OoD:  0.7063 | S_z:  0.5998 | G: -0.0006 | S_z:  0.6179 | dist: 0.9826
Step: 440  | D:  0.2008 | CE:  0.2723 | S_OoD:  0.7205 | S_z:  0.6285 | G: -0.0006 | S_z:  0.6312 | dist: 0.9893
Step: 460  | D:  0.2367 | CE:  0.3062 | S_OoD:  0.7006 | S_z:  0.5816 | G: -0.0006 | S_z:  0.5862 | dist: 0.9645
Step: 480  | D:  0.1783 | CE:  0.2490 | S_OoD:  0.7124 | S_z:  0.6019 | G: -0.0006 | S_z:  0.6025 | dist: 0.9739
Step: 500  | D:  0.3192 | CE:  0.3881 | S_OoD:  0.6948 | S_z:  0.5880 | G: -0.0006 | S_z:  0.5927 | dist: 0.9682
Step: 520  | D:  0.2764 | CE:  0.3509 | S_OoD:  0.7515 | S_z:  0.5892 | G: -0.0006 | S_z:  0.5926 | dist: 0.9816
Step: 540  | D:  0.5318 | CE:  0.6029 | S_OoD:  0.7169 | S_z:  0.5852 | G: -0.0006 | S_z:  0.5867 | dist: 0.9808
Step: 560  | D:  0.3988 | CE:  0.4647 | S_OoD:  0.6653 | S_z:  0.5890 | G: -0.0006 | S_z:  0.5998 | dist: 0.9905
Step: 580  | D:  0.2062 | CE:  0.2784 | S_OoD:  0.7275 | S_z:  0.5664 | G: -0.0006 | S_z:  0.5754 | dist: 0.9853
Step: 600  | D:  0.1094 | CE:  0.1815 | S_OoD:  0.7273 | S_z:  0.5389 | G: -0.0005 | S_z:  0.5369 | dist: 0.9727
Step: 620  | D:  0.2552 | CE:  0.3277 | S_OoD:  0.7318 | S_z:  0.5897 | G: -0.0006 | S_z:  0.5788 | dist: 0.9799
Step: 640  | D:  0.2894 | CE:  0.3625 | S_OoD:  0.7371 | S_z:  0.6117 | G: -0.0006 | S_z:  0.6122 | dist: 0.9886
Step: 660  | D:  0.2169 | CE:  0.2911 | S_OoD:  0.7479 | S_z:  0.5651 | G: -0.0006 | S_z:  0.5610 | dist: 0.9932
Step: 680  | D:  0.1209 | CE:  0.1937 | S_OoD:  0.7340 | S_z:  0.5977 | G: -0.0006 | S_z:  0.5862 | dist: 0.9831
Step: 700  | D:  0.2643 | CE:  0.3378 | S_OoD:  0.7405 | S_z:  0.5651 | G: -0.0006 | S_z:  0.5605 | dist: 1.0000
Step: 720  | D:  0.1709 | CE:  0.2459 | S_OoD:  0.7567 | S_z:  0.5908 | G: -0.0006 | S_z:  0.5897 | dist: 0.9914
Step: 740  | D:  0.2113 | CE:  0.2849 | S_OoD:  0.7421 | S_z:  0.5850 | G: -0.0006 | S_z:  0.5834 | dist: 0.9716
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
