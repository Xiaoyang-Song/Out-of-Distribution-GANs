
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 16
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=0.1 & scaling=0.01 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Counter({8: 16, 9: 16})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([32, 1, 28, 28])
Step: 0    | D:  1.9981 | CE:  2.0813 | S_OoD:  0.8407 | S_z:  0.8420 | G: -0.0008 | S_z:  0.8494 | dist: 0.0940
Step: 20   | D:  1.0577 | CE:  1.1326 | S_OoD:  0.7568 | S_z:  0.8201 | G: -0.0008 | S_z:  0.8140 | dist: 0.0938
Step: 40   | D:  0.6791 | CE:  0.7508 | S_OoD:  0.7243 | S_z:  0.7679 | G: -0.0008 | S_z:  0.7693 | dist: 0.0932
Step: 60   | D:  0.5498 | CE:  0.6203 | S_OoD:  0.7127 | S_z:  0.7556 | G: -0.0008 | S_z:  0.7507 | dist: 0.0944
Step: 80   | D:  0.4908 | CE:  0.5616 | S_OoD:  0.7147 | S_z:  0.7282 | G: -0.0007 | S_z:  0.7348 | dist: 0.0945
Step: 100  | D:  0.4040 | CE:  0.4749 | S_OoD:  0.7155 | S_z:  0.7167 | G: -0.0007 | S_z:  0.7361 | dist: 0.0949
Step: 120  | D:  0.5824 | CE:  0.6544 | S_OoD:  0.7269 | S_z:  0.6863 | G: -0.0007 | S_z:  0.6929 | dist: 0.0935
Step: 140  | D:  0.4142 | CE:  0.4854 | S_OoD:  0.7184 | S_z:  0.7061 | G: -0.0007 | S_z:  0.7078 | dist: 0.0939
Step: 160  | D:  0.3176 | CE:  0.3908 | S_OoD:  0.7390 | S_z:  0.6887 | G: -0.0007 | S_z:  0.6976 | dist: 0.0955
Step: 180  | D:  0.3032 | CE:  0.3697 | S_OoD:  0.6720 | S_z:  0.6600 | G: -0.0007 | S_z:  0.6586 | dist: 0.0943
Step: 200  | D:  0.4080 | CE:  0.4741 | S_OoD:  0.6672 | S_z:  0.6589 | G: -0.0007 | S_z:  0.6627 | dist: 0.0937
Step: 220  | D:  0.2745 | CE:  0.3455 | S_OoD:  0.7173 | S_z:  0.7008 | G: -0.0007 | S_z:  0.6980 | dist: 0.0945
Step: 240  | D:  0.2988 | CE:  0.3708 | S_OoD:  0.7268 | S_z:  0.6680 | G: -0.0007 | S_z:  0.6694 | dist: 0.0942
Step: 260  | D:  0.3661 | CE:  0.4361 | S_OoD:  0.7070 | S_z:  0.6415 | G: -0.0007 | S_z:  0.6540 | dist: 0.0922
Step: 280  | D:  0.4836 | CE:  0.5536 | S_OoD:  0.7062 | S_z:  0.6360 | G: -0.0006 | S_z:  0.6287 | dist: 0.0940
Step: 300  | D:  0.3651 | CE:  0.4404 | S_OoD:  0.7598 | S_z:  0.6266 | G: -0.0006 | S_z:  0.6240 | dist: 0.0944
Step: 320  | D:  0.4012 | CE:  0.4707 | S_OoD:  0.7016 | S_z:  0.6592 | G: -0.0007 | S_z:  0.6598 | dist: 0.0949
Step: 340  | D:  0.3732 | CE:  0.4457 | S_OoD:  0.7316 | S_z:  0.6623 | G: -0.0007 | S_z:  0.6644 | dist: 0.0943
Step: 360  | D:  0.2702 | CE:  0.3413 | S_OoD:  0.7183 | S_z:  0.6519 | G: -0.0007 | S_z:  0.6599 | dist: 0.0938
Step: 380  | D:  0.3696 | CE:  0.4451 | S_OoD:  0.7617 | S_z:  0.6218 | G: -0.0006 | S_z:  0.6194 | dist: 0.0940
Step: 400  | D:  0.3159 | CE:  0.3892 | S_OoD:  0.7399 | S_z:  0.6358 | G: -0.0006 | S_z:  0.6402 | dist: 0.0935
Step: 420  | D:  0.2739 | CE:  0.3494 | S_OoD:  0.7615 | S_z:  0.6525 | G: -0.0007 | S_z:  0.6514 | dist: 0.0934
Step: 440  | D:  0.4342 | CE:  0.5091 | S_OoD:  0.7546 | S_z:  0.6224 | G: -0.0006 | S_z:  0.6117 | dist: 0.0934
Step: 460  | D:  0.2784 | CE:  0.3527 | S_OoD:  0.7493 | S_z:  0.6244 | G: -0.0006 | S_z:  0.6230 | dist: 0.0934
Step: 480  | D:  0.4420 | CE:  0.5177 | S_OoD:  0.7637 | S_z:  0.6317 | G: -0.0006 | S_z:  0.6242 | dist: 0.0931
Step: 500  | D:  0.3664 | CE:  0.4398 | S_OoD:  0.7399 | S_z:  0.6262 | G: -0.0006 | S_z:  0.6226 | dist: 0.0937
Step: 520  | D:  0.2071 | CE:  0.2791 | S_OoD:  0.7259 | S_z:  0.6173 | G: -0.0006 | S_z:  0.6186 | dist: 0.0941
Step: 540  | D:  0.2260 | CE:  0.3011 | S_OoD:  0.7570 | S_z:  0.6370 | G: -0.0006 | S_z:  0.6287 | dist: 0.0948
Step: 560  | D:  0.1627 | CE:  0.2387 | S_OoD:  0.7666 | S_z:  0.6146 | G: -0.0006 | S_z:  0.6138 | dist: 0.0936
Step: 580  | D:  0.2472 | CE:  0.3236 | S_OoD:  0.7696 | S_z:  0.5984 | G: -0.0006 | S_z:  0.5987 | dist: 0.0931
Step: 600  | D:  0.0997 | CE:  0.1730 | S_OoD:  0.7386 | S_z:  0.6269 | G: -0.0006 | S_z:  0.6203 | dist: 0.0940
Step: 620  | D:  0.1699 | CE:  0.2456 | S_OoD:  0.7624 | S_z:  0.5955 | G: -0.0006 | S_z:  0.5925 | dist: 0.0947
Step: 640  | D:  0.3893 | CE:  0.4653 | S_OoD:  0.7648 | S_z:  0.5595 | G: -0.0006 | S_z:  0.5652 | dist: 0.0938
Step: 660  | D:  0.2150 | CE:  0.2916 | S_OoD:  0.7721 | S_z:  0.6188 | G: -0.0006 | S_z:  0.6180 | dist: 0.0948
Step: 680  | D:  0.3156 | CE:  0.3915 | S_OoD:  0.7654 | S_z:  0.6248 | G: -0.0006 | S_z:  0.6288 | dist: 0.0940
Step: 700  | D:  0.4006 | CE:  0.4750 | S_OoD:  0.7503 | S_z:  0.5960 | G: -0.0006 | S_z:  0.6022 | dist: 0.0946
Step: 720  | D:  0.3574 | CE:  0.4336 | S_OoD:  0.7681 | S_z:  0.5949 | G: -0.0006 | S_z:  0.6014 | dist: 0.0942
Step: 740  | D:  0.1188 | CE:  0.1948 | S_OoD:  0.7661 | S_z:  0.5996 | G: -0.0006 | S_z:  0.6000 | dist: 0.0942
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
