
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /home/xysong/.local/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/home/xysong/.local/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
 #include <nvrtc.h>
          ^~~~~~~~~
compilation terminated.

OK
Experiment: FashionMNIST
Experiment regime: Balanced
Method: OOD-GAN
================================================================================
Number of observed OoD samples (class-level): 64
Input Dimension: 28 x 28 x 1
Number of InD classes: 8
Number of Epochs: 16.
Hyperparameters: lambda_ce=1 & lambda_w=0.1 & scaling=0.01 & d_lr=0.001 & g_lr=0.001 & B_InD: 64 & B_OoD: 32 & n_d: 1 & n_g: 1
Score Function: Wasserstein
Finished Processing Input Arguments.
-- Current Device: Tesla V100-PCIE-16GB
-- Device Total Memory: 15.77 GB
-- Let's use 1 GPUs!
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
        8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
        9, 9, 9, 9, 9, 9, 9, 9])
Counter({8: 64, 9: 64})
Monte Carlo Iteration 0
DenseNet
Deep_G
OoD sample shape: torch.Size([128, 1, 28, 28])
Step: 0    | D:  2.0657 | CE:  2.1491 | S_OoD:  0.8424 | S_z:  0.8467 | G: -0.0008 | S_z:  0.8440 | dist: 0.2361
Step: 20   | D:  1.1403 | CE:  1.2098 | S_OoD:  0.7031 | S_z:  0.8335 | G: -0.0008 | S_z:  0.8289 | dist: 0.2736
Step: 40   | D:  0.6517 | CE:  0.7230 | S_OoD:  0.7212 | S_z:  0.7962 | G: -0.0008 | S_z:  0.7919 | dist: 0.2373
Step: 60   | D:  0.7913 | CE:  0.8568 | S_OoD:  0.6634 | S_z:  0.7744 | G: -0.0008 | S_z:  0.7707 | dist: 0.2290
Step: 80   | D:  0.5686 | CE:  0.6317 | S_OoD:  0.6383 | S_z:  0.7408 | G: -0.0007 | S_z:  0.7492 | dist: 0.2612
Step: 100  | D:  0.4647 | CE:  0.5308 | S_OoD:  0.6685 | S_z:  0.7351 | G: -0.0007 | S_z:  0.7317 | dist: 0.2386
Step: 120  | D:  0.5585 | CE:  0.6259 | S_OoD:  0.6815 | S_z:  0.7157 | G: -0.0007 | S_z:  0.7184 | dist: 0.2629
Step: 140  | D:  0.5261 | CE:  0.5871 | S_OoD:  0.6169 | S_z:  0.6803 | G: -0.0007 | S_z:  0.6891 | dist: 0.2635
Step: 160  | D:  0.4278 | CE:  0.4922 | S_OoD:  0.6517 | S_z:  0.6936 | G: -0.0007 | S_z:  0.6981 | dist: 0.2623
Step: 180  | D:  0.3683 | CE:  0.4362 | S_OoD:  0.6860 | S_z:  0.6902 | G: -0.0007 | S_z:  0.6939 | dist: 0.2602
Step: 200  | D:  0.4157 | CE:  0.4760 | S_OoD:  0.6091 | S_z:  0.6656 | G: -0.0007 | S_z:  0.6606 | dist: 0.2442
Step: 220  | D:  0.5743 | CE:  0.6389 | S_OoD:  0.6528 | S_z:  0.6576 | G: -0.0006 | S_z:  0.6370 | dist: 0.2512
Step: 240  | D:  0.4635 | CE:  0.5295 | S_OoD:  0.6673 | S_z:  0.6744 | G: -0.0007 | S_z:  0.6744 | dist: 0.2699
Step: 260  | D:  0.3642 | CE:  0.4300 | S_OoD:  0.6644 | S_z:  0.6617 | G: -0.0007 | S_z:  0.6544 | dist: 0.2689
Step: 280  | D:  0.3276 | CE:  0.3947 | S_OoD:  0.6770 | S_z:  0.6208 | G: -0.0006 | S_z:  0.6282 | dist: 0.2582
Step: 300  | D:  0.4514 | CE:  0.5189 | S_OoD:  0.6815 | S_z:  0.6468 | G: -0.0007 | S_z:  0.6597 | dist: 0.2437
Step: 320  | D:  0.5254 | CE:  0.5943 | S_OoD:  0.6946 | S_z:  0.6450 | G: -0.0007 | S_z:  0.6532 | dist: 0.2821
Step: 340  | D:  0.3822 | CE:  0.4504 | S_OoD:  0.6877 | S_z:  0.6465 | G: -0.0006 | S_z:  0.6450 | dist: 0.2453
Step: 360  | D:  0.2842 | CE:  0.3495 | S_OoD:  0.6595 | S_z:  0.6500 | G: -0.0007 | S_z:  0.6550 | dist: 0.2691
Step: 380  | D:  0.2556 | CE:  0.3217 | S_OoD:  0.6669 | S_z:  0.6123 | G: -0.0006 | S_z:  0.6084 | dist: 0.2188
Step: 400  | D:  0.3081 | CE:  0.3723 | S_OoD:  0.6486 | S_z:  0.6242 | G: -0.0006 | S_z:  0.6269 | dist: 0.2447
Step: 420  | D:  0.2472 | CE:  0.3117 | S_OoD:  0.6505 | S_z:  0.5911 | G: -0.0006 | S_z:  0.5855 | dist: 0.2509
Step: 440  | D:  0.1789 | CE:  0.2467 | S_OoD:  0.6840 | S_z:  0.6166 | G: -0.0006 | S_z:  0.6141 | dist: 0.2356
Step: 460  | D:  0.2315 | CE:  0.3010 | S_OoD:  0.7011 | S_z:  0.6396 | G: -0.0006 | S_z:  0.6369 | dist: 0.2696
Step: 480  | D:  0.3516 | CE:  0.4156 | S_OoD:  0.6460 | S_z:  0.6065 | G: -0.0006 | S_z:  0.5973 | dist: 0.2553
Step: 500  | D:  0.3013 | CE:  0.3686 | S_OoD:  0.6791 | S_z:  0.6094 | G: -0.0006 | S_z:  0.6025 | dist: 0.2429
Step: 520  | D:  0.1828 | CE:  0.2527 | S_OoD:  0.7051 | S_z:  0.6027 | G: -0.0006 | S_z:  0.6029 | dist: 0.2224
Step: 540  | D:  0.2772 | CE:  0.3490 | S_OoD:  0.7237 | S_z:  0.6276 | G: -0.0006 | S_z:  0.6215 | dist: 0.2329
Step: 560  | D:  0.2579 | CE:  0.3273 | S_OoD:  0.6996 | S_z:  0.6110 | G: -0.0006 | S_z:  0.6062 | dist: 0.2716
Step: 580  | D:  0.2784 | CE:  0.3453 | S_OoD:  0.6757 | S_z:  0.6045 | G: -0.0006 | S_z:  0.6077 | dist: 0.2696
Step: 600  | D:  0.2914 | CE:  0.3626 | S_OoD:  0.7178 | S_z:  0.6120 | G: -0.0006 | S_z:  0.6031 | dist: 0.2919
Step: 620  | D:  0.2569 | CE:  0.3277 | S_OoD:  0.7148 | S_z:  0.6623 | G: -0.0007 | S_z:  0.6714 | dist: 0.2661
Step: 640  | D:  0.4410 | CE:  0.5114 | S_OoD:  0.7093 | S_z:  0.6055 | G: -0.0006 | S_z:  0.6045 | dist: 0.2485
Step: 660  | D:  0.3221 | CE:  0.3926 | S_OoD:  0.7113 | S_z:  0.5862 | G: -0.0006 | S_z:  0.5847 | dist: 0.2589
Step: 680  | D:  0.2401 | CE:  0.3100 | S_OoD:  0.7051 | S_z:  0.6110 | G: -0.0006 | S_z:  0.6108 | dist: 0.2422
Step: 700  | D:  0.2485 | CE:  0.3164 | S_OoD:  0.6847 | S_z:  0.5617 | G: -0.0006 | S_z:  0.5611 | dist: 0.2775
Step: 720  | D:  0.2919 | CE:  0.3650 | S_OoD:  0.7361 | S_z:  0.5726 | G: -0.0006 | S_z:  0.5721 | dist: 0.2523
Step: 740  | D:  0.2087 | CE:  0.2803 | S_OoD:  0.7218 | S_z:  0.5788 | G: -0.0006 | S_z:  0.5722 | dist: 0.2600
Computing evaluation statistics...
> Evaluating InD Wasserstein distances...
